(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,81140,e=>{"use strict";function t(e,r,{checkForDefaultPrevented:n=!0}={}){return function(t){if(e?.(t),!1===n||!t.defaultPrevented)return r?.(t)}}"u">typeof window&&window.document&&window.document.createElement,e.s(["composeEventHandlers",()=>t])},20783,e=>{"use strict";var t=e.i(71645);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let n=!1,i=e.map(e=>{let i=r(e,t);return n||"function"!=typeof i||(n=!0),i});if(n)return()=>{for(let t=0;t<i.length;t++){let n=i[t];"function"==typeof n?n():r(e[t],null)}}}}function i(...e){return t.useCallback(n(...e),e)}e.s(["composeRefs",()=>n,"useComposedRefs",()=>i])},30030,e=>{"use strict";var t=e.i(71645),r=e.i(43476);function n(e,n){let i=t.createContext(n),s=e=>{let{children:n,...s}=e,a=t.useMemo(()=>s,Object.values(s));return(0,r.jsx)(i.Provider,{value:a,children:n})};return s.displayName=e+"Provider",[s,function(r){let s=t.useContext(i);if(s)return s;if(void 0!==n)return n;throw Error(`\`${r}\` must be used within \`${e}\``)}]}function i(e,n=[]){let s=[],a=()=>{let r=s.map(e=>t.createContext(e));return function(n){let i=n?.[e]||r;return t.useMemo(()=>({[`__scope${e}`]:{...n,[e]:i}}),[n,i])}};return a.scopeName=e,[function(n,i){let a=t.createContext(i),o=s.length;s=[...s,i];let l=n=>{let{scope:i,children:s,...l}=n,u=i?.[e]?.[o]||a,c=t.useMemo(()=>l,Object.values(l));return(0,r.jsx)(u.Provider,{value:c,children:s})};return l.displayName=n+"Provider",[l,function(r,s){let l=s?.[e]?.[o]||a,u=t.useContext(l);if(u)return u;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${n}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let i=n.reduce((t,{useScope:r,scopeName:n})=>{let i=r(e)[`__scope${n}`];return{...t,...i}},{});return t.useMemo(()=>({[`__scope${r.scopeName}`]:i}),[i])}};return n.scopeName=r.scopeName,n}(a,...n)]}e.s(["createContext",()=>n,"createContextScope",()=>i])},75830,e=>{"use strict";var t=e.i(71645),r=e.i(30030),n=e.i(20783),i=e.i(43476);function s(e){var r;let s,a=(r=e,(s=t.forwardRef((e,r)=>{let{children:i,...s}=e;if(t.isValidElement(i)){var a;let e,o,l=(a=i,(o=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(o=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),u=function(e,t){let r={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...e)=>{let t=s(...e);return i(...e),t}:i&&(r[n]=i):"style"===n?r[n]={...i,...s}:"className"===n&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}(s,i.props);return i.type!==t.Fragment&&(u.ref=r?(0,n.composeRefs)(r,l):l),t.cloneElement(i,u)}return t.Children.count(i)>1?t.Children.only(null):null})).displayName=`${r}.SlotClone`,s),l=t.forwardRef((e,r)=>{let{children:n,...s}=e,l=t.Children.toArray(n),u=l.find(o);if(u){let e=u.props.children,n=l.map(r=>r!==u?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(a,{...s,ref:r,children:t.isValidElement(e)?t.cloneElement(e,void 0,n):null})}return(0,i.jsx)(a,{...s,ref:r,children:n})});return l.displayName=`${e}.Slot`,l}var a=Symbol("radix.slottable");function o(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===a}function l(e){let a=e+"CollectionProvider",[o,l]=(0,r.createContextScope)(a),[u,c]=o(a,{collectionRef:{current:null},itemMap:new Map}),h=e=>{let{scope:r,children:n}=e,s=t.default.useRef(null),a=t.default.useRef(new Map).current;return(0,i.jsx)(u,{scope:r,itemMap:a,collectionRef:s,children:n})};h.displayName=a;let d=e+"CollectionSlot",f=s(d),p=t.default.forwardRef((e,t)=>{let{scope:r,children:s}=e,a=c(d,r),o=(0,n.useComposedRefs)(t,a.collectionRef);return(0,i.jsx)(f,{ref:o,children:s})});p.displayName=d;let m=e+"CollectionItemSlot",g="data-radix-collection-item",y=s(m),v=t.default.forwardRef((e,r)=>{let{scope:s,children:a,...o}=e,l=t.default.useRef(null),u=(0,n.useComposedRefs)(r,l),h=c(m,s);return t.default.useEffect(()=>(h.itemMap.set(l,{ref:l,...o}),()=>void h.itemMap.delete(l))),(0,i.jsx)(y,{...{[g]:""},ref:u,children:a})});return v.displayName=m,[{Provider:h,Slot:p,ItemSlot:v},function(r){let n=c(e+"CollectionConsumer",r);return t.default.useCallback(()=>{let e=n.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${g}]`));return Array.from(n.itemMap.values()).sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current))},[n.collectionRef,n.itemMap])},l]}var u=new WeakMap;function c(e,t){var r,n;let i,s,a;if("at"in Array.prototype)return Array.prototype.at.call(e,t);let o=(r=e,n=t,i=r.length,(a=(s=h(n))>=0?s:i+s)<0||a>=i?-1:a);return -1===o?void 0:e[o]}function h(e){return e!=e||0===e?0:Math.trunc(e)}(class e extends Map{#e;constructor(e){super(e),this.#e=[...super.keys()],u.set(this,!0)}set(e,t){return u.get(this)&&(this.has(e)?this.#e[this.#e.indexOf(e)]=e:this.#e.push(e)),super.set(e,t),this}insert(e,t,r){let n,i=this.has(t),s=this.#e.length,a=h(e),o=a>=0?a:s+a,l=o<0||o>=s?-1:o;if(l===this.size||i&&l===this.size-1||-1===l)return this.set(t,r),this;let u=this.size+ +!i;a<0&&o++;let c=[...this.#e],d=!1;for(let e=o;e<u;e++)if(o===e){let s=c[e];c[e]===t&&(s=c[e+1]),i&&this.delete(t),n=this.get(s),this.set(t,r)}else{d||c[e-1]!==t||(d=!0);let r=c[d?e:e-1],i=n;n=this.get(r),this.delete(r),this.set(r,i)}return this}with(t,r,n){let i=new e(this);return i.insert(t,r,n),i}before(e){let t=this.#e.indexOf(e)-1;if(!(t<0))return this.entryAt(t)}setBefore(e,t,r){let n=this.#e.indexOf(e);return -1===n?this:this.insert(n,t,r)}after(e){let t=this.#e.indexOf(e);if(-1!==(t=-1===t||t===this.size-1?-1:t+1))return this.entryAt(t)}setAfter(e,t,r){let n=this.#e.indexOf(e);return -1===n?this:this.insert(n+1,t,r)}first(){return this.entryAt(0)}last(){return this.entryAt(-1)}clear(){return this.#e=[],super.clear()}delete(e){let t=super.delete(e);return t&&this.#e.splice(this.#e.indexOf(e),1),t}deleteAt(e){let t=this.keyAt(e);return void 0!==t&&this.delete(t)}at(e){let t=c(this.#e,e);if(void 0!==t)return this.get(t)}entryAt(e){let t=c(this.#e,e);if(void 0!==t)return[t,this.get(t)]}indexOf(e){return this.#e.indexOf(e)}keyAt(e){return c(this.#e,e)}from(e,t){let r=this.indexOf(e);if(-1===r)return;let n=r+t;return n<0&&(n=0),n>=this.size&&(n=this.size-1),this.at(n)}keyFrom(e,t){let r=this.indexOf(e);if(-1===r)return;let n=r+t;return n<0&&(n=0),n>=this.size&&(n=this.size-1),this.keyAt(n)}find(e,t){let r=0;for(let n of this){if(Reflect.apply(e,t,[n,r,this]))return n;r++}}findIndex(e,t){let r=0;for(let n of this){if(Reflect.apply(e,t,[n,r,this]))return r;r++}return -1}filter(t,r){let n=[],i=0;for(let e of this)Reflect.apply(t,r,[e,i,this])&&n.push(e),i++;return new e(n)}map(t,r){let n=[],i=0;for(let e of this)n.push([e[0],Reflect.apply(t,r,[e,i,this])]),i++;return new e(n)}reduce(...e){let[t,r]=e,n=0,i=r??this.at(0);for(let r of this)i=0===n&&1===e.length?r:Reflect.apply(t,this,[i,r,n,this]),n++;return i}reduceRight(...e){let[t,r]=e,n=r??this.at(-1);for(let r=this.size-1;r>=0;r--){let i=this.at(r);n=r===this.size-1&&1===e.length?i:Reflect.apply(t,this,[n,i,r,this])}return n}toSorted(t){return new e([...this.entries()].sort(t))}toReversed(){let t=new e;for(let e=this.size-1;e>=0;e--){let r=this.keyAt(e),n=this.get(r);t.set(r,n)}return t}toSpliced(...t){let r=[...this.entries()];return r.splice(...t),new e(r)}slice(t,r){let n=new e,i=this.size-1;if(void 0===t)return n;t<0&&(t+=this.size),void 0!==r&&r>0&&(i=r-1);for(let e=t;e<=i;e++){let t=this.keyAt(e),r=this.get(t);n.set(t,r)}return n}every(e,t){let r=0;for(let n of this){if(!Reflect.apply(e,t,[n,r,this]))return!1;r++}return!0}some(e,t){let r=0;for(let n of this){if(Reflect.apply(e,t,[n,r,this]))return!0;r++}return!1}}),e.s(["createCollection",()=>l],75830)},48425,30207,e=>{"use strict";var t=e.i(71645),r=e.i(74080),n=e.i(20783),i=e.i(43476),s=Symbol("radix.slottable");function a(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===s}var o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{var s,o;let l,u,c,h=(o=s=`Primitive.${r}`,(l=t.forwardRef((e,r)=>{let{children:i,...s}=e;if(t.isValidElement(i)){var a;let e,o,l=(a=i,(o=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(o=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),u=function(e,t){let r={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...e)=>{let t=s(...e);return i(...e),t}:i&&(r[n]=i):"style"===n?r[n]={...i,...s}:"className"===n&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}(s,i.props);return i.type!==t.Fragment&&(u.ref=r?(0,n.composeRefs)(r,l):l),t.cloneElement(i,u)}return t.Children.count(i)>1?t.Children.only(null):null})).displayName=`${o}.SlotClone`,u=l,(c=t.forwardRef((e,r)=>{let{children:n,...s}=e,o=t.Children.toArray(n),l=o.find(a);if(l){let e=l.props.children,n=o.map(r=>r!==l?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(u,{...s,ref:r,children:t.isValidElement(e)?t.cloneElement(e,void 0,n):null})}return(0,i.jsx)(u,{...s,ref:r,children:n})})).displayName=`${s}.Slot`,c),d=t.forwardRef((e,t)=>{let{asChild:n,...s}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(n?h:r,{...s,ref:t})});return d.displayName=`Primitive.${r}`,{...e,[r]:d}},{});function l(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}function u(e){let r=t.useRef(e);return t.useEffect(()=>{r.current=e}),t.useMemo(()=>(...e)=>r.current?.(...e),[])}e.s(["Primitive",()=>o,"dispatchDiscreteCustomEvent",()=>l],48425),e.s(["useCallbackRef",()=>u],30207)},26330,e=>{"use strict";var t,r=e.i(71645),n=e.i(81140),i=e.i(48425),s=e.i(20783),a=e.i(30207),o=e.i(43476),l="dismissableLayer.update",u=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),c=r.forwardRef((e,c)=>{let{disableOutsidePointerEvents:h=!1,onEscapeKeyDown:p,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:y,onDismiss:v,...w}=e,b=r.useContext(u),[_,I]=r.useState(null),E=_?.ownerDocument??globalThis?.document,[,T]=r.useState({}),S=(0,s.useComposedRefs)(c,e=>I(e)),C=Array.from(b.layers),[k]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),x=C.indexOf(k),A=_?C.indexOf(_):-1,N=b.layersWithOutsidePointerEventsDisabled.size>0,D=A>=x,R=function(e,t=globalThis?.document){let n=(0,a.useCallbackRef)(e),i=r.useRef(!1),s=r.useRef(()=>{});return r.useEffect(()=>{let e=e=>{if(e.target&&!i.current){let r=function(){f("dismissableLayer.pointerDownOutside",n,i,{discrete:!0})},i={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",s.current),s.current=r,t.addEventListener("click",s.current,{once:!0})):r()}else t.removeEventListener("click",s.current);i.current=!1},r=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(r),t.removeEventListener("pointerdown",e),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}(e=>{let t=e.target,r=[...b.branches].some(e=>e.contains(t));D&&!r&&(m?.(e),y?.(e),e.defaultPrevented||v?.())},E),O=function(e,t=globalThis?.document){let n=(0,a.useCallbackRef)(e),i=r.useRef(!1);return r.useEffect(()=>{let e=e=>{e.target&&!i.current&&f("dismissableLayer.focusOutside",n,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}(e=>{let t=e.target;![...b.branches].some(e=>e.contains(t))&&(g?.(e),y?.(e),e.defaultPrevented||v?.())},E);return!function(e,t=globalThis?.document){let n=(0,a.useCallbackRef)(e);r.useEffect(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[n,t])}(e=>{A===b.layers.size-1&&(p?.(e),!e.defaultPrevented&&v&&(e.preventDefault(),v()))},E),r.useEffect(()=>{if(_)return h&&(0===b.layersWithOutsidePointerEventsDisabled.size&&(t=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(_)),b.layers.add(_),d(),()=>{h&&1===b.layersWithOutsidePointerEventsDisabled.size&&(E.body.style.pointerEvents=t)}},[_,E,h,b]),r.useEffect(()=>()=>{_&&(b.layers.delete(_),b.layersWithOutsidePointerEventsDisabled.delete(_),d())},[_,b]),r.useEffect(()=>{let e=()=>T({});return document.addEventListener(l,e),()=>document.removeEventListener(l,e)},[]),(0,o.jsx)(i.Primitive.div,{...w,ref:S,style:{pointerEvents:N?D?"auto":"none":void 0,...e.style},onFocusCapture:(0,n.composeEventHandlers)(e.onFocusCapture,O.onFocusCapture),onBlurCapture:(0,n.composeEventHandlers)(e.onBlurCapture,O.onBlurCapture),onPointerDownCapture:(0,n.composeEventHandlers)(e.onPointerDownCapture,R.onPointerDownCapture)})});c.displayName="DismissableLayer";var h=r.forwardRef((e,t)=>{let n=r.useContext(u),a=r.useRef(null),l=(0,s.useComposedRefs)(t,a);return r.useEffect(()=>{let e=a.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}},[n.branches]),(0,o.jsx)(i.Primitive.div,{...e,ref:l})});function d(){let e=new CustomEvent(l);document.dispatchEvent(e)}function f(e,t,r,{discrete:n}){let s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?(0,i.dispatchDiscreteCustomEvent)(s,a):s.dispatchEvent(a)}h.displayName="DismissableLayerBranch",e.s(["Branch",()=>h,"DismissableLayer",()=>c,"Root",()=>c],26330)},34620,e=>{"use strict";var t=e.i(71645),r=globalThis?.document?t.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>r])},74606,e=>{"use strict";var t=e.i(71645),r=e.i(74080),n=e.i(48425),i=e.i(34620),s=e.i(43476),a=t.forwardRef((e,a)=>{let{container:o,...l}=e,[u,c]=t.useState(!1);(0,i.useLayoutEffect)(()=>c(!0),[]);let h=o||u&&globalThis?.document?.body;return h?r.default.createPortal((0,s.jsx)(n.Primitive.div,{...l,ref:a}),h):null});a.displayName="Portal",e.s(["Portal",()=>a])},96626,e=>{"use strict";var t=e.i(71645),r=e.i(20783),n=e.i(34620),i=e=>{var i;let a,o,{present:l,children:u}=e,c=function(e){var r,i;let[a,o]=t.useState(),l=t.useRef(null),u=t.useRef(e),c=t.useRef("none"),[h,d]=(r=e?"mounted":"unmounted",i={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>i[e][t]??e,r));return t.useEffect(()=>{let e=s(l.current);c.current="mounted"===h?e:"none"},[h]),(0,n.useLayoutEffect)(()=>{let t=l.current,r=u.current;if(r!==e){let n=c.current,i=s(t);e?d("MOUNT"):"none"===i||t?.display==="none"?d("UNMOUNT"):r&&n!==i?d("ANIMATION_OUT"):d("UNMOUNT"),u.current=e}},[e,d]),(0,n.useLayoutEffect)(()=>{if(a){let e,t=a.ownerDocument.defaultView??window,r=r=>{let n=s(l.current).includes(CSS.escape(r.animationName));if(r.target===a&&n&&(d("ANIMATION_END"),!u.current)){let r=a.style.animationFillMode;a.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===a.style.animationFillMode&&(a.style.animationFillMode=r)})}},n=e=>{e.target===a&&(c.current=s(l.current))};return a.addEventListener("animationstart",n),a.addEventListener("animationcancel",r),a.addEventListener("animationend",r),()=>{t.clearTimeout(e),a.removeEventListener("animationstart",n),a.removeEventListener("animationcancel",r),a.removeEventListener("animationend",r)}}d("ANIMATION_END")},[a,d]),{isPresent:["mounted","unmountSuspended"].includes(h),ref:t.useCallback(e=>{l.current=e?getComputedStyle(e):null,o(e)},[])}}(l),h="function"==typeof u?u({present:c.isPresent}):t.Children.only(u),d=(0,r.useComposedRefs)(c.ref,(i=h,(o=(a=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?i.ref:(o=(a=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?i.props.ref:i.props.ref||i.ref));return"function"==typeof u||c.isPresent?t.cloneElement(h,{ref:d}):null};function s(e){return e?.animationName||"none"}i.displayName="Presence",e.s(["Presence",()=>i])},69340,e=>{"use strict";var t=e.i(71645),r=e.i(34620);t[" useEffectEvent ".trim().toString()],t[" useInsertionEffect ".trim().toString()];var n=t[" useInsertionEffect ".trim().toString()]||r.useLayoutEffect;function i({prop:e,defaultProp:r,onChange:i=()=>{},caller:s}){let[a,o,l]=function({defaultProp:e,onChange:r}){let[i,s]=t.useState(e),a=t.useRef(i),o=t.useRef(r);return n(()=>{o.current=r},[r]),t.useEffect(()=>{a.current!==i&&(o.current?.(i),a.current=i)},[i,a]),[i,s,o]}({defaultProp:r,onChange:i}),u=void 0!==e,c=u?e:a;{let r=t.useRef(void 0!==e);t.useEffect(()=>{let e=r.current;if(e!==u){let t=u?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}r.current=u},[u,s])}return[c,t.useCallback(t=>{if(u){let r="function"==typeof t?t(e):t;r!==e&&l.current?.(r)}else o(t)},[u,e,o,l])]}Symbol("RADIX:SYNC_STATE"),e.s(["useControllableState",()=>i],69340)},59411,e=>{"use strict";var t=e.i(71645),r=e.i(48425),n=e.i(43476),i=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),s=t.forwardRef((e,t)=>(0,n.jsx)(r.Primitive.span,{...e,ref:t,style:{...i,...e.style}}));s.displayName="VisuallyHidden",e.s(["VISUALLY_HIDDEN_STYLES",()=>i,"VisuallyHidden",()=>s])},7670,e=>{"use strict";function t(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}(e))&&(n&&(n+=" "),n+=t);return n}e.s(["clsx",()=>t,"default",0,t])},25913,e=>{"use strict";var t=e.i(7670);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=t.clsx;e.s(["cva",0,(e,t)=>i=>{var s;if((null==t?void 0:t.variants)==null)return n(e,null==i?void 0:i.class,null==i?void 0:i.className);let{variants:a,defaultVariants:o}=t,l=Object.keys(a).map(e=>{let t=null==i?void 0:i[e],n=null==o?void 0:o[e];if(null===t)return null;let s=r(t)||r(n);return a[e][s]}),u=i&&Object.entries(i).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return n(e,l,null==t||null==(s=t.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:n,...i}=t;return Object.entries(i).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...o,...u}[t]):({...o,...u})[t]===r})?[...e,r,n]:e},[]),null==i?void 0:i.class,null==i?void 0:i.className)}])},41947,75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,iconNode:u,...c},h)=>(0,t.createElement)("svg",{ref:h,...i,width:r,height:r,stroke:e,strokeWidth:a?24*Number(s)/Number(r):s,className:n("lucide",o),...!l&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...u.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(l)?l:[l]])),a=(e,i)=>{let a=(0,t.forwardRef)(({className:a,...o},l)=>(0,t.createElement)(s,{ref:l,iconNode:i,className:n(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,a),...o}));return a.displayName=r(e),a};e.s(["default",()=>a],75254);let o=a("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["default",()=>o],41947)},37727,e=>{"use strict";var t=e.i(41947);e.s(["X",()=>t.default])},75157,e=>{"use strict";var t=e.i(7670);let r=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),n=[],i=(e,t,r)=>{if(0==e.length-t)return r.classGroupId;let n=e[t],s=r.nextPart.get(n);if(s){let r=i(e,t+1,s);if(r)return r}let a=r.validators;if(null===a)return;let o=0===t?e.join("-"):e.slice(t).join("-"),l=a.length;for(let e=0;e<l;e++){let t=a[e];if(t.validator(o))return t.classGroupId}},s=(e,t)=>{let n=r();for(let r in e)a(e[r],n,r,t);return n},a=(e,t,r,n)=>{let i=e.length;for(let s=0;s<i;s++)o(e[s],t,r,n)},o=(e,t,r,n)=>{"string"==typeof e?l(e,t,r):"function"==typeof e?u(e,t,r,n):c(e,t,r,n)},l=(e,t,r)=>{(""===e?t:h(t,e)).classGroupId=r},u=(e,t,r,n)=>{d(e)?a(e(n),t,r,n):(null===t.validators&&(t.validators=[]),t.validators.push({classGroupId:r,validator:e}))},c=(e,t,r,n)=>{let i=Object.entries(e),s=i.length;for(let e=0;e<s;e++){let[s,o]=i[e];a(o,h(t,s),r,n)}},h=(e,t)=>{let n=e,i=t.split("-"),s=i.length;for(let e=0;e<s;e++){let t=i[e],s=n.nextPart.get(t);s||(s=r(),n.nextPart.set(t,s)),n=s}return n},d=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,f=[],p=(e,t,r,n,i)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:n,isExternal:i}),m=/\s+/,g=e=>{let t;if("string"==typeof e)return e;let r="";for(let n=0;n<e.length;n++)e[n]&&(t=g(e[n]))&&(r&&(r+=" "),r+=t);return r},y=[],v=e=>{let t=t=>t[e]||y;return t.isThemeGetter=!0,t},w=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,b=/^\((?:(\w[\w-]*):)?(.+)\)$/i,_=/^\d+\/\d+$/,I=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,E=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,T=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,S=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,C=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,k=e=>_.test(e),x=e=>!!e&&!Number.isNaN(Number(e)),A=e=>!!e&&Number.isInteger(Number(e)),N=e=>e.endsWith("%")&&x(e.slice(0,-1)),D=e=>I.test(e),R=()=>!0,O=e=>E.test(e)&&!T.test(e),P=()=>!1,L=e=>S.test(e),M=e=>C.test(e),F=e=>!U(e)&&!G(e),V=e=>X(e,er,P),U=e=>w.test(e),B=e=>X(e,en,O),j=e=>X(e,ei,x),q=e=>X(e,ee,P),z=e=>X(e,et,M),$=e=>X(e,ea,L),G=e=>b.test(e),K=e=>Z(e,en),H=e=>Z(e,es),W=e=>Z(e,ee),Q=e=>Z(e,er),J=e=>Z(e,et),Y=e=>Z(e,ea,!0),X=(e,t,r)=>{let n=w.exec(e);return!!n&&(n[1]?t(n[1]):r(n[2]))},Z=(e,t,r=!1)=>{let n=b.exec(e);return!!n&&(n[1]?t(n[1]):r)},ee=e=>"position"===e||"percentage"===e,et=e=>"image"===e||"url"===e,er=e=>"length"===e||"size"===e||"bg-size"===e,en=e=>"length"===e,ei=e=>"number"===e,es=e=>"family-name"===e,ea=e=>"shadow"===e,eo=((e,...t)=>{let r,a,o,l,u=e=>{let t=a(e);if(t)return t;let n=((e,t)=>{let{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:s}=t,a=[],o=e.trim().split(m),l="";for(let e=o.length-1;e>=0;e-=1){let t=o[e],{isExternal:u,modifiers:c,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}=r(t);if(u){l=t+(l.length>0?" "+l:l);continue}let p=!!f,m=n(p?d.substring(0,f):d);if(!m){if(!p||!(m=n(d))){l=t+(l.length>0?" "+l:l);continue}p=!1}let g=0===c.length?"":1===c.length?c[0]:s(c).join(":"),y=h?g+"!":g,v=y+m;if(a.indexOf(v)>-1)continue;a.push(v);let w=i(m,p);for(let e=0;e<w.length;++e){let t=w[e];a.push(y+t)}l=t+(l.length>0?" "+l:l)}return l})(e,r);return o(e,n),n};return l=c=>{var h;let d;return a=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=Object.create(null),n=Object.create(null),i=(i,s)=>{r[i]=s,++t>e&&(t=0,n=r,r=Object.create(null))};return{get(e){let t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(i(e,t),t):void 0},set(e,t){e in r?r[e]=t:i(e,t)}}})((h=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,n=e=>{let t,r=[],n=0,i=0,s=0,a=e.length;for(let o=0;o<a;o++){let a=e[o];if(0===n&&0===i){if(":"===a){r.push(e.slice(s,o)),s=o+1;continue}if("/"===a){t=o;continue}}"["===a?n++:"]"===a?n--:"("===a?i++:")"===a&&i--}let o=0===r.length?e:e.slice(s),l=o,u=!1;return o.endsWith("!")?(l=o.slice(0,-1),u=!0):o.startsWith("!")&&(l=o.slice(1),u=!0),p(r,u,l,t&&t>s?t-s:void 0)};if(t){let e=t+":",r=n;n=t=>t.startsWith(e)?r(t.slice(e.length)):p(f,!1,t,void 0,!0)}if(r){let e=n;n=t=>r({className:t,parseClassName:e})}return n})(h),sortModifiers:(d=new Map,h.orderSensitiveModifiers.forEach((e,t)=>{d.set(e,1e6+t)}),e=>{let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n],s="["===i[0],a=d.has(i);s||a?(r.length>0&&(r.sort(),t.push(...r),r=[]),t.push(i)):r.push(i)}return r.length>0&&(r.sort(),t.push(...r)),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e;return s(r,t)})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]")){var r;let t,n,i;return -1===(r=e).slice(1,-1).indexOf(":")?void 0:(n=(t=r.slice(1,-1)).indexOf(":"),(i=t.slice(0,n))?"arbitrary.."+i:void 0)}let n=e.split("-"),s=+(""===n[0]&&n.length>1);return i(n,s,t)},getConflictingClassGroupIds:(e,t)=>{if(t){let t=a[e],i=r[e];if(t){if(i){let e=Array(i.length+t.length);for(let t=0;t<i.length;t++)e[t]=i[t];for(let r=0;r<t.length;r++)e[i.length+r]=t[r];return e}return t}return i||n}return r[e]||n}}})(h)}).cache.get,o=r.cache.set,l=u,u(c)},(...e)=>l(((...e)=>{let t,r,n=0,i="";for(;n<e.length;)(t=e[n++])&&(r=g(t))&&(i&&(i+=" "),i+=r);return i})(...e))})(()=>{let e=v("color"),t=v("font"),r=v("text"),n=v("font-weight"),i=v("tracking"),s=v("leading"),a=v("breakpoint"),o=v("container"),l=v("spacing"),u=v("radius"),c=v("shadow"),h=v("inset-shadow"),d=v("text-shadow"),f=v("drop-shadow"),p=v("blur"),m=v("perspective"),g=v("aspect"),y=v("ease"),w=v("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],I=()=>[..._(),G,U],E=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto","contain","none"],S=()=>[G,U,l],C=()=>[k,"full","auto",...S()],O=()=>[A,"none","subgrid",G,U],P=()=>["auto",{span:["full",A,G,U]},A,G,U],L=()=>[A,"auto",G,U],M=()=>["auto","min","max","fr",G,U],X=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Z=()=>["start","end","center","stretch","center-safe","end-safe"],ee=()=>["auto",...S()],et=()=>[k,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...S()],er=()=>[e,G,U],en=()=>[..._(),W,q,{position:[G,U]}],ei=()=>["no-repeat",{repeat:["","x","y","space","round"]}],es=()=>["auto","cover","contain",Q,V,{size:[G,U]}],ea=()=>[N,K,B],eo=()=>["","none","full",u,G,U],el=()=>["",x,K,B],eu=()=>["solid","dashed","dotted","double"],ec=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],eh=()=>[x,N,W,q],ed=()=>["","none",p,G,U],ef=()=>["none",x,G,U],ep=()=>["none",x,G,U],em=()=>[x,G,U],eg=()=>[k,"full",...S()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[D],breakpoint:[D],color:[R],container:[D],"drop-shadow":[D],ease:["in","out","in-out"],font:[F],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[D],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[D],shadow:[D],spacing:["px",x],text:[D],"text-shadow":[D],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",k,U,G,g]}],container:["container"],columns:[{columns:[x,U,G,o]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:I()}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:C()}],"inset-x":[{"inset-x":C()}],"inset-y":[{"inset-y":C()}],start:[{start:C()}],end:[{end:C()}],top:[{top:C()}],right:[{right:C()}],bottom:[{bottom:C()}],left:[{left:C()}],visibility:["visible","invisible","collapse"],z:[{z:[A,"auto",G,U]}],basis:[{basis:[k,"full","auto",o,...S()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[x,k,"auto","initial","none",U]}],grow:[{grow:["",x,G,U]}],shrink:[{shrink:["",x,G,U]}],order:[{order:[A,"first","last","none",G,U]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:P()}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:P()}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":M()}],"auto-rows":[{"auto-rows":M()}],gap:[{gap:S()}],"gap-x":[{"gap-x":S()}],"gap-y":[{"gap-y":S()}],"justify-content":[{justify:[...X(),"normal"]}],"justify-items":[{"justify-items":[...Z(),"normal"]}],"justify-self":[{"justify-self":["auto",...Z()]}],"align-content":[{content:["normal",...X()]}],"align-items":[{items:[...Z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Z(),{baseline:["","last"]}]}],"place-content":[{"place-content":X()}],"place-items":[{"place-items":[...Z(),"baseline"]}],"place-self":[{"place-self":["auto",...Z()]}],p:[{p:S()}],px:[{px:S()}],py:[{py:S()}],ps:[{ps:S()}],pe:[{pe:S()}],pt:[{pt:S()}],pr:[{pr:S()}],pb:[{pb:S()}],pl:[{pl:S()}],m:[{m:ee()}],mx:[{mx:ee()}],my:[{my:ee()}],ms:[{ms:ee()}],me:[{me:ee()}],mt:[{mt:ee()}],mr:[{mr:ee()}],mb:[{mb:ee()}],ml:[{ml:ee()}],"space-x":[{"space-x":S()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":S()}],"space-y-reverse":["space-y-reverse"],size:[{size:et()}],w:[{w:[o,"screen",...et()]}],"min-w":[{"min-w":[o,"screen","none",...et()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...et()]}],h:[{h:["screen","lh",...et()]}],"min-h":[{"min-h":["screen","lh","none",...et()]}],"max-h":[{"max-h":["screen","lh",...et()]}],"font-size":[{text:["base",r,K,B]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,G,j]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",N,U]}],"font-family":[{font:[H,U,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,G,U]}],"line-clamp":[{"line-clamp":[x,"none",G,j]}],leading:[{leading:[s,...S()]}],"list-image":[{"list-image":["none",G,U]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",G,U]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:er()}],"text-color":[{text:er()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...eu(),"wavy"]}],"text-decoration-thickness":[{decoration:[x,"from-font","auto",G,B]}],"text-decoration-color":[{decoration:er()}],"underline-offset":[{"underline-offset":[x,"auto",G,U]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",G,U]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",G,U]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:en()}],"bg-repeat":[{bg:ei()}],"bg-size":[{bg:es()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},A,G,U],radial:["",G,U],conic:[A,G,U]},J,z]}],"bg-color":[{bg:er()}],"gradient-from-pos":[{from:ea()}],"gradient-via-pos":[{via:ea()}],"gradient-to-pos":[{to:ea()}],"gradient-from":[{from:er()}],"gradient-via":[{via:er()}],"gradient-to":[{to:er()}],rounded:[{rounded:eo()}],"rounded-s":[{"rounded-s":eo()}],"rounded-e":[{"rounded-e":eo()}],"rounded-t":[{"rounded-t":eo()}],"rounded-r":[{"rounded-r":eo()}],"rounded-b":[{"rounded-b":eo()}],"rounded-l":[{"rounded-l":eo()}],"rounded-ss":[{"rounded-ss":eo()}],"rounded-se":[{"rounded-se":eo()}],"rounded-ee":[{"rounded-ee":eo()}],"rounded-es":[{"rounded-es":eo()}],"rounded-tl":[{"rounded-tl":eo()}],"rounded-tr":[{"rounded-tr":eo()}],"rounded-br":[{"rounded-br":eo()}],"rounded-bl":[{"rounded-bl":eo()}],"border-w":[{border:el()}],"border-w-x":[{"border-x":el()}],"border-w-y":[{"border-y":el()}],"border-w-s":[{"border-s":el()}],"border-w-e":[{"border-e":el()}],"border-w-t":[{"border-t":el()}],"border-w-r":[{"border-r":el()}],"border-w-b":[{"border-b":el()}],"border-w-l":[{"border-l":el()}],"divide-x":[{"divide-x":el()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":el()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...eu(),"hidden","none"]}],"divide-style":[{divide:[...eu(),"hidden","none"]}],"border-color":[{border:er()}],"border-color-x":[{"border-x":er()}],"border-color-y":[{"border-y":er()}],"border-color-s":[{"border-s":er()}],"border-color-e":[{"border-e":er()}],"border-color-t":[{"border-t":er()}],"border-color-r":[{"border-r":er()}],"border-color-b":[{"border-b":er()}],"border-color-l":[{"border-l":er()}],"divide-color":[{divide:er()}],"outline-style":[{outline:[...eu(),"none","hidden"]}],"outline-offset":[{"outline-offset":[x,G,U]}],"outline-w":[{outline:["",x,K,B]}],"outline-color":[{outline:er()}],shadow:[{shadow:["","none",c,Y,$]}],"shadow-color":[{shadow:er()}],"inset-shadow":[{"inset-shadow":["none",h,Y,$]}],"inset-shadow-color":[{"inset-shadow":er()}],"ring-w":[{ring:el()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:er()}],"ring-offset-w":[{"ring-offset":[x,B]}],"ring-offset-color":[{"ring-offset":er()}],"inset-ring-w":[{"inset-ring":el()}],"inset-ring-color":[{"inset-ring":er()}],"text-shadow":[{"text-shadow":["none",d,Y,$]}],"text-shadow-color":[{"text-shadow":er()}],opacity:[{opacity:[x,G,U]}],"mix-blend":[{"mix-blend":[...ec(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ec()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[x]}],"mask-image-linear-from-pos":[{"mask-linear-from":eh()}],"mask-image-linear-to-pos":[{"mask-linear-to":eh()}],"mask-image-linear-from-color":[{"mask-linear-from":er()}],"mask-image-linear-to-color":[{"mask-linear-to":er()}],"mask-image-t-from-pos":[{"mask-t-from":eh()}],"mask-image-t-to-pos":[{"mask-t-to":eh()}],"mask-image-t-from-color":[{"mask-t-from":er()}],"mask-image-t-to-color":[{"mask-t-to":er()}],"mask-image-r-from-pos":[{"mask-r-from":eh()}],"mask-image-r-to-pos":[{"mask-r-to":eh()}],"mask-image-r-from-color":[{"mask-r-from":er()}],"mask-image-r-to-color":[{"mask-r-to":er()}],"mask-image-b-from-pos":[{"mask-b-from":eh()}],"mask-image-b-to-pos":[{"mask-b-to":eh()}],"mask-image-b-from-color":[{"mask-b-from":er()}],"mask-image-b-to-color":[{"mask-b-to":er()}],"mask-image-l-from-pos":[{"mask-l-from":eh()}],"mask-image-l-to-pos":[{"mask-l-to":eh()}],"mask-image-l-from-color":[{"mask-l-from":er()}],"mask-image-l-to-color":[{"mask-l-to":er()}],"mask-image-x-from-pos":[{"mask-x-from":eh()}],"mask-image-x-to-pos":[{"mask-x-to":eh()}],"mask-image-x-from-color":[{"mask-x-from":er()}],"mask-image-x-to-color":[{"mask-x-to":er()}],"mask-image-y-from-pos":[{"mask-y-from":eh()}],"mask-image-y-to-pos":[{"mask-y-to":eh()}],"mask-image-y-from-color":[{"mask-y-from":er()}],"mask-image-y-to-color":[{"mask-y-to":er()}],"mask-image-radial":[{"mask-radial":[G,U]}],"mask-image-radial-from-pos":[{"mask-radial-from":eh()}],"mask-image-radial-to-pos":[{"mask-radial-to":eh()}],"mask-image-radial-from-color":[{"mask-radial-from":er()}],"mask-image-radial-to-color":[{"mask-radial-to":er()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[x]}],"mask-image-conic-from-pos":[{"mask-conic-from":eh()}],"mask-image-conic-to-pos":[{"mask-conic-to":eh()}],"mask-image-conic-from-color":[{"mask-conic-from":er()}],"mask-image-conic-to-color":[{"mask-conic-to":er()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:en()}],"mask-repeat":[{mask:ei()}],"mask-size":[{mask:es()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",G,U]}],filter:[{filter:["","none",G,U]}],blur:[{blur:ed()}],brightness:[{brightness:[x,G,U]}],contrast:[{contrast:[x,G,U]}],"drop-shadow":[{"drop-shadow":["","none",f,Y,$]}],"drop-shadow-color":[{"drop-shadow":er()}],grayscale:[{grayscale:["",x,G,U]}],"hue-rotate":[{"hue-rotate":[x,G,U]}],invert:[{invert:["",x,G,U]}],saturate:[{saturate:[x,G,U]}],sepia:[{sepia:["",x,G,U]}],"backdrop-filter":[{"backdrop-filter":["","none",G,U]}],"backdrop-blur":[{"backdrop-blur":ed()}],"backdrop-brightness":[{"backdrop-brightness":[x,G,U]}],"backdrop-contrast":[{"backdrop-contrast":[x,G,U]}],"backdrop-grayscale":[{"backdrop-grayscale":["",x,G,U]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[x,G,U]}],"backdrop-invert":[{"backdrop-invert":["",x,G,U]}],"backdrop-opacity":[{"backdrop-opacity":[x,G,U]}],"backdrop-saturate":[{"backdrop-saturate":[x,G,U]}],"backdrop-sepia":[{"backdrop-sepia":["",x,G,U]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":S()}],"border-spacing-x":[{"border-spacing-x":S()}],"border-spacing-y":[{"border-spacing-y":S()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",G,U]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[x,"initial",G,U]}],ease:[{ease:["linear","initial",y,G,U]}],delay:[{delay:[x,G,U]}],animate:[{animate:["none",w,G,U]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,G,U]}],"perspective-origin":[{"perspective-origin":I()}],rotate:[{rotate:ef()}],"rotate-x":[{"rotate-x":ef()}],"rotate-y":[{"rotate-y":ef()}],"rotate-z":[{"rotate-z":ef()}],scale:[{scale:ep()}],"scale-x":[{"scale-x":ep()}],"scale-y":[{"scale-y":ep()}],"scale-z":[{"scale-z":ep()}],"scale-3d":["scale-3d"],skew:[{skew:em()}],"skew-x":[{"skew-x":em()}],"skew-y":[{"skew-y":em()}],transform:[{transform:[G,U,"","none","gpu","cpu"]}],"transform-origin":[{origin:I()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:eg()}],"translate-x":[{"translate-x":eg()}],"translate-y":[{"translate-y":eg()}],"translate-z":[{"translate-z":eg()}],"translate-none":["translate-none"],accent:[{accent:er()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:er()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",G,U]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",G,U]}],fill:[{fill:["none",...er()]}],"stroke-w":[{stroke:[x,K,B,j]}],stroke:[{stroke:["none",...er()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function el(...e){return eo((0,t.clsx)(e))}e.s(["cn",()=>el],75157)},94690,36180,98925,59141,e=>{"use strict";let t,r,n;var i,s,a,o,l,u,c,h,d,f,p,m,g,y,v,w,b,_=e.i(43476),I=e.i(71645),E=e.i(47167);let T=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},S=function(e){let t=[],r=0,n=0;for(;r<e.length;){let i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=((7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},C={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,u=i>>2,c=(3&i)<<4|a>>4,h=(15&a)<<2|l>>6,d=63&l;!o&&(d=64,s||(h=64)),n.push(r[u],r[c],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(T(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):S(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let i=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new k;let l=i<<2|s>>4;if(n.push(l),64!==a){let e=s<<4&240|a>>2;if(n.push(e),64!==o){let e=a<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class k extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let x=function(e){let t=T(e);return C.encodeByteArray(t,!0)},A=function(e){return x(e).replace(/\./g,"")},N=function(e){try{return C.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function D(){return"u">typeof self?self:"u">typeof window?window:e.g}let R=()=>{try{return D().__FIREBASE_DEFAULTS__||(()=>{if(void 0===E.default||void 0===E.default.env)return;let e=E.default.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("u"<typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&N(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},O=e=>R()?.emulatorHosts?.[e],P=()=>R()?.config,L=e=>R()?.[`_${e}`];class M{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function F(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function V(e){return(await fetch(e,{credentials:"include"})).ok}let U={},B=!1;function j(e,t){if("u"<typeof window||"u"<typeof document||!F(window.location.host)||U[e]===t||U[e]||B)return;function r(e){return`__firebase__banner__${e}`}U[e]=t;let n="__firebase__banner",i=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(U))U[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(n),t=!1,e||((e=document.createElement("div")).setAttribute("id",n),t=!0),{created:t,element:e}),a=r("text"),o=document.getElementById(a)||document.createElement("span"),l=r("learnmore"),u=document.getElementById(l)||document.createElement("a"),c=r("preprendIcon"),h=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e,t=s.element;t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center",u.setAttribute("id",l),u.innerText="Learn more",u.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",u.setAttribute("target","__blank"),u.style.paddingLeft="5px",u.style.textDecoration="underline";let r=((e=document.createElement("span")).style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{let e;B=!0,(e=document.getElementById(n))&&e.remove()},e);h.setAttribute("width","24"),h.setAttribute("id",c),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px",t.append(h,o,u,r),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",h.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(h.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,o.innerText="Preview backend running in this workspace."),o.setAttribute("id",a)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function q(){return"u">typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function z(){let t=R()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}function $(){return"u">typeof WorkerGlobalScope&&"u">typeof self&&self instanceof WorkerGlobalScope}function G(){return!z()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function K(){return!z()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function H(){try{return"object"==typeof indexedDB}catch(e){return!1}}class W extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,W.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Q.prototype.create)}}class Q{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,n;let i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?(r=a,n=i,r.replace(J,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new W(s,l,i)}}let J=/\{\$([^}]+)}/g;function Y(e,t){if(e===t)return!0;let r=Object.keys(e),n=Object.keys(t);for(let i of r){if(!n.includes(i))return!1;let r=e[i],s=t[i];if(X(r)&&X(s)){if(!Y(r,s))return!1}else if(r!==s)return!1}for(let e of n)if(!r.includes(e))return!1;return!0}function X(e){return null!==e&&"object"==typeof e}function Z(e){let t=[];for(let[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function ee(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}}),t}function et(e){let t=e.indexOf("?");if(!t)return"";let r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}class er{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");void 0===(n=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:r}:e).next&&(n.next=en),void 0===n.error&&(n.error=en),void 0===n.complete&&(n.complete=en);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"u">typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function en(){}function ei(e){return e&&e._delegate?e._delegate:e}class es{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let ea="[DEFAULT]";class eo{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new M;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:ea})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=ea){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=ea){return this.instances.has(e)}getOptions(e=ea){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),n=this.onInitCallbacks.get(r)??new Set;n.add(e),this.onInitCallbacks.set(r,n);let i=this.instances.get(r);return i&&e(i,r),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let n of r)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===ea?void 0:r,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ea){return this.component?this.component.multipleInstances?e:ea:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class el{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new eo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let eu=[];(i=a||(a={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";let ec={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},eh=a.INFO,ed={[a.DEBUG]:"log",[a.VERBOSE]:"log",[a.INFO]:"info",[a.WARN]:"warn",[a.ERROR]:"error"},ef=(e,t,...r)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),i=ed[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ep{constructor(e){this.name=e,this._logLevel=eh,this._logHandler=ef,this._userLogHandler=null,eu.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in a))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ec[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,a.DEBUG,...e),this._logHandler(this,a.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,a.VERBOSE,...e),this._logHandler(this,a.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,a.INFO,...e),this._logHandler(this,a.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,a.WARN,...e),this._logHandler(this,a.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,a.ERROR,...e),this._logHandler(this,a.ERROR,...e)}}let em=new WeakMap,eg=new WeakMap,ey=new WeakMap,ev=new WeakMap,ew=new WeakMap,eb={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return eg.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ey.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return e_(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function e_(e){if(e instanceof IDBRequest){let t;return(t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(e_(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)})).then(t=>{t instanceof IDBCursor&&em.set(t,e)}).catch(()=>{}),ew.set(t,e),t}if(ev.has(e))return ev.get(e);let n=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(eI(this),t),e_(em.get(this))}:function(...t){return e_(e.apply(eI(this),t))}:function(t,...r){let n=e.call(eI(this),t,...r);return ey.set(n,t.sort?t.sort():[t]),e_(n)};return e instanceof IDBTransaction&&function(e){if(eg.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});eg.set(e,t)}(e),(t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,eb):e}(e);return n!==e&&(ev.set(e,n),ew.set(n,e)),n}let eI=e=>ew.get(e),eE=["get","getKey","getAll","getAllKeys","count"],eT=["put","add","delete","clear"],eS=new Map;function eC(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(eS.get(t))return eS.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=eT.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||eE.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),i&&s.done]))[0]};return eS.set(t,s),s}eb={...n=eb,get:(e,t,r)=>eC(e,t)||n.get(e,t,r),has:(e,t)=>!!eC(e,t)||n.has(e,t)};class ek{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if(t=e.getComponent(),t?.type!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let ex="@firebase/app",eA="0.14.8",eN=new ep("@firebase/app"),eD="[DEFAULT]",eR={[ex]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},eO=new Map,eP=new Map,eL=new Map;function eM(e,t){try{e.container.addComponent(t)}catch(r){eN.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function eF(e,t){e.container.addOrOverwriteComponent(t)}function eV(e){let t=e.name;if(eL.has(t))return eN.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(eL.set(t,e),eO.values()))eM(r,e);for(let t of eP.values())eM(t,e);return!0}function eU(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function eB(e,t,r=eD){eU(e,t).clearInstance(r)}function ej(e){return void 0!==e.options}function eq(e){return!ej(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}function ez(e){return null!=e&&void 0!==e.settings}function e$(){eL.clear()}let eG=new Q("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class eK{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eG.create("app-deleted",{appName:this._name})}}function eH(e,t){let r=N(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class eW extends eK{constructor(e,t,r,n){const i=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:i};void 0!==e.apiKey?super(e,s,n):super(e.options,s,n),this._serverConfig={automaticDataCollectionEnabled:i,...t},this._serverConfig.authIdToken&&eH(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&eH(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"u">typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,e1(ex,eA,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){e0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw eG.create("server-app-deleted")}}let eQ="12.9.0";function eJ(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let n={name:eD,automaticDataCollectionEnabled:!0,...t},i=n.name;if("string"!=typeof i||!i)throw eG.create("bad-app-name",{appName:String(i)});if(r||(r=P()),!r)throw eG.create("no-options");let s=eO.get(i);if(s)if(Y(r,s.options)&&Y(n,s.config))return s;else throw eG.create("duplicate-app",{appName:i});let a=new el(i);for(let e of eL.values())a.addComponent(e);let o=new eK(r,n,a);return eO.set(i,o),o}function eY(e,t={}){let r;if(("u">typeof window||$())&&!$())throw eG.create("invalid-server-app-environment");let n=t||{};if(e&&(ej(e)?r=e.options:eq(e)?n=e:r=e),void 0===n.automaticDataCollectionEnabled&&(n.automaticDataCollectionEnabled=!0),r||(r=P()),!r)throw eG.create("no-options");let i={...n,...r};if(void 0!==i.releaseOnDeref&&delete i.releaseOnDeref,void 0!==n.releaseOnDeref&&"u"<typeof FinalizationRegistry)throw eG.create("finalization-registry-not-supported",{});let s=""+[...JSON.stringify(i)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),a=eP.get(s);if(a)return a.incRefCount(n.releaseOnDeref),a;let o=new el(s);for(let e of eL.values())o.addComponent(e);let l=new eW(r,n,s,o);return eP.set(s,l),l}function eX(e=eD){let t=eO.get(e);if(!t&&e===eD&&P())return eJ();if(!t)throw eG.create("no-app",{appName:e});return t}function eZ(){return Array.from(eO.values())}async function e0(e){let t=!1,r=e.name;eO.has(r)?(t=!0,eO.delete(r)):eP.has(r)&&0>=e.decRefCount()&&(eP.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function e1(e,t,r){let n=eR[e]??e;r&&(n+=`-${r}`);let i=n.match(/\s|\//),s=t.match(/\s|\//);if(i||s){let e=[`Unable to register library "${n}" with version "${t}":`];i&&e.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),eN.warn(e.join(" "));return}eV(new es(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}function e2(e,t){if(null!==e&&"function"!=typeof e)throw eG.create("invalid-log-argument");for(let r of eu){let n=null;t&&t.level&&(n=ec[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...i)=>{let s=i.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(n??t.logLevel)&&e({level:a[r].toLowerCase(),message:s,args:i,type:t.name})}}}function e6(e){eu.forEach(t=>{t.setLogLevel(e)})}let e3="firebase-heartbeat-store",e4=null;function e5(){return e4||(e4=(function(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(e,1),o=e_(a);return n&&a.addEventListener("upgradeneeded",e=>{n(e_(a.result),e.oldVersion,e.newVersion,e_(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(e3)}catch(e){console.warn(e)}}}).catch(e=>{throw eG.create("idb-open",{originalErrorMessage:e.message})})),e4}async function e8(e){try{let t=(await e5()).transaction(e3),r=await t.objectStore(e3).get(e9(e));return await t.done,r}catch(e){if(e instanceof W)eN.warn(e.message);else{let t=eG.create("idb-get",{originalErrorMessage:e?.message});eN.warn(t.message)}}}async function e7(e,t){try{let r=(await e5()).transaction(e3,"readwrite"),n=r.objectStore(e3);await n.put(t,e9(e)),await r.done}catch(e){if(e instanceof W)eN.warn(e.message);else{let t=eG.create("idb-set",{originalErrorMessage:e?.message});eN.warn(t.message)}}}function e9(e){return`${e.name}!${e.options.appId}`}class te{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tr(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=tt();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){eN.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=tt(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){let r=[],n=e.slice();for(let i of e){let e=r.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),tn(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),tn(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),n=A(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(e){return eN.warn(e),""}}}function tt(){return new Date().toISOString().substring(0,10)}class tr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!H()&&new Promise((e,t)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}}).then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await e8(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return e7(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return e7(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function tn(e){return A(JSON.stringify({version:2,heartbeats:e})).length}function ti(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}eV(new es("platform-logger",e=>new ek(e),"PRIVATE")),eV(new es("heartbeat",e=>new te(e),"PRIVATE")),e1(ex,eA,""),e1(ex,eA,"esm2020"),e1("fire-js",""),e.s(["SDK_VERSION",()=>eQ,"_DEFAULT_ENTRY_NAME",()=>eD,"_addComponent",()=>eM,"_addOrOverwriteComponent",()=>eF,"_apps",()=>eO,"_clearComponents",()=>e$,"_components",()=>eL,"_getProvider",()=>eU,"_isFirebaseApp",()=>ej,"_isFirebaseServerApp",()=>ez,"_isFirebaseServerAppSettings",()=>eq,"_registerComponent",()=>eV,"_removeServiceInstance",()=>eB,"_serverApps",()=>eP,"deleteApp",()=>e0,"getApp",()=>eX,"getApps",()=>eZ,"initializeApp",()=>eJ,"initializeServerApp",()=>eY,"onLog",()=>e2,"registerVersion",()=>e1,"setLogLevel",()=>e6],92953);let ts=new Q("auth","Firebase",ti()),ta=new ep("@firebase/auth");function to(e,...t){ta.logLevel<=a.ERROR&&ta.error(`Auth (${eQ}): ${e}`,...t)}function tl(e,...t){throw td(e,...t)}function tu(e,...t){return td(e,...t)}function tc(e,t,r){return new Q("auth","Firebase",{...ti(),[t]:r}).create(t,{appName:e.name})}function th(e){return tc(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function td(e,...t){if("string"!=typeof e){let r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return ts.create(e,...t)}function tf(e,t,...r){if(!e)throw td(t,...r)}function tp(e){let t="INTERNAL ASSERTION FAILED: "+e;throw to(t),Error(t)}function tm(){return"u">typeof self&&self.location?.href||""}function tg(){return"u">typeof self&&self.location?.protocol||null}class ty{constructor(e,t){var r;this.shortDelay=e,this.longDelay=t,r="Short delay should be less than long delay!",t>e||tp(r),this.isMobile="u">typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(q())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){let e;return!("u">typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===tg()||"https:"===tg()||"object"==typeof(e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==e.id||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function tv(e,t){var r,n;r=e.emulator,n="Emulator should always be set here",r||tp(n);let{url:i}=e.emulator;return t?`${i}${t.startsWith("/")?t.slice(1):t}`:i}class tw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"u">typeof self&&"fetch"in self?self.fetch:"u">typeof globalThis&&globalThis.fetch?globalThis.fetch:"u">typeof fetch?fetch:void tp("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"u">typeof self&&"Headers"in self?self.Headers:"u">typeof globalThis&&globalThis.Headers?globalThis.Headers:"u">typeof Headers?Headers:void tp("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"u">typeof self&&"Response"in self?self.Response:"u">typeof globalThis&&globalThis.Response?globalThis.Response:"u">typeof Response?Response:void tp("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let tb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},t_=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],tI=new ty(3e4,6e4);function tE(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function tT(e,t,r,n,i={}){return tS(e,i,async()=>{let i={},s={};n&&("GET"===t?s=n:i={body:JSON.stringify(n)});let a=Z({key:e.config.apiKey,...s}).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);let l={method:t,headers:o,...i};return"u">typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&F(e.emulatorConfig.host)&&(l.credentials="include"),tw.fetch()(await tk(e,e.config.apiHost,r,a),l)})}async function tS(e,t,r){e._canInitEmulator=!1;let n={...tb,...t};try{let t=new tx(e),i=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();let s=await i.json();if("needConfirmation"in s)throw tA(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{let[t,r]=(i.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw tA(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw tA(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw tA(e,"user-disabled",s);let a=n[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(r)throw tc(e,a,r);tl(e,a)}}catch(t){if(t instanceof W)throw t;tl(e,"network-request-failed",{message:String(t)})}}async function tC(e,t,r,n,i={}){let s=await tT(e,t,r,n,i);return"mfaPendingCredential"in s&&tl(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function tk(e,t,r,n){let i=`${t}${r}?${n}`,s=e.config.emulator?tv(e.config,i):`${e.config.apiScheme}://${i}`;return t_.includes(r)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(s).toString():s}class tx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(tu(this.auth,"network-request-failed")),tI.get())})}}function tA(e,t,r){let n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=tu(e,t,n);return i.customData._tokenResponse=r,i}function tN(e){return void 0!==e&&void 0!==e.enterprise}class tD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)switch(t.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function tR(e,t){return tT(e,"GET","/v2/recaptchaConfig",tE(e,t))}async function tO(e,t){return tT(e,"POST","/v1/accounts:delete",t)}async function tP(e,t){return tT(e,"POST","/v1/accounts:lookup",t)}function tL(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function tM(e,t=!1){let r=ei(e),n=await r.getIdToken(t),i=tV(n);tf(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s="object"==typeof i.firebase?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:n,authTime:tL(tF(i.auth_time)),issuedAtTime:tL(tF(i.iat)),expirationTime:tL(tF(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function tF(e){return 1e3*Number(e)}function tV(e){let[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return to("JWT malformed, contained fewer than 3 sections"),null;try{let e=N(r);if(!e)return to("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return to("Caught error parsing JWT payload as JSON",e?.toString()),null}}function tU(e){let t=tV(e);return tf(t,"internal-error"),tf(void 0!==t.exp,"internal-error"),tf(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function tB(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof W&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class tj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(!e)return this.errorBackoff=3e4,Math.max(0,(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class tq{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tL(this.lastLoginAt),this.creationTime=tL(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tz(e){var t,r;let n=e.auth,i=await e.getIdToken(),s=await tB(e,tP(n,{idToken:i}));tf(s?.users.length,n,"internal-error");let a=s.users[0];e._notifyReloadListener(a);let o=a.providerUserInfo?.length?tG(a.providerUserInfo):[],l=(t=e.providerData,r=o,[...t.filter(e=>!r.some(t=>t.providerId===e.providerId)),...r]),u=e.isAnonymous,c=!(e.email&&a.passwordHash)&&!l?.length;Object.assign(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new tq(a.createdAt,a.lastLoginAt),isAnonymous:!!u&&c})}async function t$(e){let t=ei(e);await tz(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function tG(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function tK(e,t){let r=await tS(e,{},async()=>{let r=Z({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:i}=e.config,s=await tk(e,n,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let o={method:"POST",headers:a,body:r};return e.emulatorConfig&&F(e.emulatorConfig.host)&&(o.credentials="include"),tw.fetch()(s,o)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function tH(e,t){return tT(e,"POST","/v2/accounts:revokeToken",tE(e,t))}class tW{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tf(e.idToken,"internal-error"),tf(void 0!==e.idToken,"internal-error"),tf(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):tU(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){tf(0!==e.length,"internal-error");let t=tU(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(tf(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:n,expiresIn:i}=await tK(e,t);this.updateTokensAndExpiration(r,n,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){let{refreshToken:r,accessToken:n,expirationTime:i}=t,s=new tW;return r&&(tf("string"==typeof r,"internal-error",{appName:e}),s.refreshToken=r),n&&(tf("string"==typeof n,"internal-error",{appName:e}),s.accessToken=n),i&&(tf("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tW,this.toJSON())}_performRefresh(){return tp("not implemented")}}function tQ(e,t){tf("string"==typeof e||void 0===e,"internal-error",{appName:t})}class tJ{constructor({uid:e,auth:t,stsTokenManager:r,...n}){this.providerId="firebase",this.proactiveRefresh=new tj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=n.displayName||null,this.email=n.email||null,this.emailVerified=n.emailVerified||!1,this.phoneNumber=n.phoneNumber||null,this.photoURL=n.photoURL||null,this.isAnonymous=n.isAnonymous||!1,this.tenantId=n.tenantId||null,this.providerData=n.providerData?[...n.providerData]:[],this.metadata=new tq(n.createdAt||void 0,n.lastLoginAt||void 0)}async getIdToken(e){let t=await tB(this,this.stsTokenManager.getToken(this.auth,e));return tf(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return tM(this,e)}reload(){return t$(this)}_assign(e){this!==e&&(tf(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new tJ({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){tf(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await tz(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ez(this.auth.app))return Promise.reject(th(this.auth));let e=await this.getIdToken();return await tB(this,tO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,n=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,o=t._redirectEventId??void 0,l=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:c,emailVerified:h,isAnonymous:d,providerData:f,stsTokenManager:p}=t;tf(c&&p,e,"internal-error");let m=tW.fromJSON(this.name,p);tf("string"==typeof c,e,"internal-error"),tQ(r,e.name),tQ(n,e.name),tf("boolean"==typeof h,e,"internal-error"),tf("boolean"==typeof d,e,"internal-error"),tQ(i,e.name),tQ(s,e.name),tQ(a,e.name),tQ(o,e.name),tQ(l,e.name),tQ(u,e.name);let g=new tJ({uid:c,auth:e,email:n,emailVerified:h,displayName:r,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:a,stsTokenManager:m,createdAt:l,lastLoginAt:u});return f&&Array.isArray(f)&&(g.providerData=f.map(e=>({...e}))),o&&(g._redirectEventId=o),g}static async _fromIdTokenResponse(e,t,r=!1){let n=new tW;n.updateFromServerResponse(t);let i=new tJ({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await tz(i),i}static async _fromGetAccountInfoResponse(e,t,r){let n=t.users[0];tf(void 0!==n.localId,"internal-error");let i=void 0!==n.providerUserInfo?tG(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!i?.length,a=new tW;a.updateFromIdToken(r);let o=new tJ({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:s});return Object.assign(o,{uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:i,metadata:new tq(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!i?.length}),o}}let tY=new Map;function tX(e){var t,r;t="Expected a class definition",e instanceof Function||tp(t);let n=tY.get(e);return n?(r="Instance stored in cache mismatched with class",n instanceof e||tp(r)):(n=new e,tY.set(e,n)),n}class tZ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}function t0(e,t,r){return`firebase:${e}:${t}:${r}`}tZ.type="NONE";class t1{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:n,name:i}=this.auth;this.fullUserKey=t0(this.userKey,n.apiKey,i),this.fullPersistenceKey=t0("persistence",n.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await tP(this.auth,{idToken:e}).catch(()=>void 0);return t?tJ._fromGetAccountInfoResponse(this.auth,t,e):null}return tJ._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new t1(tX(tZ),e,r);let n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=n[0]||tX(tZ),s=t0(r,e.config.apiKey,e.name),a=null;for(let r of t)try{let t=await r._get(s);if(t){let n;if("string"==typeof t){let r=await tP(e,{idToken:t}).catch(()=>void 0);if(!r)break;n=await tJ._fromGetAccountInfoResponse(e,r,t)}else n=tJ._fromJSON(e,t);r!==i&&(a=n),i=r;break}}catch{}let o=n.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length&&(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch{}}))),new t1(i,e,r)}}function t2(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(t5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(t6(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(t7(t))return"Blackberry";if(t9(t))return"Webos";if(t3(t))return"Safari";if((t.includes("chrome/")||t4(t))&&!t.includes("edge/"))return"Chrome";if(t8(t))return"Android";let r=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(r?.length===2)return r[1]}return"Other"}function t6(e=q()){return/firefox\//i.test(e)}function t3(e=q()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function t4(e=q()){return/crios\//i.test(e)}function t5(e=q()){return/iemobile/i.test(e)}function t8(e=q()){return/android/i.test(e)}function t7(e=q()){return/blackberry/i.test(e)}function t9(e=q()){return/webos/i.test(e)}function re(e=q()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function rt(e=q()){return re(e)||t8(e)||t9(e)||t7(e)||/windows phone/i.test(e)||t5(e)}function rr(e,t=[]){let r;switch(e){case"Browser":r=t2(q());break;case"Worker":r=`${t2(q())}-${e}`;break;default:r=e}let n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${eQ}/${n}`}class rn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=t=>new Promise((r,n)=>{try{let n=e(t);r(n)}catch(e){n(e)}});r.onAbort=t,this.queue.push(r);let n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}async function ri(e,t={}){return tT(e,"GET","/v2/passwordPolicy",tE(e,t))}class rs{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class ra{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ro(this),this.idTokenSubscription=new ro(this),this.beforeStateQueue=new rn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ts,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=tX(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted){if(this.persistenceManager=await t1.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await tP(this,{idToken:e}),r=await tJ._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ez(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,n=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let t=this.redirectUser?._redirectEventId,i=r?._redirectEventId,s=await this.tryRedirectSignIn(e);(!t||t===i)&&s?.user&&(r=s.user,n=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(n)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(tf(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tz(e)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("u"<typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ez(this.app))return Promise.reject(th(this));let t=e?ei(e):null;return t&&tf(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&tf(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ez(this.app)?Promise.reject(th(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ez(this.app)?Promise.reject(th(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(tX(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new rs(await ri(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Q("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await tH(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&tX(e)||this._popupRedirectResolver;tf(t,this,"argument-error"),this.redirectPersistenceManager=await t1.create(this,[tX(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e)?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(tf(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"==typeof t){let i=e.addObserver(t,r,n);return()=>{s=!0,i()}}{let r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tf(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=rr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ez(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&function(e,...t){ta.logLevel<=a.WARN&&ta.warn(`Auth (${eQ}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}class ro{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){let r=new er(e,void 0);return r.subscribe.bind(r)}(e=>this.observer=e)}get next(){return tf(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let rl={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ru(e){return`__${e}${Math.floor(1e6*Math.random())}`}class rc{constructor(){this.enterprise=new rh}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rh{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}let rd="NO_RECAPTCHA";class rf{constructor(e){this.type="recaptcha-enterprise",this.auth=ei(e)}async verify(e="verify",t=!1){async function r(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{tR(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0===n.recaptchaKey)r(Error("recaptcha Enterprise site key undefined"));else{let r=new tD(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}}).catch(e=>{r(e)})})}function n(t,r,n){let i=window.grecaptcha;tN(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(rd)})}):n(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new rc().execute("siteKey",{action:"verify"}):new Promise((e,i)=>{r(this.auth).then(r=>{if(!t&&tN(window.grecaptcha))n(r,e,i);else{var s;if("u"<typeof window)return void i(Error("RecaptchaVerifier is only supported in browser"));let t=rl.recaptchaEnterpriseScript;0!==t.length&&(t+=r),(s=t,rl.loadJS(s)).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function rp(e,t,r,n=!1,i=!1){let s,a=new rf(e);if(i)s=rd;else try{s=await a.verify(r)}catch(e){s=await a.verify(r,!0)}let o={...t};if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in o){let e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){let e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function rm(e,t,r,n,i){if("EMAIL_PASSWORD_PROVIDER"===i)if(!e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return n(e,t).catch(async i=>{if("auth/missing-recaptcha-token"!==i.code)return Promise.reject(i);{console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let i=await rp(e,t,r,"getOobCode"===r);return n(e,i)}});else{let i=await rp(e,t,r,"getOobCode"===r);return n(e,i)}if("PHONE_PROVIDER"!==i)return Promise.reject(i+" provider is not supported.");if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let i=await rp(e,t,r);return n(e,i).catch(async i=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);let i=await rp(e,t,r,!1,!0);return n(e,i)}return Promise.reject(i)})}{let i=await rp(e,t,r,!1,!0);return n(e,i)}}async function rg(e){let t=ei(e),r=new tD(await tR(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}));null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new rf(t).verify()}function ry(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function rv(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}class rw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return tp("not implemented")}_getIdTokenResponse(e){return tp("not implemented")}_linkToIdToken(e,t){return tp("not implemented")}_getReauthenticationResolver(e){return tp("not implemented")}}async function rb(e,t){return tT(e,"POST","/v1/accounts:signUp",t)}async function r_(e,t){return tC(e,"POST","/v1/accounts:signInWithPassword",tE(e,t))}async function rI(e,t){return tT(e,"POST","/v1/accounts:sendOobCode",tE(e,t))}async function rE(e,t){return rI(e,t)}async function rT(e,t){return tC(e,"POST","/v1/accounts:signInWithEmailLink",tE(e,t))}async function rS(e,t){return tC(e,"POST","/v1/accounts:signInWithEmailLink",tE(e,t))}class rC extends rw{constructor(e,t,r,n=null){super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new rC(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new rC(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return rm(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",r_,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return rT(e,{email:this._email,oobCode:this._password});default:tl(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return rm(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rb,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return rS(e,{idToken:t,email:this._email,oobCode:this._password});default:tl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rk(e,t){return tC(e,"POST","/v1/accounts:signInWithIdp",tE(e,t))}class rx extends rw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new rx(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):tl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let{providerId:t,signInMethod:r,...n}="string"==typeof e?JSON.parse(e):e;if(!t||!r)return null;let i=new rx(t,r);return i.idToken=n.idToken||void 0,i.accessToken=n.accessToken||void 0,i.secret=n.secret,i.nonce=n.nonce,i.pendingToken=n.pendingToken||null,i}_getIdTokenResponse(e){return rk(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,rk(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,rk(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Z(t)}return e}}async function rA(e,t){return tT(e,"POST","/v1/accounts:sendVerificationCode",tE(e,t))}async function rN(e,t){return tC(e,"POST","/v1/accounts:signInWithPhoneNumber",tE(e,t))}async function rD(e,t){let r=await tC(e,"POST","/v1/accounts:signInWithPhoneNumber",tE(e,t));if(r.temporaryProof)throw tA(e,"account-exists-with-different-credential",r);return r}let rR={USER_NOT_FOUND:"user-not-found"};async function rO(e,t){return tC(e,"POST","/v1/accounts:signInWithPhoneNumber",tE(e,{...t,operation:"REAUTH"}),rR)}class rP extends rw{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new rP({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new rP({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return rN(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return rD(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return rO(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}=e;return r||t||n||i?new rP({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}):null}}class rL{constructor(e){const t=ee(et(e)),r=t.apiKey??null,n=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);tf(r&&n&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=n,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t,r,n,i=(r=(t=ee(et(e)).link)?ee(et(t)).deep_link_id:null,((n=ee(et(e)).deep_link_id)?ee(et(n)).link:null)||n||r||t||e);try{return new rL(i)}catch{return null}}}class rM{constructor(){this.providerId=rM.PROVIDER_ID}static credential(e,t){return rC._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=rL.parseLink(t);return tf(r,"argument-error"),rC._fromEmailAndCode(e,r.code,r.tenantId)}}rM.PROVIDER_ID="password",rM.EMAIL_PASSWORD_SIGN_IN_METHOD="password",rM.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class rF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class rV extends rF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class rU extends rV{constructor(){super("facebook.com")}static credential(e){return rx._fromParams({providerId:rU.PROVIDER_ID,signInMethod:rU.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rU.credentialFromTaggedObject(e)}static credentialFromError(e){return rU.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rU.credential(e.oauthAccessToken)}catch{return null}}}rU.FACEBOOK_SIGN_IN_METHOD="facebook.com",rU.PROVIDER_ID="facebook.com";class rB extends rV{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return rx._fromParams({providerId:rB.PROVIDER_ID,signInMethod:rB.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rB.credentialFromTaggedObject(e)}static credentialFromError(e){return rB.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return rB.credential(t,r)}catch{return null}}}rB.GOOGLE_SIGN_IN_METHOD="google.com",rB.PROVIDER_ID="google.com";class rj extends rV{constructor(){super("github.com")}static credential(e){return rx._fromParams({providerId:rj.PROVIDER_ID,signInMethod:rj.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rj.credentialFromTaggedObject(e)}static credentialFromError(e){return rj.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rj.credential(e.oauthAccessToken)}catch{return null}}}rj.GITHUB_SIGN_IN_METHOD="github.com",rj.PROVIDER_ID="github.com";class rq extends rV{constructor(){super("twitter.com")}static credential(e,t){return rx._fromParams({providerId:rq.PROVIDER_ID,signInMethod:rq.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rq.credentialFromTaggedObject(e)}static credentialFromError(e){return rq.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return rq.credential(t,r)}catch{return null}}}async function rz(e,t){return tC(e,"POST","/v1/accounts:signUp",tE(e,t))}rq.TWITTER_SIGN_IN_METHOD="twitter.com",rq.PROVIDER_ID="twitter.com";class r${constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,n=!1){return new r$({user:await tJ._fromIdTokenResponse(e,r,n),providerId:rG(r),_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){return await e._updateTokensIfNecessary(r,!0),new r$({user:e,providerId:rG(r),_tokenResponse:r,operationType:t})}}function rG(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class rK extends W{constructor(e,t,r,n){super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,rK.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new rK(e,t,r,n)}}function rH(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if("auth/multi-factor-auth-required"===r.code)throw rK._fromErrorAndOperation(e,r,t,n);throw r})}async function rW(e,t,r=!1){let n=await tB(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return r$._forOperation(e,"link",n)}async function rQ(e,t,r=!1){let{auth:n}=e;if(ez(n.app))return Promise.reject(th(n));let i="reauthenticate";try{let s=await tB(e,rH(n,i,t,e),r);tf(s.idToken,n,"internal-error");let a=tV(s.idToken);tf(a,n,"internal-error");let{sub:o}=a;return tf(e.uid===o,n,"user-mismatch"),r$._forOperation(e,i,s)}catch(e){throw e?.code==="auth/user-not-found"&&tl(n,"user-mismatch"),e}}async function rJ(e,t,r=!1){if(ez(e.app))return Promise.reject(th(e));let n="signIn",i=await rH(e,n,t),s=await r$._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function rY(e,t){return rJ(ei(e),t)}class rX{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?rZ._fromServerResponse(e,t):"totpInfo"in t?r0._fromServerResponse(e,t):tl(e,"internal-error")}}class rZ extends rX{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new rZ(t)}}class r0 extends rX{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new r0(t)}}async function r1(e){let t=ei(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function r2(e,t,r){let n=ei(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};r&&(tf(r.url?.length>0,n,"invalid-continue-uri"),tf(void 0===r.dynamicLinkDomain||r.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),tf(void 0===r.linkDomain||r.linkDomain.length>0,n,"invalid-hosting-link-domain"),i.continueUrl=r.url,i.dynamicLinkDomain=r.dynamicLinkDomain,i.linkDomain=r.linkDomain,i.canHandleCodeInApp=r.handleCodeInApp,r.iOS&&(tf(r.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),i.iOSBundleId=r.iOS.bundleId),r.android&&(tf(r.android.packageName.length>0,n,"missing-android-pkg-name"),i.androidInstallApp=r.android.installApp,i.androidMinimumVersionCode=r.android.minimumVersion,i.androidPackageName=r.android.packageName)),await rm(n,i,"getOobCode",rE,"EMAIL_PASSWORD_PROVIDER")}async function r6(e,t,r){if(ez(e.app))return Promise.reject(th(e));let n=ei(e),i=rm(n,{returnSecureToken:!0,email:t,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rz,"EMAIL_PASSWORD_PROVIDER"),s=await i.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&r1(e),t}),a=await r$._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(a.user),a}async function r3(e,t){return tT(e,"POST","/v1/accounts:update",t)}async function r4(e,{displayName:t,photoURL:r}){if(void 0===t&&void 0===r)return;let n=ei(e),i=await n.getIdToken(),s=await tB(n,r3(n.auth,{idToken:i,displayName:t,photoUrl:r,returnSecureToken:!0}));n.displayName=s.displayName||null,n.photoURL=s.photoUrl||null;let a=n.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),await n._updateTokensIfNecessary(s)}function r5(e,t){return tT(e,"POST","/v2/accounts/mfaEnrollment:start",tE(e,t))}new WeakMap;let r8="__sak";class r7{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(r8,"1"),this.storage.removeItem(r8),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class r9 extends r7{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rt(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),n=this.localCache[t];r!==n&&e(t,n,r)}}onStorageEvent(e,t=!1){let r;if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});let n=e.key;t?this.detachListener():this.stopPolling();let i=()=>{let e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);((r=q()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}r9.type="LOCAL";class ne extends r7{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ne.type="SESSION";class nt{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let r=new nt(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:r,data:n}=e.data,i=this.handlersMap[r];if(!i?.size)return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:r});let s=Array.from(i).map(async t=>t(e.origin,n)),a=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function nr(e="",t=10){let r="";for(let e=0;e<t;e++)r+=Math.floor(10*Math.random());return e+r}nt.receivers=[];class nn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let n,i,s="u">typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((a,o)=>{let l=nr("",20);s.port1.start();let u=setTimeout(()=>{o(Error("unsupported_event"))},r);i={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(u),n=setTimeout(()=>{o(Error("timeout"))},3e3);break;case"done":clearTimeout(n),a(e.data.response);break;default:clearTimeout(u),clearTimeout(n),o(Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function ni(){return window}function ns(){return void 0!==ni().WorkerGlobalScope&&"function"==typeof ni().importScripts}async function na(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}let no="firebaseLocalStorageDb",nl="firebaseLocalStorage",nu="fbase_key";class nc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nh(e,t){return e.transaction([nl],t?"readwrite":"readonly").objectStore(nl)}function nd(){let e=indexedDB.open(no,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(nl,{keyPath:nu})}catch(e){r(e)}}),e.addEventListener("success",async()=>{let r=e.result;r.objectStoreNames.contains(nl)?t(r):(r.close(),await new nc(indexedDB.deleteDatabase(no)).toPromise(),t(await nd()))})})}async function nf(e,t,r){return new nc(nh(e,!0).put({[nu]:t,value:r})).toPromise()}async function np(e,t){let r=nh(e,!1).get(t),n=await new nc(r).toPromise();return void 0===n?null:n.value}function nm(e,t){return new nc(nh(e,!0).delete(t)).toPromise()}class ng{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await nd()),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ns()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nt._getInstance(ns()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await na(),!this.activeServiceWorker)return;this.sender=new nn(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await nd();return await nf(e,r8,"1"),await nm(e,r8),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>nf(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>np(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>nm(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new nc(nh(e,!1).getAll()).toPromise());if(!e||0!==this.pendingWrites)return[];let t=[],r=new Set;if(0!==e.length)for(let{fbase_key:n,value:i}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(i)&&(this.notifyListeners(n,i),t.push(n));for(let e of Object.keys(this.localCache))this.localCache[e]&&!r.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}function ny(e,t){return tT(e,"POST","/v2/accounts/mfaSignIn:start",tE(e,t))}ng.type="LOCAL",ru("rcb"),new ty(3e4,6e4);let nv="recaptcha";async function nw(e,t,r){if(!e._getRecaptchaConfig())try{await rg(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let n;if(n="string"==typeof t?{phoneNumber:t}:t,"session"in n){let t=n.session;if("phoneNumber"in n){tf("enroll"===t.type,e,"internal-error");let i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===rd){tf(r?.type===nv,e,"argument-error");let n=await nb(e,t,r);return r5(e,n)}return r5(e,t)},a=rm(e,i,"mfaSmsEnrollment",s,"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{tf("signin"===t.type,e,"internal-error");let i=n.multiFactorHint?.uid||n.multiFactorUid;tf(i,e,"missing-multi-factor-info");let s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===rd){tf(r?.type===nv,e,"argument-error");let n=await nb(e,t,r);return ny(e,n)}return ny(e,t)},o=rm(e,s,"mfaSmsSignIn",a,"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{let t={phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=async(e,t)=>{if(t.captchaResponse===rd){tf(r?.type===nv,e,"argument-error");let n=await nb(e,t,r);return rA(e,n)}return rA(e,t)},s=rm(e,t,"sendVerificationCode",i,"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).sessionInfo}}finally{r?._reset()}}async function nb(e,t,r){tf(r.type===nv,e,"argument-error");let n=await r.verify();tf("string"==typeof n,e,"argument-error");let i={...t};if("phoneEnrollmentInfo"in i){let e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,r=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:n,captchaResponse:t,clientType:r,recaptchaVersion:s}}),i}if(!("phoneSignInInfo"in i))return Object.assign(i,{recaptchaToken:n}),i;{let e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,r=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:e,clientType:t,recaptchaVersion:r}}),i}}class n_{constructor(e){this.providerId=n_.PROVIDER_ID,this.auth=ei(e)}verifyPhoneNumber(e,t){return nw(this.auth,e,ei(t))}static credential(e,t){return rP._fromVerification(e,t)}static credentialFromResult(e){return n_.credentialFromTaggedObject(e)}static credentialFromError(e){return n_.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?rP._fromTokenResponse(t,r):null}}n_.PROVIDER_ID="phone",n_.PHONE_SIGN_IN_METHOD="phone";class nI extends rw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rk(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rk(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rk(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function nE(e){return rJ(e.auth,new nI(e),e.bypassAuthState)}function nT(e){let{auth:t,user:r}=e;return tf(r,t,"internal-error"),rQ(r,new nI(e),e.bypassAuthState)}async function nS(e){let{auth:t,user:r}=e;return tf(r,t,"internal-error"),rW(r,new nI(e),e.bypassAuthState)}class nC{constructor(e,t,r,n,i=!1){this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:n,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);let o={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nE;case"linkViaPopup":case"linkViaRedirect":return nS;case"reauthViaPopup":case"reauthViaRedirect":return nT;default:tl(this.auth,"internal-error")}}resolve(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||tp(r),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||tp(r),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}let nk=new ty(2e3,1e4);class nx extends nC{constructor(e,t,r,n,i){super(e,t,n,i),this.provider=r,this.authWindow=null,this.pollId=null,nx.currentPopupAction&&nx.currentPopupAction.cancel(),nx.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return tf(e,this.auth,"internal-error"),e}async onExecution(){var e,t;e=1===this.filter.length,t="Popup operations only handle one event",e||tp(t);let r=nr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],r),this.authWindow.associatedEvent=r,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(tu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(tu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nx.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nk.get())};e()}}nx.currentPopupAction=null;let nA=new Map;class nN extends nC{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=nA.get(this.auth._key());if(!e){try{let t=await nD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}nA.set(this.auth._key(),e)}return this.bypassAuthState||nA.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)return void this.resolve(null);if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nD(e,t){var r;let n=t0("pendingRedirect",(r=t).config.apiKey,r.name),i=tX(e._redirectPersistence);if(!await i._isAvailable())return!1;let s=await i._get(n)==="true";return await i._remove(n),s}function nR(e,t){nA.set(e._key(),t)}async function nO(e,t,r=!1){if(ez(e.app))return Promise.reject(th(e));let n=ei(e),i=t?tX(t):(tf(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver),s=new nN(n,i,r),a=await s.execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}class nP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nM(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!nM(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(tu(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(nL(e))}saveEventToCache(e){this.cachedEventUids.add(nL(e)),this.lastProcessedEventTime=Date.now()}}function nL(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function nM({type:e,error:t}){return"unknown"===e&&t?.code==="auth/no-auth-event"}async function nF(e,t={}){return tT(e,"GET","/v1/projects",t)}let nV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nU=/^https?/;async function nB(e){if(e.config.emulator)return;let{authorizedDomains:t}=await nF(e);for(let e of t)try{if(function(e){let t=tm(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){let i=new URL(e);return""===i.hostname&&""===n?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===n}if(!nU.test(r))return!1;if(nV.test(e))return n===e;let i=e.replace(/\./g,"\\.");return RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}(e))return}catch{}tl(e,"unauthorized-domain")}let nj=new ty(3e4,6e4);function nq(){let e=ni().___jsl;if(e?.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}let nz=null,n$=new ty(5e3,15e3),nG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function nH(e){let t,r,n,i,s,a=await (nz=nz||new Promise((t,r)=>{function n(){nq(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{nq(),r(tu(e,"network-request-failed"))},timeout:nj.get()})}if(ni().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(ni().gapi?.load)n();else{var i;let t=ru("iframefcb");return ni()[t]=()=>{gapi.load?n():r(tu(e,"network-request-failed"))},(i=`${rl.gapiScript}?onload=${t}`,rl.loadJS(i)).catch(e=>r(e))}}).catch(e=>{throw nz=null,e})),o=ni().gapi;return tf(o,e,"internal-error"),a.open({where:document.body,url:(tf((t=e.config).authDomain,e,"auth-domain-config-required"),r=t.emulator?tv(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,n={apiKey:t.apiKey,appName:e.name,v:eQ},(i=nK.get(e.config.apiHost))&&(n.eid=i),(s=e._getFrameworks()).length&&(n.fw=s.join(",")),`${r}?${Z(n).slice(1)}`),messageHandlersFilter:o.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nG,dontclear:!0},t=>new Promise(async(r,n)=>{await t.restyle({setHideOnLeave:!1});let i=tu(e,"network-request-failed"),s=ni().setTimeout(()=>{n(i)},n$.get());function a(){ni().clearTimeout(s),r(t)}t.ping(a).then(a,()=>{n(i)})}))}let nW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class nQ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let nJ=encodeURIComponent("fac");async function nY(e,t,r,n,i,s){tf(e.config.authDomain,e,"auth-domain-config-required"),tf(e.config.apiKey,e,"invalid-api-key");let a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:eQ,eventId:i};if(t instanceof rF)for(let[r,n]of(t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",!function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())&&(a.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(s||{})))a[r]=n;if(t instanceof rV){let e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}for(let t of(e.tenantId&&(a.tid=e.tenantId),Object.keys(a)))void 0===a[t]&&delete a[t];let o=await e._getAppCheckToken(),l=o?`#${nJ}=${encodeURIComponent(o)}`:"";return`${function({config:e}){return e.emulator?tv(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${Z(a).slice(1)}${l}`}let nX="webStorageSupport",nZ=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ne,this._completeRedirectFn=nO,this._overrideRedirectResult=nR}async _openPopup(e,t,r,n){var i,s;i=this.eventManagers[e._key()]?.manager,s="_initialize() not called before _openPopup()",i||tp(s);let a=await nY(e,t,r,tm(),n);return function(e,t,r,n=500,i=600){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString(),o="",l={...nW,width:n.toString(),height:i.toString(),top:s,left:a},u=q().toLowerCase();r&&(o=t4(u)?"_blank":r),t6(u)&&(t=t||"http://localhost",l.scrollbars="yes");let c=Object.entries(l).reduce((e,[t,r])=>`${e}${t}=${r},`,"");if(function(e=q()){return re(e)&&!!window.navigator?.standalone}(u)&&"_self"!==o){var h,d;let e,r;return h=t||"",d=o,(e=document.createElement("a")).href=h,e.target=d,(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r),new nQ(null)}let f=window.open(t||"",o,c);tf(f,e,"popup-blocked");try{f.focus()}catch(e){}return new nQ(f)}(e,a,nr())}async _openRedirect(e,t,r,n){var i;return await this._originValidation(e),i=await nY(e,t,r,tm(),n),ni().location.href=i,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){var r;let{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(r="If manager is not set, promise should be",n||tp(r),n)}let n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){let t=await nH(e),r=new nP(e);return t.register("authEvent",t=>(tf(t?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(nX,{type:nX},r=>{let n=r?.[0]?.[nX];void 0!==n&&t(!!n),tl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=nB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rt()||t3()||re()}};var n0="@firebase/auth",n1="1.12.0";class n2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){tf(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let n6=L("authIdTokenMaxAge")||300,n3=null;rl={loadJS:e=>new Promise((t,r)=>{let n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=e=>{let t=tu("internal-error");t.customData=e,r(t)},n.type="text/javascript",n.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(n)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},s="Browser",eV(new es("auth",(e,{options:t})=>{let r,n,i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=i.options;tf(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});let c=new ra(i,a,o,{apiKey:l,authDomain:u,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rr(s)});return n=(Array.isArray(r=t?.persistence||[])?r:[r]).map(tX),t?.errorMap&&c._updateErrorMap(t.errorMap),c._initializeWithPersistence(n,t?.popupRedirectResolver),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),eV(new es("auth-internal",e=>new n2(ei(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),e1(n0,n1,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(s)),e1(n0,n1,"esm2020"),e.s([],58556),e.i(58556);var n4=e.i(67034),n5="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,n8={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var t=function(){this.blockSize=-1};function r(){}function n(e,t,r){r||(r=0);let n=Array(16);if("string"==typeof t)for(var i=0;i<16;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;i<16;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];let s=e.g[3],a;a=t+(s^r&(i^s))+n[0]+0xd76aa478|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[1]+0xe8c7b756|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[2]+0x242070db|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[3]+0xc1bdceee|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[4]+0xf57c0faf|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[5]+0x4787c62a|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[6]+0xa8304613|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[7]+0xfd469501|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[8]+0x698098d8|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[9]+0x8b44f7af|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[10]+0xffff5bb1|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[11]+0x895cd7be|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[12]+0x6b901122|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[13]+0xfd987193|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[14]+0xa679438e|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[15]+0x49b40821|0,r=i+(a<<22|a>>>10),a=t+(i^s&(r^i))+n[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[11]+0x265e5a51|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[0]+0xe9b6c7aa|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[15]+0xd8a1e681|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[4]+0xe7d3fbc8|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[3]+0xf4d50d87|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[8]+0x455a14ed|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[7]+0x676f02d9|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[12]+0x8d2a4c8a|0,a=t+((r=i+(a<<20|a>>>12))^i^s)+n[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[8]+0x8771f681|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[11]+0x6d9d6122|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[14]+0xfde5380c|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[4]+0x4bdecfa9|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[7]+0xf6bb4b60|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[10]+0xbebfbc70|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[0]+0xeaa127fa|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[3]+0xd4ef3085|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[6]+0x4881d05|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[12]+0xe6db99e5|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[15]+0x1fa27cf8|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[2]+0xc4ac5665|0,r=i+(a<<23|a>>>9),a=t+(i^(r|~s))+n[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[14]+0xab9423a7|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[5]+0xfc93a039|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[10]+0xffeff47d|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[1]+0x85845dd1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[6]+0xa3014314|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[13]+0x4e0811a1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[2]+0x2ad7d2bb|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(i+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+i|0,e.g[3]=e.g[3]+s|0}function i(e,t){this.h=t;let r=[],n=!0;for(let i=e.length-1;i>=0;i--){let s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}r.prototype=t.prototype,e.F=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.D=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)},e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,t){void 0===t&&(t=e.length);let r=t-this.blockSize,i=this.C,s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let n=0;n<32;n+=8)e[t++]=this.g[r]>>>n&255;return e};var s,a={};function u(e){var t;return -128<=e&&e<128?(t=function(e){return new i([0|e],e<0?-1:0)},Object.prototype.hasOwnProperty.call(a,e)?a[e]:a[e]=t(e)):new i([0|e],e<0?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return h;if(e<0)return g(c(-e));let t=[],r=1;for(let n=0;e>=r;n++)t[n]=e/r|0,r*=0x100000000;return new i(t,0)}var h=u(0),d=u(1),f=u(0x1000000);function p(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function m(e){return -1==e.h}function g(e){let t=e.g.length,r=[];for(let n=0;n<t;n++)r[n]=~e.g[n];return new i(r,~e.h).add(d)}function y(e,t){return e.add(g(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function w(e,t){this.g=e,this.h=t}function b(e,t){if(p(t))throw Error("division by zero");if(p(e))return new w(h,h);if(m(e))return t=b(g(e),t),new w(g(t.g),g(t.h));if(m(t))return t=b(e,g(t)),new w(g(t.g),t.h);if(e.g.length>30){if(m(e)||m(t))throw Error("slowDivide_ only works with positive integers.");for(var r=d,n=t;0>=n.l(e);)r=_(r),n=_(n);var i=I(r,1),s=I(n,1);for(n=I(n,2),r=I(r,2);!p(n);){var a=s.add(n);0>=a.l(e)&&(i=i.add(r),s=a),n=I(n,1),r=I(r,1)}return t=y(e,i.j(t)),new w(i,t)}for(i=h;e.l(t)>=0;){for(n=(n=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,n-48),a=(s=c(r)).j(t);m(a)||a.l(e)>0;)r-=n,a=(s=c(r)).j(t);p(s)&&(s=d),i=i.add(s),e=y(e,a)}return new w(i,e)}function _(e){let t=e.g.length+1,r=[];for(let n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new i(r,e.h)}function I(e,t){let r=t>>5;t%=32;let n=e.g.length-r,s=[];for(let i=0;i<n;i++)s[i]=t>0?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new i(s,e.h)}(s=i.prototype).m=function(){if(m(this))return-g(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let n=this.i(r);e+=(n>=0?n:0x100000000+n)*t,t*=0x100000000}return e},s.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(m(this))return"-"+g(this).toString(e);let t=c(Math.pow(e,6));var r=this;let n="";for(;;){let i=b(r,t).g,s=(((r=y(r,i.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(p(r=i))return s+n;for(;s.length<6;)s="0"+s;n=s+n}},s.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},s.l=function(e){return m(e=y(this,e))?-1:+!p(e)},s.abs=function(){return m(this)?g(this):this},s.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],n=0;for(let i=0;i<=t;i++){let t=n+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);n=s>>>16,t&=65535,s&=65535,r[i]=s<<16|t}return new i(r,-0x80000000&r[r.length-1]?-1:0)},s.j=function(e){if(p(this)||p(e))return h;if(m(this))return m(e)?g(this).j(g(e)):g(g(this).j(e));if(m(e))return g(this.j(g(e)));if(0>this.l(f)&&0>e.l(f))return c(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(let t=0;t<e.g.length;t++){let i=this.i(n)>>>16,s=65535&this.i(n),a=e.i(t)>>>16,o=65535&e.i(t);r[2*n+2*t]+=s*o,v(r,2*n+2*t),r[2*n+2*t+1]+=i*o,v(r,2*n+2*t+1),r[2*n+2*t+1]+=s*a,v(r,2*n+2*t+1),r[2*n+2*t+2]+=i*a,v(r,2*n+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new i(r,0)},s.B=function(e){return b(this,e).h},s.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new i(r,this.h&e.h)},s.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new i(r,this.h|e.h)},s.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new i(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,l=n8.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return g(e(t.substring(1),r));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');let n=c(Math.pow(r,8)),i=h;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);let a=parseInt(t.substring(e,e+s),r);s<8?(s=c(Math.pow(r,s)),i=i.j(s).add(c(a))):i=(i=i.j(n)).add(c(a))}return i},o=n8.Integer=i}).apply(void 0!==n5?n5:"u">typeof self?self:"u">typeof window?window:{});var n7="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,n9={};(function(){var e,t,r=Object.defineProperty,n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n7&&n7];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function i(e,t){if(t)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&r(i,e,{configurable:!0,writable:!0,value:t})}}i("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(e){return e||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push([t,e[t]]);return r}});var s=s||{},a=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function l(e,t,r){return e.call.apply(e.bind,arguments)}function y(e,t,r){return(y=l).apply(null,arguments)}function v(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function w(e,t){function r(){}r.prototype=t.prototype,e.Z=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Ob=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}var b="u">typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function _(e){let t=e.length;if(t>0){let r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function I(e,t){for(let t=1;t<arguments.length;t++){let n=arguments[t];var r=typeof n;if("array"==(r="object"!=r?r:n?Array.isArray(n)?"array":r:"null")||"object"==r&&"number"==typeof n.length){r=e.length||0;let t=n.length||0;e.length=r+t;for(let i=0;i<t;i++)e[r+i]=n[i]}else e.push(n)}}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new T,e=>e.reset());class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let S,C=!1,k=new class{constructor(){this.h=this.g=null}add(e,t){let r=E.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},x=()=>{let e=Promise.resolve(void 0);S=()=>{e.then(A)}};function A(){let e;for(var t;e=null,k.g&&(e=k.g,k.g=k.g.next,k.g||(k.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(e){!function(e){a.setTimeout(()=>{throw e},0)}(e)}E.j(t),E.h<100&&(E.h++,t.next=E.g,E.g=t)}C=!1}function N(){this.u=this.u,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(e){}return e}();function O(e){return/^[\s\xa0]*$/.test(e)}function P(e,t){D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}w(P,D),P.prototype.init=function(e,t){let r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement)),this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&P.Z.h.call(this)},P.prototype.h=function(){P.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),M=0;function F(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++M,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function U(e,t,r){for(let n in e)t.call(r,e[n],n,e)}function B(e){let t={};for(let r in e)t[r]=e[r];return t}let j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(e,t){let r,n;for(let t=1;t<arguments.length;t++){for(r in n=arguments[t])e[r]=n[r];for(let t=0;t<j.length;t++)r=j[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function z(e){this.src=e,this.g={},this.h=0}function $(e,t){let r=t.type;if(r in e.g){var n,i=e.g[r],s=Array.prototype.indexOf.call(i,t,void 0);(n=s>=0)&&Array.prototype.splice.call(i,s,1),n&&(V(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function G(e,t,r,n){for(let i=0;i<e.length;++i){let s=e[i];if(!s.da&&s.listener==t&&!!r==s.capture&&s.ha==n)return i}return -1}z.prototype.add=function(e,t,r,n,i){let s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);let a=G(e,t,n,i);return a>-1?(t=e[a],r||(t.fa=!1)):((t=new F(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var K="closure_lm_"+(1e6*Math.random()|0),H={};function W(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");let a=o(i)?!!i.capture:!!i,l=X(e);if(l||(e[K]=l=new z(e)),(r=l.add(t,r,n,a,s)).proxy)return r;if(n=function e(t){return Y.call(e.src,e.listener,t)},r.proxy=n,n.src=e,n.listener=r,e.addEventListener)R||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function Q(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[L])$(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(J(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=X(t))?($(r,e),0==r.h&&(r.src=null,t[K]=null)):V(e)}}}function J(e){return e in H?H[e]:H[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new P(t,this);let r=e.listener,n=e.ha||e.src;e.fa&&Q(e),e=r.call(n,t)}return e}function X(e){return(e=e[K])instanceof z?e:null}var Z="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(e){return"function"==typeof e?e:(e[Z]||(e[Z]=function(t){return e.handleEvent(t)}),e[Z])}function et(){N.call(this),this.i=new z(this),this.M=this,this.G=null}function er(e,t){let r,n;var i,s=e.G;if(s)for(i=[];s;s=s.G)i.push(s);if(e=e.M,s=t.type||t,"string"==typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var a=t;q(t=new D(s,e),a)}if(a=!0,i)for(n=i.length-1;n>=0;n--)a=en(r=t.g=i[n],s,!0,t)&&a;if(a=en(r=t.g=e,s,!0,t)&&a,a=en(r,s,!1,t)&&a,i)for(n=0;n<i.length;n++)a=en(r=t.g=i[n],s,!1,t)&&a}function en(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){let a=t[s];if(a&&!a.da&&a.capture==r){let t=a.listener,r=a.ha||a.src;a.fa&&$(e.i,a),i=!1!==t.call(r,n)&&i}}return i&&!n.defaultPrevented}w(et,N),et.prototype[L]=!0,et.prototype.removeEventListener=function(e,t,r,n){!function e(t,r,n,i,s){if(Array.isArray(r))for(var a=0;a<r.length;a++)e(t,r[a],n,i,s);else(i=o(i)?!!i.capture:!!i,n=ee(n),t&&t[L])?(t=t.i,(a=String(r).toString())in t.g&&(n=G(r=t.g[a],n,i,s))>-1&&(V(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[a],t.h--))):t&&(t=X(t))&&(r=t.g[r.toString()],t=-1,r&&(t=G(r,n,i,s)),(n=t>-1?r[t]:null)&&Q(n))}(this,e,t,r,n)},et.prototype.N=function(){if(et.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let r=e.g[t];for(let e=0;e<r.length;e++)V(r[e]);delete e.g[t],e.h--}}this.G=null},et.prototype.J=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},et.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class ei extends N{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=function(e,t){if("function"!=typeof e)if(e&&"function"==typeof e.handleEvent)e=y(e.handleEvent,e);else throw Error("Invalid listener argument");return Number(t)>0x7fffffff?-1:a.setTimeout(e,t||0)}(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);let r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function es(e){N.call(this),this.h=e,this.g={}}w(es,N);var ea=[];function eo(e){U(e.g,function(e,t){this.g.hasOwnProperty(t)&&Q(e)},e),e.g={}}es.prototype.N=function(){es.Z.N.call(this),eo(this)},es.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var el=a.JSON.stringify,eu=a.JSON.parse,ec=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function eh(){}function ed(){}var ef={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ep(){D.call(this,"d")}function em(){D.call(this,"c")}w(ep,D),w(em,D);var eg={},ey=null;function ev(){return ey=ey||new et}function ew(e){D.call(this,eg.Ia,e)}function eb(e){let t=ev();er(t,new ew(t))}function e_(e,t){D.call(this,eg.STAT_EVENT,e),this.stat=t}function eI(e){let t=ev();er(t,new e_(t,e))}function eE(e,t){D.call(this,eg.Ja,e),this.size=t}function eT(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function eS(){this.g=!0}function eC(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{let s=JSON.parse(t);if(s){for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var r=s[e];if(!(r.length<2)){var n=r[1];if(Array.isArray(n)&&!(n.length<1)){var i=n[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<n.length;e++)n[e]=""}}}}return el(s)}catch(e){return t}}(e,r)+(n?" "+n:"")})}eg.Ia="serverreachability",w(ew,D),eg.STAT_EVENT="statevent",w(e_,D),eg.Ja="timingevent",w(eE,D),eS.prototype.ua=function(){this.g=!1},eS.prototype.info=function(){};var ek={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ex={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function eA(){}function eN(e){return encodeURIComponent(String(e))}function eD(e,t,r,n){this.j=e,this.i=t,this.l=r,this.S=n||1,this.V=new es(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new eR}function eR(){this.i=null,this.g="",this.h=!1}w(eA,eh),eA.prototype.g=function(){return new XMLHttpRequest},e=new eA;var eO={},eP={};function eL(e,t,r){e.M=1,e.A=e4(e0(t)),e.u=r,e.R=!0,eM(e,null)}function eM(e,t){e.F=Date.now(),eV(e),e.B=e0(e.A);var r,n,i,s,a,l,u=e.B,c=e.S;Array.isArray(c)||(c=[String(c)]),tu(u.i,"t",c),e.C=0,u=e.j.L,e.h=new eR,e.g=tQ(e.j,u?t:null,!e.u),e.P>0&&(e.O=new ei(y(e.Y,e,e.g),e.P)),t=e.V,u=e.g,c=e.ba;var h="readystatechange";Array.isArray(h)||(h&&(ea[0]=h.toString()),h=ea);for(let e=0;e<h.length;e++){let r=function e(t,r,n,i,s){if(i&&i.once)return function e(t,r,n,i,s){if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=ee(n),t&&t[L]?t.K(r,n,o(i)?!!i.capture:!!i,s):W(t,r,n,!0,i,s)}(t,r,n,i,s);if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=ee(n),t&&t[L]?t.J(r,n,o(i)?!!i.capture:!!i,s):W(t,r,n,!1,i,s)}(u,h[e],c||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}t=e.J?B(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),eb(),r=e.i,n=e.v,i=e.B,s=e.l,a=e.S,l=e.u,r.info(function(){if(r.g)if(l){var e="",t=l.split("&");for(let r=0;r<t.length;r++){var o=t[r].split("=");if(o.length>1){let t=o[0];o=o[1];let r=t.split("_");e=r.length>=2&&"type"==r[1]?e+(t+"=")+o+"&":e+(t+"=redacted&")}}}else e=null;else e=l;return"XMLHTTP REQ ("+s+") [attempt "+a+"]: "+n+"\n"+i+"\n"+e})}function eF(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function eV(e){e.T=Date.now()+e.H,eU(e,e.H)}function eU(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=eT(y(e.aa,e),t)}function eB(e){e.D&&(a.clearTimeout(e.D),e.D=null)}function ej(e){0==e.j.I||e.K||t$(e.j,e)}function eq(e){eB(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,eo(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function ez(e,t){try{var r=e.j;if(0!=r.I&&(r.g==e||eW(r.h,e))){if(!e.L&&eW(r.h,e)&&3==r.I){try{var n=r.Ba.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.v){if(r.g)if(r.g.F+3e3<e.F)tz(r),tO(r);else break e;tB(r),eI(18)}}else r.xa=i[1],0<r.xa-r.K&&i[2]<37500&&r.F&&0==r.A&&!r.C&&(r.C=eT(y(r.Va,r),6e3));1>=eH(r.h)&&r.ta&&(r.ta=void 0)}else tK(r,11)}else if((e.L||r.g==e)&&tz(r),!O(t))for(i=r.Ba.g.parse(t),t=0;t<i.length;t++){let o=i[t],l=o[0];if(!(l<=r.K))if(r.K=l,o=o[1],2==r.I)if("c"==o[0]){r.M=o[1],r.ba=o[2];let t=o[3];null!=t&&(r.ka=t,r.j.info("VER="+r.ka));let i=o[4];null!=i&&(r.za=i,r.j.info("SVER="+r.za));let l=o[5];null!=l&&"number"==typeof l&&l>0&&(r.O=n=1.5*l,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;let u=e.g;if(u){let e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(eQ(s,s.h),s.h=null))}if(n.G){let e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.wa=e,e3(n.J,n.G,e))}}if(r.I=3,r.l&&r.l.ra(),r.aa&&(r.T=Date.now()-e.F,r.j.info("Handshake RTT: "+r.T+"ms")),(n=r).na=tW(n,n.L?n.ba:null,n.W),e.L){eJ(n.h,e);var a=n.O;a&&(e.H=a),e.D&&(eB(e),eV(e)),n.g=e}else tU(n);r.i.length>0&&tL(r)}else"stop"!=o[0]&&"close"!=o[0]||tK(r,7);else 3==r.I&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?tK(r,7):tR(r):"noop"!=o[0]&&r.l&&r.l.qa(o),r.A=0)}}eb(4)}catch(e){}}eD.prototype.ba=function(e){e=e.target;let t=this.O;t&&3==tx(e)?t.j():this.Y(e)},eD.prototype.Y=function(e){try{if(e==this.g)e:{let f=tx(this.g),p=this.g.ya(),m=this.g.ca();if(!(f<3)&&(3!=f||this.g&&(this.h.h||this.g.la()||tA(this.g)))){this.K||4!=f||7==p||(8==p||m<=0?eb(3):eb(2)),eB(this);var t=this.g.ca();this.X=t;var r=function(e){if(!eF(e))return e.g.la();let t=tA(e.g);if(""===t)return"";let r="",n=t.length,i=4==tx(e.g);if(!e.h.i){if("u"<typeof TextDecoder)return eq(e),ej(e),"";e.h.i=new a.TextDecoder}for(let s=0;s<n;s++)e.h.h=!0,r+=e.h.i.decode(t[s],{stream:!(i&&s==n-1)});return t.length=0,e.h.g+=r,e.C=0,e.h.g}(this);if(this.o=200==t,n=this.i,i=this.v,s=this.B,o=this.l,l=this.S,n.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+l+"]: "+i+"\n"+s+"\n"+f+" "+t}),this.o){if(this.U&&!this.L){t:{if(this.g){var n,i,s,o,l,u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(u)){var h=u;break t}}h=null}if(e=h)eC(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ez(this,e);else{this.o=!1,this.m=3,eI(12),eq(this),ej(this);break e}}if(this.R){let t;for(e=!0;!this.K&&this.C<r.length;)if((t=function(e,t){var r=e.C,n=t.indexOf("\n",r);return -1==n?eP:isNaN(r=Number(t.substring(r,n)))?eO:(n+=1)+r>t.length?eP:(t=t.slice(n,n+r),e.C=n+r,t)}(this,r))==eP){4==f&&(this.m=4,eI(14),e=!1),eC(this.i,this.l,null,"[Incomplete Response]");break}else if(t==eO){this.m=4,eI(15),eC(this.i,this.l,r,"[Invalid Chunk]"),e=!1;break}else eC(this.i,this.l,t,null),ez(this,t);if(eF(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=r.length||this.h.h||(this.m=1,eI(16),e=!1),this.o=this.o&&e,e){if(r.length>0&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.aa&&!d.P&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+r.length),tj(d),d.P=!0,eI(11))}}else eC(this.i,this.l,r,"[Invalid Chunked Response]"),eq(this),ej(this)}else eC(this.i,this.l,r,null),ez(this,r);4==f&&eq(this),this.o&&!this.K&&(4==f?t$(this.j,this):(this.o=!1,eV(this)))}else(function(e){let t={};e=(e.g&&tx(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(O(e[n]))continue;var r=function(e){var t=1;e=e.split(":");let r=[];for(;t>0&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}(e[n]);let i=r[0];if("string"!=typeof(r=r[1]))continue;r=r.trim();let s=t[i]||[];t[i]=s,s.push(r)}var n=function(e){return e.join(", ")};for(let e in t)n.call(void 0,t[e],e,t)})(this.g),400==t&&r.indexOf("Unknown SID")>0?(this.m=3,eI(12)):(this.m=0,eI(13)),eq(this),ej(this)}}}catch(e){}finally{}},eD.prototype.cancel=function(){this.K=!0,eq(this)},eD.prototype.aa=function(){var e,t;this.D=null;let r=Date.now();r-this.T>=0?(e=this.i,t=this.B,e.info(function(){return"TIMEOUT: "+t}),2!=this.M&&(eb(),eI(17)),eq(this),this.m=2,ej(this)):eU(this,this.T-r)};var e$=class{constructor(e,t){this.g=e,this.map=t}};function eG(e){this.l=e||10,e=a.PerformanceNavigationTiming?(e=a.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function eK(e){return!!e.h||!!e.g&&e.g.size>=e.j}function eH(e){return e.h?1:e.g?e.g.size:0}function eW(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eQ(e,t){e.g?e.g.add(t):e.h=t}function eJ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function eY(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let r of e.g.values())t=t.concat(r.G);return t}return _(e.i)}eG.prototype.cancel=function(){if(this.i=eY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eX=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eZ(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof eZ?(this.l=e.l,e1(this,e.j),this.o=e.o,this.g=e.g,e2(this,e.u),this.h=e.h,e6(this,tc(e.i)),this.m=e.m):e&&(t=String(e).match(eX))?(this.l=!1,e1(this,t[1]||"",!0),this.o=e5(t[2]||""),this.g=e5(t[3]||"",!0),e2(this,t[4]),this.h=e5(t[5]||"",!0),e6(this,t[6]||"",!0),this.m=e5(t[7]||"")):(this.l=!1,this.i=new ti(null,this.l))}function e0(e){return new eZ(e)}function e1(e,t,r){e.j=r?e5(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function e2(e,t){if(t){if(isNaN(t=Number(t))||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function e6(e,t,r){var n,i;t instanceof ti?(e.i=t,n=e.i,(i=e.l)&&!n.j&&(ts(n),n.i=null,n.g.forEach(function(e,t){let r=t.toLowerCase();t!=r&&(ta(this,t),tu(this,r,e))},n)),n.j=i):(r||(t=e8(t,tr)),e.i=new ti(t,e.l))}function e3(e,t,r){e.i.set(t,r)}function e4(e){return e3(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function e5(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function e8(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,e7),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function e7(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}eZ.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(e8(t,e9,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(e8(t,e9,!0),"@"),e.push(eN(r).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.u)&&e.push(":",String(r))),(r=this.h)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(e8(r,"/"==r.charAt(0)?tt:te,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",e8(r,tn)),e.join("")},eZ.prototype.resolve=function(e){let t=e0(this),r=!!e.j;r?e1(t,e.j):r=!!e.o,r?t.o=e.o:r=!!e.g,r?t.g=e.g:r=null!=e.u;var n=e.h;if(r)e2(t,e.u);else if(r=!!e.h){if("/"!=n.charAt(0))if(this.g&&!this.h)n="/"+n;else{var i=t.h.lastIndexOf("/");-1!=i&&(n=t.h.slice(0,i+1)+n)}if(".."==(i=n)||"."==i)n="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){n=0==i.lastIndexOf("/",0),i=i.split("/");let e=[];for(let t=0;t<i.length;){let r=i[t++];"."==r?n&&t==i.length&&e.push(""):".."==r?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),n&&t==i.length&&e.push("")):(e.push(r),n=!0)}n=e.join("/")}else n=i}return r?t.h=n:r=""!==e.i.toString(),r?e6(t,tc(e.i)):r=!!e.m,r&&(t.m=e.m),t};var e9=/[#\/\?@]/g,te=/[#\?:]/g,tt=/[#\?]/g,tr=/[#\?@]/g,tn=/#/g;function ti(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ts(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let r=0;r<e.length;r++){let n=e[r].indexOf("="),i,s=null;n>=0?(i=e[r].substring(0,n),s=e[r].substring(n+1)):i=e[r],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function ta(e,t){ts(e),t=th(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function to(e,t){return ts(e),t=th(e,t),e.g.has(t)}function tl(e,t){ts(e);let r=[];if("string"==typeof t)to(e,t)&&(r=r.concat(e.g.get(th(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)r=r.concat(e[t]);return r}function tu(e,t,r){ta(e,t),r.length>0&&(e.i=null,e.g.set(th(e,t),_(r)),e.h+=r.length)}function tc(e){let t=new ti;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function th(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function td(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(e){}}function tf(){this.g=new ec}function tp(e){this.i=e.Sb||null,this.h=e.ab||!1}function tm(e,t){et.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function tg(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function ty(e){e.readyState=4,e.l=null,e.j=null,e.B=null,tv(e)}function tv(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function tw(e){let t="";return U(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function tb(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=tw(r),"string"==typeof e?null!=r&&eN(r):e3(e,t,r))}function t_(e){et.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(t=ti.prototype).add=function(e,t){ts(this),this.i=null,e=th(this,e);let r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},t.forEach=function(e,t){ts(this),this.g.forEach(function(r,n){r.forEach(function(r){e.call(t,r,n,this)},this)},this)},t.set=function(e,t){return ts(this),this.i=null,to(this,e=th(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&(e=tl(this,e)).length>0?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(let n=0;n<t.length;n++){var r=t[n];let i=eN(r);r=tl(this,r);for(let t=0;t<r.length;t++){let n=i;""!==r[t]&&(n+="="+eN(r[t])),e.push(n)}}return this.i=e.join("&")},w(tp,eh),tp.prototype.g=function(){return new tm(this.i,this.h)},w(tm,et),(t=tm.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,tv(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||a).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,ty(this)),this.readyState=0},t.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tv(this)),this.g&&(this.readyState=3,tv(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tg(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},t.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ty(this):tv(this),3==this.readyState&&tg(this)}},t.Oa=function(e){this.g&&(this.response=this.responseText=e,ty(this))},t.Na=function(e){this.g&&(this.response=e,ty(this))},t.ga=function(){this.g&&ty(this)},t.setRequestHeader=function(e,t){this.A.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var r=t.next();!r.done;)e.push((r=r.value)[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(tm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),w(t_,et);var tI=/^https?$/i,tE=["POST","PUT"];function tT(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,tS(e),tk(e)}function tS(e){e.A||(e.A=!0,er(e,"complete"),er(e,"error"))}function tC(e){if(e.h&&void 0!==s){if(e.v&&4==tx(e))setTimeout(e.Ca.bind(e),0);else if(er(e,"readystatechange"),4==tx(e)){e.h=!1;try{let s=e.ca();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,r,n=!0;break;default:n=!1}if(!(t=n)){if(r=0===s){let t=String(e.D).match(eX)[1]||null;!t&&a.self&&a.self.location&&(t=a.self.location.protocol.slice(0,-1)),r=!tI.test(t?t.toLowerCase():"")}t=r}if(t)er(e,"complete"),er(e,"success");else{e.o=6;try{var i=tx(e)>2?e.g.statusText:""}catch(e){i=""}e.l=i+" ["+e.ca()+"]",tS(e)}}finally{tk(e)}}}}function tk(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let r=e.g;e.g=null,t||er(e,"ready");try{r.onreadystatechange=null}catch(e){}}}function tx(e){return e.g?e.g.readyState:0}function tA(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tN(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tD(e){this.za=0,this.i=[],this.j=new eS,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tN("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tN("baseRetryDelayMs",5e3,e),this.Za=tN("retryDelaySeedMs",1e4,e),this.Ta=tN("forwardChannelMaxRetries",2,e),this.va=tN("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new eG(e&&e.concurrentRequestLimit),this.Ba=new tf,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function tR(e){if(tP(e),3==e.I){var t=e.V++,r=e0(e.J);if(e3(r,"SID",e.M),e3(r,"RID",t),e3(r,"TYPE","terminate"),tF(e,r),(t=new eD(e,e.j,t)).M=2,t.A=e4(e0(r)),r=!1,a.navigator&&a.navigator.sendBeacon)try{r=a.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!r&&a.Image&&((new Image).src=t.A,r=!0),r||(t.g=tQ(t.j,null),t.g.ea(t.A)),t.F=Date.now(),eV(t)}tH(e)}function tO(e){e.g&&(tj(e),e.g.cancel(),e.g=null)}function tP(e){tO(e),e.v&&(a.clearTimeout(e.v),e.v=null),tz(e),e.h.cancel(),e.m&&("number"==typeof e.m&&a.clearTimeout(e.m),e.m=null)}function tL(e){if(!eK(e.h)&&!e.m){e.m=!0;var t=e.Ea;S||x(),C||(S(),C=!0),k.add(t,e),e.D=0}}function tM(e,t){var r;r=t?t.l:e.V++;let n=e0(e.J);e3(n,"SID",e.M),e3(n,"RID",r),e3(n,"AID",e.K),tF(e,n),e.u&&e.o&&tb(n,e.u,e.o),r=new eD(e,e.j,r,e.D+1),null===e.u&&(r.J=e.o),t&&(e.i=t.G.concat(e.i)),t=tV(e,r,1e3),r.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),eQ(e.h,r),eL(r,n,t)}function tF(e,t){e.H&&U(e.H,function(e,r){e3(t,r,e)}),e.l&&U({},function(e,r){e3(t,r,e)})}function tV(e,t,r){r=Math.min(e.i.length,r);let n=e.l?y(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){let e=["count="+r];-1==t?r>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let u=0;u<r;u++){var s=i[u].g;let r=i[u].map;if((s-=t)<0)t=Math.max(0,i[u].g-100),l=!1;else try{s="req"+s+"_";try{var a=r instanceof Map?r:Object.entries(r);for(let[t,r]of a){let n=r;o(r)&&(n=el(r)),e.push(s+t+"="+encodeURIComponent(n))}}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}catch(e){n&&n(r)}}if(l){a=e.join("&");break e}}a=void 0}return t.G=e=e.i.splice(0,r),a}function tU(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;S||x(),C||(S(),C=!0),k.add(t,e),e.A=0}}function tB(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=eT(y(e.Da,e),tG(e,e.A)),e.A++,!0)}function tj(e){null!=e.B&&(a.clearTimeout(e.B),e.B=null)}function tq(e){e.g=new eD(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=e0(e.na);e3(t,"RID","rpc"),e3(t,"SID",e.M),e3(t,"AID",e.K),e3(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&e3(t,"TO",e.ia),e3(t,"TYPE","xmlhttp"),tF(e,t),e.u&&e.o&&tb(t,e.u,e.o),e.O&&(e.g.H=e.O);var r=e.g;e=e.ba,r.M=1,r.A=e4(e0(t)),r.u=null,r.R=!0,eM(r,e)}function tz(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function t$(e,t){var r,n=null;if(e.g==t){tz(e),tj(e),e.g=null;var i=2}else{if(!eW(e.h,t))return;n=t.G,eJ(e.h,t),i=1}if(0!=e.I){if(t.o)if(1==i){n=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;er(i=ev(),new eE(i,n)),tL(e)}else tU(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==i&&(r=t,!(eH(e.h)>=e.h.j-!!e.m)&&(e.m?(e.i=r.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=eT(y(e.Ea,e,r),tG(e,e.D)),e.D++,!0)))||2==i&&tB(e)))switch(n&&n.length>0&&((t=e.h).i=t.i.concat(n)),s){case 1:tK(e,5);break;case 4:tK(e,10);break;case 3:tK(e,6);break;default:tK(e,2)}}}function tG(e,t){let r=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(r*=2),r*t}function tK(e,t){if(e.j.info("Error code "+t),2==t){let t,s,o;var r,n=y(e.bb,e),i=e.Ua;let l=!i;i=new eZ(i||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||e1(i,"https"),e4(i),l?function(e,t){let r=new eS;if(a.Image){let n=new Image;n.onload=v(td,r,"TestLoadImage: loaded",!0,t,n),n.onerror=v(td,r,"TestLoadImage: error",!1,t,n),n.onabort=v(td,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=v(td,r,"TestLoadImage: timeout",!1,t,n),a.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}(i.toString(),n):(r=i.toString(),t=new eS,s=new AbortController,o=setTimeout(()=>{s.abort(),td(t,"TestPingServer: timeout",!1,n)},1e4),fetch(r,{signal:s.signal}).then(e=>{clearTimeout(o),e.ok?td(t,"TestPingServer: ok",!0,n):td(t,"TestPingServer: server error",!1,n)}).catch(()=>{clearTimeout(o),td(t,"TestPingServer: error",!1,n)}))}else eI(2);e.I=0,e.l&&e.l.pa(t),tH(e),tP(e)}function tH(e){if(e.I=0,e.ja=[],e.l){let t=eY(e.h);(0!=t.length||0!=e.i.length)&&(I(e.ja,t),I(e.ja,e.i),e.h.i.length=0,_(e.i),e.i.length=0),e.l.oa()}}function tW(e,t,r){var n=r instanceof eZ?e0(r):new eZ(r);if(""!=n.g)t&&(n.g=t+"."+n.g),e2(n,n.u);else{var i=a.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;let e=new eZ(null);n&&e1(e,n),t&&(e.g=t),i&&e2(e,i),r&&(e.h=r),n=e}return r=e.G,t=e.wa,r&&t&&e3(n,r,t),e3(n,"VER",e.ka),tF(e,n),n}function tQ(e,t,r){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new t_(e.Aa&&!e.ma?new tp({ab:r}):e.ma)).Fa(e.L),t}function tJ(){}function tY(){}function tX(e,t){et.call(this),this.g=new tD(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!O(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!O(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new t1(this)}function tZ(e){ep.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(let r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function t0(){em.call(this),this.status=1}function t1(e){this.g=e}(t=t_.prototype).Fa=function(e){this.H=e},t.ea=function(t,r,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);r=r?r.toUpperCase():"GET",this.D=t,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e.g(),this.g.onreadystatechange=b(y(this.Ca,this));try{this.B=!0,this.g.open(r,String(t),!0),this.B=!1}catch(e){tT(this,e);return}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else if("function"==typeof i.keys&&"function"==typeof i.get)for(let e of i.keys())n.set(e,i.get(e));else throw Error("Unknown input type for opt_headers: "+String(i));for(let[e,o]of(i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=a.FormData&&t instanceof a.FormData,!(Array.prototype.indexOf.call(tE,r,void 0)>=0)||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(e,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(t),this.v=!1}catch(e){tT(this,e)}},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,er(this,"complete"),er(this,"abort"),tk(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tk(this,!0)),t_.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?tC(this):this.Xa())},t.Xa=function(){tC(this)},t.isActive=function(){return!!this.g},t.ca=function(){try{return tx(this)>2?this.g.status:-1}catch(e){return -1}},t.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),eu(t)}},t.ya=function(){return this.o},t.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=tD.prototype).ka=8,t.I=1,t.connect=function(e,t,r,n){eI(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.J=tW(this,null,this.W),tL(this)},t.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let i=new eD(this,this.j,e),s=this.o;if(this.U&&(s?q(s=B(s),this.U):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,r=0;r<this.i.length;r++){t:{var n=this.i[r];if("__data__"in n.map&&"string"==typeof(n=n.map.__data__)){n=n.length;break t}n=void 0}if(void 0===n)break;if((t+=n)>4096){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tV(this,i,t),e3(r=e0(this.J),"RID",e),e3(r,"CVER",22),this.G&&e3(r,"X-HTTP-Session-Id",this.G),tF(this,r),s&&(this.R?t="headers="+eN(tw(s))+"&"+t:this.u&&tb(r,this.u,s)),eQ(this.h,i),this.Ra&&e3(r,"TYPE","init"),this.S?(e3(r,"$req",t),e3(r,"SID","null"),i.U=!0,eL(i,r,null)):eL(i,r,t),this.I=2}}else 3==this.I&&(e?tM(this,e):0==this.i.length||eK(this.h)||tM(this))},t.Da=function(){if(this.v=null,tq(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=eT(y(this.Wa,this),e)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,eI(10),tO(this),tq(this))},t.Va=function(){null!=this.C&&(this.C=null,tO(this),tB(this),eI(19))},t.bb=function(e){e?(this.j.info("Successfully pinged google.com"),eI(2)):(this.j.info("Failed to ping google.com"),eI(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=tJ.prototype).ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){},tY.prototype.g=function(e,t){return new tX(e,t)},w(tX,et),tX.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tX.prototype.close=function(){tR(this.g)},tX.prototype.o=function(e){var t=this.g;if("string"==typeof e){var r={};r.__data__=e,e=r}else this.v&&((r={}).__data__=el(e),e=r);t.i.push(new e$(t.Ya++,e)),3==t.I&&tL(t)},tX.prototype.N=function(){this.g.l=null,delete this.j,tR(this.g),delete this.g,tX.Z.N.call(this)},w(tZ,ep),w(t0,em),w(t1,tJ),t1.prototype.ra=function(){er(this.g,"a")},t1.prototype.qa=function(e){er(this.g,new tZ(e))},t1.prototype.pa=function(e){er(this.g,new t0)},t1.prototype.oa=function(){er(this.g,"b")},tY.prototype.createWebChannel=tY.prototype.g,tX.prototype.send=tX.prototype.o,tX.prototype.open=tX.prototype.m,tX.prototype.close=tX.prototype.close,g=n9.createWebChannelTransport=function(){return new tY},m=n9.getStatEventTarget=function(){return ev()},p=n9.Event=eg,f=n9.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ek.NO_ERROR=0,ek.TIMEOUT=8,ek.HTTP_ERROR=6,d=n9.ErrorCode=ek,ex.COMPLETE="complete",h=n9.EventType=ex,ed.EventType=ef,ef.OPEN="a",ef.CLOSE="b",ef.ERROR="c",ef.MESSAGE="d",et.prototype.listen=et.prototype.J,c=n9.WebChannel=ed,n9.FetchXmlHttpFactory=tp,t_.prototype.listenOnce=t_.prototype.K,t_.prototype.getLastError=t_.prototype.Ha,t_.prototype.getLastErrorCode=t_.prototype.ya,t_.prototype.getStatus=t_.prototype.ca,t_.prototype.getResponseJson=t_.prototype.La,t_.prototype.getResponseText=t_.prototype.la,t_.prototype.send=t_.prototype.ea,t_.prototype.setWithCredentials=t_.prototype.Fa,u=n9.XhrIo=t_}).apply(void 0!==n7?n7:"u">typeof self?self:"u">typeof window?window:{});class ie{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ie.UNAUTHENTICATED=new ie(null),ie.GOOGLE_CREDENTIALS=new ie("google-credentials-uid"),ie.FIRST_PARTY=new ie("first-party-uid"),ie.MOCK_USER=new ie("mock-user");let it="12.9.0",ir=new ep("@firebase/firestore");function ii(){return ir.logLevel}function is(e,...t){if(ir.logLevel<=a.DEBUG){let r=t.map(il);ir.debug(`Firestore (${it}): ${e}`,...r)}}function ia(e,...t){if(ir.logLevel<=a.ERROR){let r=t.map(il);ir.error(`Firestore (${it}): ${e}`,...r)}}function io(e,...t){if(ir.logLevel<=a.WARN){let r=t.map(il);ir.warn(`Firestore (${it}): ${e}`,...r)}}function il(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function iu(e,t,r){let n="Unexpected state";"string"==typeof t?n=t:r=t,ic(e,n,r)}function ic(e,t,r){let n=`FIRESTORE (${it}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{n+=" CONTEXT: "+JSON.stringify(r)}catch(e){n+=" CONTEXT: "+r}throw ia(n),Error(n)}function ih(e,t,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,e||ic(t,i,n)}let id={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ip extends W{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class im{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ig{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ie.UNAUTHENTICATED))}shutdown(){}}class iv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class iw{constructor(e){this.t=e,this.currentUser=ie.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ih(void 0===this.o,42304);let r=this.i,n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve(),i=new im;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new im,e.enqueueRetryable(()=>n(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},a=e=>{is("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?a(e):(is("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new im)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(is("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ih("string"==typeof t.accessToken,31837,{l:t}),new ig(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ih(null===e||"string"==typeof e,2055,{h:e}),new ie(e)}}class ib{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ie.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class i_{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new ib(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ie.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class iI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iE{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ez(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ih(void 0===this.o,3512);let r=e=>{null!=e.error&&is("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.m;return this.m=e.token,is("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};let n=e=>{is("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?n(e):is("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new iI(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(ih("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new iI(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class iT{static newId(){let e=62*Math.floor(256/62),t="";for(;t.length<20;){let r=function(e){let t="u">typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let e=0;e<40;e++)r[e]=Math.floor(256*Math.random());return r}(0);for(let n=0;n<r.length;++n)t.length<20&&r[n]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[n]%62))}return t}}function iS(e,t){return e<t?-1:+(e>t)}function iC(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=e.charAt(n),i=t.charAt(n);if(r!==i)return ik(r)===ik(i)?iS(r,i):ik(r)?1:-1}return iS(e.length,t.length)}function ik(e){let t=e.charCodeAt(0);return t>=55296&&t<=57343}function ix(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}let iA="__name__";class iN{constructor(e,t,r){void 0===t?t=0:t>e.length&&iu(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&iu(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===iN.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof iN?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=iN.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return iS(e.length,t.length)}static compareSegments(e,t){let r=iN.isNumericId(e),n=iN.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?iN.extractNumericId(e).compare(iN.extractNumericId(t)):iC(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return o.fromString(e.substring(4,e.length-2))}}class iD extends iN{construct(e,t,r){return new iD(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new ip(id.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new iD(t)}static emptyPath(){return new iD([])}}let iR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class iO extends iN{construct(e,t,r){return new iO(e,t,r)}static isValidIdentifier(e){return iR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),iO.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===iA}static keyField(){return new iO([iA])}static fromServerFormat(e){let t=[],r="",n=0,i=()=>{if(0===r.length)throw new ip(id.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;n<e.length;){let t=e[n];if("\\"===t){if(n+1===e.length)throw new ip(id.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ip(id.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?s=!s:"."!==t||s?r+=t:i(),n++}if(i(),s)throw new ip(id.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new iO(t)}static emptyPath(){return new iO([])}}class iP{constructor(e){this.path=e}static fromPath(e){return new iP(iD.fromString(e))}static fromName(e){return new iP(iD.fromString(e).popFirst(5))}static empty(){return new iP(iD.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===iD.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return iD.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new iP(new iD(e.slice()))}}function iL(e,t,r){if(!r)throw new ip(id.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function iM(e){if(!iP.isDocumentKey(e))throw new ip(id.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function iF(e){if(iP.isDocumentKey(e))throw new ip(id.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function iV(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function iU(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}}return"function"==typeof e?"a function":iu(12329,{type:typeof e})}function iB(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ip(id.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=iU(e);throw new ip(id.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function ij(e,t){if(t<=0)throw new ip(id.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function iq(e,t){let r={typeString:e};return t&&(r.value=t),r}function iz(e,t){let r;if(!iV(e))throw new ip(id.INVALID_ARGUMENT,"JSON must be an object");for(let n in t)if(t[n]){let i=t[n].typeString,s="value"in t[n]?{value:t[n].value}:void 0;if(!(n in e)){r=`JSON missing required field: '${n}'`;break}let a=e[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new ip(id.INVALID_ARGUMENT,r);return!0}class i${static now(){return i$.fromMillis(Date.now())}static fromDate(e){return i$.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new i$(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new ip(id.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new ip(id.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?iS(this.nanoseconds,e.nanoseconds):iS(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:i$._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(iz(e,i$._jsonSchema))return new i$(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}i$._jsonSchemaVersion="firestore/timestamp/1.0",i$._jsonSchema={type:iq("string",i$._jsonSchemaVersion),seconds:iq("number"),nanoseconds:iq("number")};class iG{static fromTimestamp(e){return new iG(e)}static min(){return new iG(new i$(0,0))}static max(){return new iG(new i$(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class iK{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}function iH(e){return e.fields.find(e=>2===e.kind)}function iW(e){return e.fields.filter(e=>2!==e.kind)}function iQ(e,t){let r=iS(e.collectionGroup,t.collectionGroup);if(0!==r)return r;for(let n=0;n<Math.min(e.fields.length,t.fields.length);++n)if(0!==(r=function(e,t){let r=iO.comparator(e.fieldPath,t.fieldPath);return 0!==r?r:iS(e.kind,t.kind)}(e.fields[n],t.fields[n])))return r;return iS(e.fields.length,t.fields.length)}iK.UNKNOWN_ID=-1;class iJ{constructor(e,t){this.fieldPath=e,this.kind=t}}class iY{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new iY(0,i0.min())}}function iX(e,t){let r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1;return new i0(iG.fromTimestamp(1e9===n?new i$(r+1,0):new i$(r,n)),iP.empty(),t)}function iZ(e){return new i0(e.readTime,e.key,-1)}class i0{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new i0(iG.min(),iP.empty(),-1)}static max(){return new i0(iG.max(),iP.empty(),-1)}}function i1(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=iP.comparator(e.documentKey,t.documentKey))?r:iS(e.largestBatchId,t.largestBatchId)}let i2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class i6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function i3(e){if(e.code!==id.FAILED_PRECONDITION||e.message!==i2)throw e;is("LocalStore","Unexpectedly lost primary lease")}class i4{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&iu(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new i4((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof i4?t:i4.resolve(t)}catch(e){return i4.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):i4.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):i4.reject(t)}static resolve(e){return new i4((t,r)=>{t(e)})}static reject(e){return new i4((t,r)=>{r(e)})}static waitFor(e){return new i4((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=i4.resolve(!1);for(let r of e)t=t.next(e=>e?i4.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new i4((r,n)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===i&&r(s)},e=>n(e))}})}static doWhile(e,t){return new i4((r,n)=>{let i=()=>{!0===e()?t().next(()=>{i()},n):r()};i()})}}let i5="SimpleDb";class i8{static open(e,t,r,n){try{return new i8(t,e.transaction(n,r))}catch(e){throw new st(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new im,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new st(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{let r=sa(t.target.error);this.S.reject(new st(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(is(i5,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new sn(this.transaction.objectStore(e))}}class i7{static delete(e){return is(i5,"Removing database:",e),si(D().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!H())return!1;if(i7.F())return!0;let e=q(),t=i7.M(e),r=i9(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<t&&t<10||0<r&&r<4.5)}static F(){return void 0!==E.default&&"YES"===E.default.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(t?t[1].split("_").slice(0,2).join("."):"-1")}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,12.2===i7.M(q())&&ia("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(is(i5,"Opening database:",this.name),this.db=await new Promise((t,r)=>{let n=indexedDB.open(this.name,this.version);n.onsuccess=e=>{t(e.target.result)},n.onblocked=()=>{r(new st(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=t=>{let n=t.target.error;"VersionError"===n.name?r(new ip(id.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new ip(id.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new st(e,n))},n.onupgradeneeded=e=>{is(i5,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.N.k(t,n.transaction,e.oldVersion,this.version).next(()=>{is(i5,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=e=>this.K(e)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,n){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.L(e);let t=i8.open(this.db,e,i?"readonly":"readwrite",r),s=n(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),i4.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(t){let e="FirebaseError"!==t.name&&s<3;if(is(i5,"Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function i9(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}class se{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return si(this.U.delete())}}class st extends ip{constructor(e,t){super(id.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function sr(e){return"IndexedDbTransactionError"===e.name}class sn{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(is(i5,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(is(i5,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),si(r)}add(e){return is(i5,"ADD",this.store.name,e,e),si(this.store.add(e))}get(e){return si(this.store.get(e)).next(t=>(void 0===t&&(t=null),is(i5,"GET",this.store.name,e,t),t))}delete(e){return is(i5,"DELETE",this.store.name,e),si(this.store.delete(e))}count(){return is(i5,"COUNT",this.store.name),si(this.store.count())}H(e,t){let r=this.options(e,t),n=r.index?this.store.index(r.index):this.store;if("function"==typeof n.getAll){let e=n.getAll(r.range);return new i4((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(r),t=[];return this.J(e,(e,r)=>{t.push(r)}).next(()=>t)}}Z(e,t){let r=this.store.getAll(e,null===t?void 0:t);return new i4((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}X(e,t){is(i5,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let n=this.cursor(r);return this.J(n,(e,t,r)=>r.delete())}ee(e,t){let r;t?r=e:(r={},t=e);let n=this.cursor(r);return this.J(n,t)}te(e){let t=this.cursor({});return new i4((r,n)=>{t.onerror=e=>{n(sa(e.target.error))},t.onsuccess=t=>{let n=t.target.result;n?e(n.primaryKey,n.value).next(e=>{e?n.continue():r()}):r()}})}J(e,t){let r=[];return new i4((n,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void n();let s=new se(i),a=t(i.primaryKey,i.value,s);if(a instanceof i4){let e=a.catch(e=>(s.done(),i4.reject(e)));r.push(e)}s.isDone?n():null===s.G?i.continue():i.continue(s.G)}}).next(()=>i4.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function si(e){return new i4((t,r)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{r(sa(e.target.error))}})}let ss=!1;function sa(e){let t=i7.M(q());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new ip("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ss||(ss=!0,setTimeout(()=>{throw e},0)),e}}return e}let so="IndexBackfiller";class sl{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){is(so,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.ne.ie();is(so,`Documents written: ${e}`)}catch(e){sr(e)?is(so,"Ignoring IndexedDB error during index backfill: ",e):await i3(e)}await this.re(6e4)})}}class su{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){let r=new Set,n=t,i=!0;return i4.doWhile(()=>!0===i&&n>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return is(so,`Processing collection: ${t}`),this.oe(e,t,n).next(e=>{n-=e,r.add(t)});i=!1})).next(()=>t-n)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(n=>this.localStore.localDocuments.getNextDocuments(e,t,n,r).next(r=>{let i=r.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this._e(n,r)).next(r=>(is(so,`Updating offset: ${r}`),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>i.size)}))}_e(e,t){let r=e;return t.changes.forEach((e,t)=>{let n=iZ(t);i1(n,r)>0&&(r=n)}),new i0(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class sc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}}function sh(e){return null==e}function sd(e){return 0===e&&1/e==-1/0}function sf(e){return"number"==typeof e&&Number.isInteger(e)&&!sd(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function sp(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t+="\x01\x01"),t=function(e,t){let r=t,n=e.length;for(let t=0;t<n;t++){let n=e.charAt(t);switch(n){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=n}}return r}(e.get(r),t);return t+"\x01\x01"}sc.ce=-1;function sm(e){let t=e.length;if(ih(t>=2,64408,{path:e}),2===t)return ih("\x01"===e.charAt(0)&&"\x01"===e.charAt(1),56145,{path:e}),iD.emptyPath();let r=t-2,n=[],i="";for(let s=0;s<t;){let t=e.indexOf("\x01",s);switch((t<0||t>r)&&iu(50515,{path:e}),e.charAt(t+1)){case"\x01":let a,o=e.substring(s,t);0===i.length?a=o:(i+=o,a=i,i=""),n.push(a);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:iu(61167,{path:e})}s=t+2}return new iD(n)}let sg="remoteDocuments",sy="owner",sv="owner",sw="mutationQueues",sb="mutations",s_="batchId",sI="userMutationsIndex",sE=["userId","batchId"],sT={},sS="documentMutations",sC="remoteDocumentsV14",sk=["prefixPath","collectionGroup","readTime","documentId"],sx="documentKeyIndex",sA=["prefixPath","collectionGroup","documentId"],sN="collectionGroupIndex",sD=["collectionGroup","readTime","prefixPath","documentId"],sR="remoteDocumentGlobal",sO="remoteDocumentGlobalKey",sP="targets",sL="queryTargetsIndex",sM=["canonicalId","targetId"],sF="targetDocuments",sV=["targetId","path"],sU="documentTargetsIndex",sB=["path","targetId"],sj="targetGlobalKey",sq="targetGlobal",sz="collectionParents",s$=["collectionId","parent"],sG="clientMetadata",sK="bundles",sH="namedQueries",sW="indexConfiguration",sQ="collectionGroupIndex",sJ="indexState",sY=["indexId","uid"],sX="sequenceNumberIndex",sZ=["uid","sequenceNumber"],s0="indexEntries",s1=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],s2="documentKeyIndex",s6=["indexId","uid","orderedDocumentKey"],s3="documentOverlays",s4=["userId","collectionPath","documentId"],s5="collectionPathOverlayIndex",s8=["userId","collectionPath","largestBatchId"],s7="collectionGroupOverlayIndex",s9=["userId","collectionGroup","largestBatchId"],ae="globals",at=[sw,sb,sS,sg,sP,sy,sq,sF,sG,sR,sz,sK,sH],ar=[...at,s3],an=[sw,sb,sS,sC,sP,sy,sq,sF,sG,sR,sz,sK,sH,s3],ai=[...an,sW,sJ,s0],as=[...ai,ae];class aa extends i6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ao(e,t){return i7.O(e.le,t)}function al(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function au(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function ac(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ah{constructor(e,t){this.comparator=e,this.root=t||af.EMPTY}insert(e,t){return new ah(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,af.BLACK,null,null))}remove(e){return new ah(this.comparator,this.root.remove(e,this.comparator).copy(null,null,af.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ad(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ad(this.root,e,this.comparator,!1)}getReverseIterator(){return new ad(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ad(this.root,e,this.comparator,!0)}}class ad{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class af{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:af.RED,this.left=null!=n?n:af.EMPTY,this.right=null!=i?i:af.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new af(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return af.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(0>t(e,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return af.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,af.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,af.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw iu(43730,{key:this.key,value:this.value});if(this.right.isRed())throw iu(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw iu(27949);return e+ +!this.isRed()}}af.EMPTY=null,af.RED=!0,af.BLACK=!1,af.EMPTY=new class{constructor(){this.size=0}get key(){throw iu(57766)}get value(){throw iu(16141)}get color(){throw iu(16727)}get left(){throw iu(29726)}get right(){throw iu(36894)}copy(e,t,r,n,i){return this}insert(e,t,r){return new af(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ap{constructor(e){this.comparator=e,this.data=new ah(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new am(this.data.getIterator())}getIteratorFrom(e){return new am(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof ap)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new ap(this.comparator);return t.data=e,t}}class am{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ag(e){return e.hasNext()?e.getNext():void 0}class ay{constructor(e){this.fields=e,e.sort(iO.comparator)}static empty(){return new ay([])}unionWith(e){let t=new ap(iO.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new ay(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ix(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class av extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class aw{constructor(e){this.binaryString=e}static fromBase64String(e){return new aw(function(e){try{return atob(e)}catch(e){throw"u">typeof DOMException&&e instanceof DOMException?new av("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new aw(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return iS(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}aw.EMPTY_BYTE_STRING=new aw("");let ab=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function a_(e){if(ih(!!e,39018),"string"==typeof e){let t=0,r=ab.exec(e);if(ih(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:aI(e.seconds),nanos:aI(e.nanos)}}function aI(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function aE(e){return"string"==typeof e?aw.fromBase64String(e):aw.fromUint8Array(e)}let aT="server_timestamp",aS="__type__",aC="__previous_value__",ak="__local_write_time__";function ax(e){return(e?.mapValue?.fields||{})[aS]?.stringValue===aT}function aA(e){let t=e.mapValue.fields[aC];return ax(t)?aA(t):t}function aN(e){let t=a_(e.mapValue.fields[ak].timestampValue);return new i$(t.seconds,t.nanos)}class aD{constructor(e,t,r,n,i,s,a,o,l,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=u,this.apiKey=c}}let aR="(default)";class aO{constructor(e,t){this.projectId=e,this.database=t||aR}static empty(){return new aO("","")}get isDefaultDatabase(){return this.database===aR}isEqual(e){return e instanceof aO&&e.projectId===this.projectId&&e.database===this.database}}let aP="__type__",aL="__max__",aM={mapValue:{fields:{__type__:{stringValue:aL}}}},aF="__vector__",aV="value",aU={nullValue:"NULL_VALUE"};function aB(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ax(e)?4:a1(e)?0x1fffffffffffff:aZ(e)?10:11:iu(28295,{value:e})}function aj(e,t){if(e===t)return!0;let r=aB(e);if(r!==aB(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return aN(e).isEqual(aN(t));case 3:if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=a_(e.timestampValue),i=a_(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos;case 5:return e.stringValue===t.stringValue;case 6:return aE(e.bytesValue).isEqual(aE(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return aI(e.geoPointValue.latitude)===aI(t.geoPointValue.latitude)&&aI(e.geoPointValue.longitude)===aI(t.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in t)return aI(e.integerValue)===aI(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=aI(e.doubleValue),n=aI(t.doubleValue);return r===n?sd(r)===sd(n):isNaN(r)&&isNaN(n)}return!1;case 9:return ix(e.arrayValue.values||[],t.arrayValue.values||[],aj);case 10:case 11:let s=e.mapValue.fields||{},a=t.mapValue.fields||{};if(al(s)!==al(a))return!1;for(let e in s)if(s.hasOwnProperty(e)&&(void 0===a[e]||!aj(s[e],a[e])))return!1;return!0;default:return iu(52216,{left:e})}}function aq(e,t){return void 0!==(e.values||[]).find(e=>aj(e,t))}function az(e,t){var r,n,i,s,a,o;if(e===t)return 0;let l=aB(e),u=aB(t);if(l!==u)return iS(l,u);switch(l){case 0:case 0x1fffffffffffff:return 0;case 1:return iS(e.booleanValue,t.booleanValue);case 2:let c,h;return c=aI(e.integerValue||e.doubleValue),c<(h=aI(t.integerValue||t.doubleValue))?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1;case 3:return a$(e.timestampValue,t.timestampValue);case 4:return a$(aN(e),aN(t));case 5:return iC(e.stringValue,t.stringValue);case 6:let d,f;return r=e.bytesValue,n=t.bytesValue,d=aE(r),f=aE(n),d.compareTo(f);case 7:return function(e,t){let r=e.split("/"),n=t.split("/");for(let e=0;e<r.length&&e<n.length;e++){let t=iS(r[e],n[e]);if(0!==t)return t}return iS(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:let p;return i=e.geoPointValue,s=t.geoPointValue,0!==(p=iS(aI(i.latitude),aI(s.latitude)))?p:iS(aI(i.longitude),aI(s.longitude));case 9:return aG(e.arrayValue,t.arrayValue);case 10:let m,g,y,v,w;return a=e.mapValue,o=t.mapValue,m=a.fields||{},g=o.fields||{},y=m[aV]?.arrayValue,v=g[aV]?.arrayValue,0!==(w=iS(y?.values?.length||0,v?.values?.length||0))?w:aG(y,v);case 11:return function(e,t){if(e===aM.mapValue&&t===aM.mapValue)return 0;if(e===aM.mapValue)return 1;if(t===aM.mapValue)return -1;let r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let e=0;e<n.length&&e<s.length;++e){let t=iC(n[e],s[e]);if(0!==t)return t;let a=az(r[n[e]],i[s[e]]);if(0!==a)return a}return iS(n.length,s.length)}(e.mapValue,t.mapValue);default:throw iu(23264,{he:l})}}function a$(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return iS(e,t);let r=a_(e),n=a_(t),i=iS(r.seconds,n.seconds);return 0!==i?i:iS(r.nanos,n.nanos)}function aG(e,t){let r=e.values||[],n=t.values||[];for(let e=0;e<r.length&&e<n.length;++e){let t=az(r[e],n[e]);if(t)return t}return iS(r.length,n.length)}function aK(e){var t,r;let n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(n=a_(e.timestampValue),`time(${n.seconds},${n.nanos})`):"stringValue"in e?e.stringValue:"bytesValue"in e?aE(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,iP.fromName(t).toString()):"geoPointValue"in e?(r=e.geoPointValue,`geo(${r.latitude},${r.longitude})`):"arrayValue"in e?function(e){let t="[",r=!0;for(let n of e.values||[])r?r=!1:t+=",",t+=aK(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(let i of t)n?n=!1:r+=",",r+=`${i}:${aK(e.fields[i])}`;return r+"}"}(e.mapValue):iu(61005,{value:e})}function aH(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function aW(e){return!!e&&"integerValue"in e}function aQ(e){return!!e&&"arrayValue"in e}function aJ(e){return!!e&&"nullValue"in e}function aY(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function aX(e){return!!e&&"mapValue"in e}function aZ(e){return(e?.mapValue?.fields||{})[aP]?.stringValue===aF}function a0(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return au(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=a0(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=a0(e.arrayValue.values[r]);return t}return{...e}}function a1(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===aL}let a2={mapValue:{fields:{[aP]:{stringValue:aF},[aV]:{arrayValue:{}}}}};function a6(e,t){let r=az(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function a3(e,t){let r=az(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class a4{constructor(e){this.value=e}static empty(){return new a4({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!aX(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=a0(t)}setAll(e){let t=iO.emptyPath(),r={},n=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=a0(e):n.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){let t=this.field(e.popLast());aX(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return aj(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];aX(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){for(let n of(au(t,(t,r)=>e[t]=r),r))delete e[n]}clone(){return new a4(a0(this.value))}}class a5{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new a5(e,0,iG.min(),iG.min(),iG.min(),a4.empty(),0)}static newFoundDocument(e,t,r,n){return new a5(e,1,t,iG.min(),r,n,0)}static newNoDocument(e,t){return new a5(e,2,t,iG.min(),iG.min(),a4.empty(),0)}static newUnknownDocument(e,t){return new a5(e,3,t,iG.min(),iG.min(),a4.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(iG.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=a4.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=a4.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=iG.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof a5&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new a5(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class a8{constructor(e,t){this.position=e,this.inclusive=t}}function a7(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(n=s.field.isKeyField()?iP.comparator(iP.fromName(a.referenceValue),r.key):az(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function a9(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!aj(e.position[r],t.position[r]))return!1;return!0}class oe{constructor(e,t="asc"){this.field=e,this.dir=t}}class ot{}class or extends ot{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new ou(e,t,r):"array-contains"===t?new of(e,r):"in"===t?new op(e,r):"not-in"===t?new om(e,r):"array-contains-any"===t?new og(e,r):new or(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new oc(e,r):new oh(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(az(t,this.value)):null!==t&&aB(this.value)===aB(t)&&this.matchesComparison(az(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return iu(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class on extends ot{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new on(e,t)}matches(e){return oi(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function oi(e){return"and"===e.op}function os(e){return"or"===e.op}function oa(e){return oo(e)&&oi(e)}function oo(e){for(let t of e.filters)if(t instanceof on)return!1;return!0}function ol(e,t){let r=e.filters.concat(t);return on.create(r,e.op)}class ou extends or{constructor(e,t,r){super(e,t,r),this.key=iP.fromName(r.referenceValue)}matches(e){let t=iP.comparator(e.key,this.key);return this.matchesComparison(t)}}class oc extends or{constructor(e,t){super(e,"in",t),this.keys=od("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class oh extends or{constructor(e,t){super(e,"not-in",t),this.keys=od("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function od(e,t){return(t.arrayValue?.values||[]).map(e=>iP.fromName(e.referenceValue))}class of extends or{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return aQ(t)&&aq(t.arrayValue,this.value)}}class op extends or{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&aq(this.value.arrayValue,t)}}class om extends or{constructor(e,t){super(e,"not-in",t)}matches(e){if(aq(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!aq(this.value.arrayValue,t)}}class og extends or{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!aQ(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>aq(this.value.arrayValue,e))}}class oy{constructor(e,t=null,r=[],n=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.Te=null}}function ov(e,t=null,r=[],n=[],i=null,s=null,a=null){return new oy(e,t,r,n,i,s,a)}function ow(e){if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(e=>(function e(t){if(t instanceof or)return t.field.canonicalString()+t.op.toString()+aK(t.value);if(oa(t))return t.filters.map(t=>e(t)).join(",");{let r=t.filters.map(t=>e(t)).join(",");return`${t.op}(${r})`}})(e)).join(","),t+="|ob:",t+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),sh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>aK(e)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>aK(e)).join(",")),e.Te=t}return e.Te}function ob(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++){var r,n;if(r=e.orderBy[i],n=t.orderBy[i],!(r.dir===n.dir&&r.field.isEqual(n.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){return t instanceof or?r instanceof or&&t.op===r.op&&t.field.isEqual(r.field)&&aj(t.value,r.value):t instanceof on?r instanceof on&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((t,n,i)=>t&&e(n,r.filters[i]),!0):void iu(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!a9(e.startAt,t.startAt)&&a9(e.endAt,t.endAt)}function o_(e){return iP.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function oI(e,t){return e.filters.filter(e=>e instanceof or&&e.field.isEqual(t))}function oE(e,t,r){let n=aU,i=!0;for(let r of oI(e,t)){let e=aU,t=!0;switch(r.op){case"<":case"<=":var s;e="nullValue"in(s=r.value)?aU:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?aH(aO.empty(),iP.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?aZ(s)?a2:{mapValue:{}}:iu(35942,{value:s});break;case"==":case"in":case">=":e=r.value;break;case">":e=r.value,t=!1;break;case"!=":case"not-in":e=aU}0>a6({value:n,inclusive:i},{value:e,inclusive:t})&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];0>a6({value:n,inclusive:i},{value:e,inclusive:r.inclusive})&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}function oT(e,t,r){let n=aM,i=!0;for(let r of oI(e,t)){let e=aM,t=!0;switch(r.op){case">=":case">":var s;e="nullValue"in(s=r.value)?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?aH(aO.empty(),iP.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?a2:"mapValue"in s?aZ(s)?{mapValue:{}}:aM:iu(61959,{value:s}),t=!1;break;case"==":case"in":case"<=":e=r.value;break;case"<":e=r.value,t=!1;break;case"!=":case"not-in":e=aM}a3({value:n,inclusive:i},{value:e,inclusive:t})>0&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];a3({value:n,inclusive:i},{value:e,inclusive:r.inclusive})>0&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}class oS{constructor(e,t=null,r=[],n=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function oC(e){return new oS(e)}function ok(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ox(e){return null!==e.collectionGroup}function oA(e){if(null===e.Ie){let t;e.Ie=[];let r=new Set;for(let t of e.explicitOrderBy)e.Ie.push(t),r.add(t.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new ap(iO.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.Ie.push(new oe(t,n))}),r.has(iO.keyField().canonicalString())||e.Ie.push(new oe(iO.keyField(),n))}return e.Ie}function oN(e){return e.Ee||(e.Ee=oD(e,oA(e))),e.Ee}function oD(e,t){if("F"===e.limitType)return ov(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new oe(e.field,t)});let r=e.endAt?new a8(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new a8(e.startAt.position,e.startAt.inclusive):null;return ov(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function oR(e,t){let r=e.filters.concat([t]);return new oS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function oO(e,t,r){return new oS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function oP(e,t){return ob(oN(e),oN(t))&&e.limitType===t.limitType}function oL(e){return`${ow(oN(e))}|lt:${e.limitType}`}function oM(e){var t;let r;return`Query(target=${r=(t=oN(e)).path.canonicalString(),null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof or?`${t.field.canonicalString()} ${t.op} ${aK(t.value)}`:t instanceof on?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),sh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(e=>aK(e)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(e=>aK(e)).join(",")),`Target(${r})`}; limitType=${e.limitType})`}function oF(e,t){var r,n,i,s;let a,o,l;return t.isFoundDocument()&&(a=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(a):iP.isDocumentKey(e.path)?e.path.isEqual(a):e.path.isImmediateParentOf(a))&&function(e,t){for(let r of oA(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(r=e,n=t,(!r.startAt||(i=r.startAt,o=a7(i,oA(r),n),i.inclusive?!!(o<=0):!!(o<0)))&&(!r.endAt||(s=r.endAt,l=a7(s,oA(r),n),s.inclusive?!!(l>=0):!!(l>0))))}function oV(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function oU(e){return(t,r)=>{let n=!1;for(let i of oA(e)){let e=function(e,t,r){var n;let i,s,a=e.field.isKeyField()?iP.comparator(t.key,r.key):(n=e.field,i=t.data.field(n),s=r.data.field(n),null!==i&&null!==s?az(i,s):iu(42886));switch(e.dir){case"asc":return a;case"desc":return -1*a;default:return iu(19790,{direction:e.dir})}}(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}class oB{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,n]of r)if(this.equalsFn(t,e))return n}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){au(this.inner,(t,r)=>{for(let[t,n]of r)e(t,n)})}isEmpty(){return ac(this.inner)}size(){return this.innerSize}}let oj=new ah(iP.comparator),oq=new ah(iP.comparator);function oz(...e){let t=oq;for(let r of e)t=t.insert(r.key,r);return t}function o$(e){let t=oq;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function oG(){return new oB(e=>e.toString(),(e,t)=>e.isEqual(t))}let oK=new ah(iP.comparator),oH=new ap(iP.comparator);function oW(...e){let t=oH;for(let r of e)t=t.add(r);return t}let oQ=new ap(iS);function oJ(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sd(t)?"-0":t}}function oY(e){return{integerValue:""+e}}class oX{constructor(){this._=void 0}}function oZ(e,t){return e instanceof o4?aW(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class o0 extends oX{}class o1 extends oX{constructor(e){super(),this.elements=e}}function o2(e,t){let r=o8(t);for(let t of e.elements)r.some(e=>aj(e,t))||r.push(t);return{arrayValue:{values:r}}}class o6 extends oX{constructor(e){super(),this.elements=e}}function o3(e,t){let r=o8(t);for(let t of e.elements)r=r.filter(e=>!aj(e,t));return{arrayValue:{values:r}}}class o4 extends oX{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function o5(e){return aI(e.integerValue||e.doubleValue)}function o8(e){return aQ(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class o7{constructor(e,t){this.field=e,this.transform=t}}class o9{constructor(e,t){this.version=e,this.transformResults=t}}class le{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new le}static exists(e){return new le(void 0,e)}static updateTime(e){return new le(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lt(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class lr{}function ln(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new lh(e.key,le.none()):new la(e.key,e.data,le.none());{let r=e.data,n=a4.empty(),i=new ap(iO.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new lo(e.key,n,new ay(i.toArray()),le.none())}}function li(e,t,r,n){return e instanceof la?function(e,t,r,n){if(!lt(e.precondition,t))return r;let i=e.value.clone(),s=lc(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,r,n):e instanceof lo?function(e,t,r,n){if(!lt(e.precondition,t))return r;let i=lc(e.fieldTransforms,n,t),s=t.data;return(s.setAll(ll(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,n):lt(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}function ls(e,t){var r,n;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||!(!r||!n)&&ix(r,n,(e,t)=>{var r,n;return e.field.isEqual(t.field)&&(r=e.transform,n=t.transform,r instanceof o1&&n instanceof o1||r instanceof o6&&n instanceof o6?ix(r.elements,n.elements,aj):r instanceof o4&&n instanceof o4?aj(r.Ae,n.Ae):r instanceof o0&&n instanceof o0)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class la extends lr{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class lo extends lr{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ll(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=e.data.field(r);t.set(r,n)}}),t}function lu(e,t,r){let n=new Map;ih(e.length===r.length,32656,{Ve:r.length,de:e.length});for(let s=0;s<r.length;s++){var i;let a=e[s],o=a.transform,l=t.data.field(a.field);n.set(a.field,(i=r[s],o instanceof o1?o2(o,l):o instanceof o6?o3(o,l):i))}return n}function lc(e,t,r){let n=new Map;for(let i of e){let e=i.transform,s=r.data.field(i.field);n.set(i.field,function(e,t,r){var n;let i,s,a;return e instanceof o0?(n=t,i={fields:{[aS]:{stringValue:aT},[ak]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},n&&ax(n)&&(n=aA(n)),n&&(i.fields[aC]=n),{mapValue:i}):e instanceof o1?o2(e,t):e instanceof o6?o3(e,t):(a=o5(s=oZ(e,t))+o5(e.Ae),aW(s)&&aW(e.Ae)?oY(a):oJ(e.serializer,a))}(e,s,t))}return n}class lh extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ld extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lf{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let n=this.mutations[t];n.key.isEqual(e.key)&&function(e,t,r){let n,i;e instanceof la?(n=e.value.clone(),i=lu(e.fieldTransforms,t,r.transformResults),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()):e instanceof lo?function(e,t,r){if(!lt(e.precondition,t))return t.convertToUnknownDocument(r.version);let n=lu(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(ll(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(e,t,r):t.convertToNoDocument(r.version).setHasCommittedMutations()}(n,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=li(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=li(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=oG();return this.mutations.forEach(n=>{let i=e.get(n.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields),o=ln(s,a=t.has(n.key)?null:a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(iG.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),oW())}isEqual(e){return this.batchId===e.batchId&&ix(this.mutations,e.mutations,(e,t)=>ls(e,t))&&ix(this.baseMutations,e.baseMutations,(e,t)=>ls(e,t))}}class lp{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){ih(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let n=oK,i=e.mutations;for(let e=0;e<i.length;e++)n=n.insert(i[e].key,r[e].version);return new lp(e,t,r,n)}}class lm{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class lg{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class ly{constructor(e,t){this.count=e,this.unchangedNames=t}}function lv(e){switch(e){case id.OK:return iu(64938);case id.CANCELLED:case id.UNKNOWN:case id.DEADLINE_EXCEEDED:case id.RESOURCE_EXHAUSTED:case id.INTERNAL:case id.UNAVAILABLE:case id.UNAUTHENTICATED:return!1;case id.INVALID_ARGUMENT:case id.NOT_FOUND:case id.ALREADY_EXISTS:case id.PERMISSION_DENIED:case id.FAILED_PRECONDITION:case id.ABORTED:case id.OUT_OF_RANGE:case id.UNIMPLEMENTED:case id.DATA_LOSS:return!0;default:return iu(15467,{code:e})}}function lw(e){if(void 0===e)return ia("GRPC error has no .code"),id.UNKNOWN;switch(e){case y.OK:return id.OK;case y.CANCELLED:return id.CANCELLED;case y.UNKNOWN:return id.UNKNOWN;case y.DEADLINE_EXCEEDED:return id.DEADLINE_EXCEEDED;case y.RESOURCE_EXHAUSTED:return id.RESOURCE_EXHAUSTED;case y.INTERNAL:return id.INTERNAL;case y.UNAVAILABLE:return id.UNAVAILABLE;case y.UNAUTHENTICATED:return id.UNAUTHENTICATED;case y.INVALID_ARGUMENT:return id.INVALID_ARGUMENT;case y.NOT_FOUND:return id.NOT_FOUND;case y.ALREADY_EXISTS:return id.ALREADY_EXISTS;case y.PERMISSION_DENIED:return id.PERMISSION_DENIED;case y.FAILED_PRECONDITION:return id.FAILED_PRECONDITION;case y.ABORTED:return id.ABORTED;case y.OUT_OF_RANGE:return id.OUT_OF_RANGE;case y.UNIMPLEMENTED:return id.UNIMPLEMENTED;case y.DATA_LOSS:return id.DATA_LOSS;default:return iu(39323,{code:e})}}(v=y||(y={}))[v.OK=0]="OK",v[v.CANCELLED=1]="CANCELLED",v[v.UNKNOWN=2]="UNKNOWN",v[v.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",v[v.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",v[v.NOT_FOUND=5]="NOT_FOUND",v[v.ALREADY_EXISTS=6]="ALREADY_EXISTS",v[v.PERMISSION_DENIED=7]="PERMISSION_DENIED",v[v.UNAUTHENTICATED=16]="UNAUTHENTICATED",v[v.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",v[v.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",v[v.ABORTED=10]="ABORTED",v[v.OUT_OF_RANGE=11]="OUT_OF_RANGE",v[v.UNIMPLEMENTED=12]="UNIMPLEMENTED",v[v.INTERNAL=13]="INTERNAL",v[v.UNAVAILABLE=14]="UNAVAILABLE",v[v.DATA_LOSS=15]="DATA_LOSS";let lb=null;function l_(){return new TextEncoder}let lI=new o([0xffffffff,0xffffffff],0);function lE(e){let t=l_().encode(e),r=new l;return r.update(t),new Uint8Array(r.digest())}function lT(e){let t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new o([r,n],0),new o([i,s],0)]}class lS{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new lC(`Invalid padding: ${t}`);if(r<0||e.length>0&&0===this.hashCount)throw new lC(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new lC(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=o.fromNumber(this.ge)}ye(e,t,r){let n=e.add(t.multiply(o.fromNumber(r)));return 1===n.compare(lI)&&(n=new o([n.getBits(0),n.getBits(1)],0)),n.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;let[t,r]=lT(lE(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);if(!this.we(n))return!1}return!0}static create(e,t,r){let n=new lS(new Uint8Array(Math.ceil(e/8)),e%8==0?0:8-e%8,t);return r.forEach(e=>n.insert(e)),n}insert(e){if(0===this.ge)return;let[t,r]=lT(lE(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);this.be(n)}}be(e){let t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class lC extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class lk{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let n=new Map;return n.set(e,lx.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new lk(iG.min(),n,new ah(iS),oj,oW())}}class lx{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new lx(r,t,oW(),oW(),oW())}}class lA{constructor(e,t,r,n){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=n}}class lN{constructor(e,t){this.targetId=e,this.Ce=t}}class lD{constructor(e,t,r=aw.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class lR{constructor(){this.ve=0,this.Fe=lL(),this.Me=aw.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=oW(),t=oW(),r=oW();return this.Fe.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:iu(38017,{changeType:i})}}),new lx(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=lL()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ih(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class lO{constructor(e){this.Ge=e,this.ze=new Map,this.je=oj,this.He=lP(),this.Je=lP(),this.Ze=new ah(iS)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:iu(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,r=e.Ce.count,n=this.ot(t);if(n){let a=n.target;if(o_(a))if(0===r){let e=new iP(a.path);this.et(t,e,a5.newNoDocument(e,iG.min()))}else ih(1===r,20013,{expectedCount:r});else{let n=this._t(t);if(n!==r){var i,s;let r,a,o=this.ut(e),l=o?this.ct(o,e,n):1;0!==l&&(this.it(t),this.Ze=this.Ze.insert(t,2===l?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),lb?.lt((i=e.Ce,s=this.Ge.ht(),r={localCacheCount:n,existenceFilterCount:i.count,databaseId:s.database,projectId:s.projectId},(a=i.unchangedNames)&&(r.bloomFilter={applied:0===l,hashCount:a?.hashCount??0,bitmapLength:a?.bits?.bitmap?.length??0,padding:a?.bits?.padding??0,mightContain:e=>o?.mightContain(e)??!1}),r))}}}}ut(e){let t,r,n=e.Ce.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=n;try{t=aE(i).toUint8Array()}catch(e){if(e instanceof av)return io("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new lS(t,s,a)}catch(e){return io(e instanceof lC?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.ge?null:r}ct(e,t,r){return 2*(t.Ce.count!==r-this.Pt(e,t.targetId))}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),n=0;return r.forEach(r=>{let i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${r.path.canonicalString()}`;e.mightContain(s)||(this.et(t,r,null),n++)}),n}Tt(e){let t=new Map;this.ze.forEach((r,n)=>{let i=this.ot(n);if(i){if(r.current&&o_(i.target)){let t=new iP(i.target.path);this.It(t).has(n)||this.Et(n,t)||this.et(n,t,a5.newNoDocument(t,e))}r.Be&&(t.set(n,r.ke()),r.Ke())}});let r=oW();this.Je.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{let t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.je.forEach((t,r)=>r.setReadTime(e));let n=new lk(e,t,this.Ze,this.je,r);return this.je=oj,this.He=lP(),this.Je=lP(),this.Ze=new ah(iS),n}Ye(e,t){if(!this.rt(e))return;let r=2*!!this.Et(e,t.key);this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let n=this.nt(e);this.Et(e,t)?n.qe(t,1):n.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new lR,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new ap(iS),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new ap(iS),this.He=this.He.insert(e,t)),t}rt(e){let t=null!==this.ot(e);return t||is("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new lR),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function lP(){return new ah(iP.comparator)}function lL(){return new ah(iP.comparator)}let lM={asc:"ASCENDING",desc:"DESCENDING"},lF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lV={and:"AND",or:"OR"};class lU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function lB(e,t){return e.useProto3Json||sh(t)?t:{value:t}}function lj(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function lq(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function lz(e){let t;return ih(!!e,49232),iG.fromTimestamp(new i$((t=a_(e)).seconds,t.nanos))}function l$(e,t){return lG(e,t).canonicalString()}function lG(e,t){let r=new iD(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function lK(e){let t=iD.fromString(e);return ih(l7(t),10190,{key:t.toString()}),t}function lH(e,t){return l$(e.databaseId,t.path)}function lW(e,t){let r=lK(t);if(r.get(1)!==e.databaseId.projectId)throw new ip(id.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new ip(id.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new iP(lX(r))}function lQ(e,t){return l$(e.databaseId,t)}function lJ(e){let t=lK(e);return 4===t.length?iD.emptyPath():lX(t)}function lY(e){return new iD(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function lX(e){return ih(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function lZ(e,t,r){return{name:lH(e,t),fields:r.value.mapValue.fields}}function l0(e,t,r){let n=lW(e,t.name),i=lz(t.updateTime),s=t.createTime?lz(t.createTime):iG.min(),a=new a4({mapValue:{fields:t.fields}}),o=a5.newFoundDocument(n,i,s,a);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function l1(e,t){var r,n;let i;if(t instanceof la)i={update:lZ(e,t.key,t.value)};else if(t instanceof lh)i={delete:lH(e,t.key)};else if(t instanceof lo){let r;i={update:lZ(e,t.key,t.data),updateMask:(n=t.fieldMask,r=[],n.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r})}}else{if(!(t instanceof ld))return iu(16599,{dt:t.type});i={verify:lH(e,t.key)}}return t.fieldTransforms.length>0&&(i.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let r=t.transform;if(r instanceof o0)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof o1)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof o6)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof o4)return{fieldPath:t.field.canonicalString(),increment:r.Ae};throw iu(20930,{transform:t.transform})})(0,e))),t.precondition.isNone||(i.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:lj(e,r.updateTime.toTimestamp())}:void 0!==r.exists?{exists:r.exists}:iu(27497)),i}function l2(e,t){var r;let n=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?le.updateTime(lz(r.updateTime)):void 0!==r.exists?le.exists(r.exists):le.none():le.none(),i=t.updateTransforms?t.updateTransforms.map(t=>{let r;return r=null,"setToServerValue"in t?(ih("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new o0):"appendMissingElements"in t?r=new o1(t.appendMissingElements.values||[]):"removeAllFromArray"in t?r=new o6(t.removeAllFromArray.values||[]):"increment"in t?r=new o4(e,t.increment):iu(16584,{proto:t}),new o7(iO.fromServerFormat(t.fieldPath),r)}):[];if(t.update){t.update.name;let r=lW(e,t.update.name),s=new a4({mapValue:{fields:t.update.fields}});return t.updateMask?new lo(r,s,new ay((t.updateMask.fieldPaths||[]).map(e=>iO.fromServerFormat(e))),n,i):new la(r,s,n,i)}return t.delete?new lh(lW(e,t.delete),n):t.verify?new ld(lW(e,t.verify),n):iu(1463,{proto:t})}function l6(e,t){return{documents:[lQ(e,t.path)]}}function l3(e,t){var r,n;let i,s={structuredQuery:{}},a=t.path;null!==t.collectionGroup?(i=a,s.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=lQ(e,i);let o=function(e){if(0!==e.length)return function e(t){var r;let n;return t instanceof or?function(e){if("=="===e.op){if(aY(e.value))return{unaryFilter:{field:l5(e.field),op:"IS_NAN"}};if(aJ(e.value))return{unaryFilter:{field:l5(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(aY(e.value))return{unaryFilter:{field:l5(e.field),op:"IS_NOT_NAN"}};if(aJ(e.value))return{unaryFilter:{field:l5(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:l5(e.field),op:lF[e.op],value:e.value}}}(t):t instanceof on?1===(n=(r=t).getFilters().map(t=>e(t))).length?n[0]:{compositeFilter:{op:lV[r.op],filters:n}}:iu(54877,{filter:t})}(on.create(e,"and"))}(t.filters);o&&(s.structuredQuery.where=o);let l=function(e){if(0!==e.length)return e.map(e=>({field:l5(e.field),direction:lM[e.dir]}))}(t.orderBy);l&&(s.structuredQuery.orderBy=l);let u=lB(e,t.limit);return null!==u&&(s.structuredQuery.limit=u),t.startAt&&(s.structuredQuery.startAt={before:(r=t.startAt).inclusive,values:r.position}),t.endAt&&(s.structuredQuery.endAt={before:!(n=t.endAt).inclusive,values:n.position}),{ft:s,parent:i}}function l4(e){var t,r,n;let i,s,a,o,l=lJ(e.parent),u=e.structuredQuery,c=u.from?u.from.length:0,h=null;if(c>0){ih(1===c,65062);let e=u.from[0];e.allDescendants?h=e.collectionId:l=l.child(e.collectionId)}let d=[];u.where&&(d=(i=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=l8(e.unaryFilter.field);return or.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=l8(e.unaryFilter.field);return or.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=l8(e.unaryFilter.field);return or.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=l8(e.unaryFilter.field);return or.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return iu(61313);default:return iu(60726)}}(t):void 0!==t.fieldFilter?or.create(l8(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return iu(58110);default:return iu(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?on.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return iu(1026)}}(t.compositeFilter.op)):iu(30097,{filter:t})}(u.where))instanceof on&&oa(i)?i.getFilters():[i]);let f=[];u.orderBy&&(f=u.orderBy.map(e=>new oe(l8(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let p=null;u.limit&&(p=sh(s="object"==typeof(t=u.limit)?t.value:t)?null:s);let m=null;u.startAt&&(a=!!(r=u.startAt).before,m=new a8(r.values||[],a));let g=null;return u.endAt&&(o=!(n=u.endAt).before,g=new a8(n.values||[],o)),new oS(l,h,f,d,p,"F",m,g)}function l5(e){return{fieldPath:e.canonicalString()}}function l8(e){return iO.fromServerFormat(e.fieldPath)}function l7(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function l9(e){return!!e&&"function"==typeof e._toProto&&"ProtoValue"===e._protoValueType}class ue{constructor(e,t,r,n,i=iG.min(),s=iG.min(),a=aw.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new ue(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ue(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ue(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ue(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ut{constructor(e){this.yt=e}}function ur(e,t){let r=t.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:un(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument()){var i;n.document={name:lH(i=e.yt,t.key),fields:t.data.value.mapValue.fields,updateTime:lj(i,t.version.toTimestamp()),createTime:lj(i,t.createTime.toTimestamp())}}else if(t.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:ui(t.version)};else{if(!t.isUnknownDocument())return iu(57904,{document:t});n.unknownDocument={path:r.path.toArray(),version:ui(t.version)}}return n}function un(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ui(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function us(e){let t=new i$(e.seconds,e.nanoseconds);return iG.fromTimestamp(t)}function ua(e,t){let r=(t.baseMutations||[]).map(t=>l2(e.yt,t));for(let e=0;e<t.mutations.length-1;++e){let r=t.mutations[e];e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform&&(r.updateTransforms=t.mutations[e+1].transform.fieldTransforms,t.mutations.splice(e+1,1),++e)}let n=t.mutations.map(t=>l2(e.yt,t)),i=i$.fromMillis(t.localWriteTimeMs);return new lf(t.batchId,i,r,n)}function uo(e){var t;let r,n=us(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?us(e.lastLimboFreeSnapshotVersion):iG.min();return new ue(void 0!==e.query.documents?(ih(1===(r=(t=e.query).documents.length),1966,{count:r}),oN(oC(lJ(t.documents[0])))):oN(l4(e.query)),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,n,i,aw.fromBase64String(e.resumeToken))}function ul(e,t){let r,n=ui(t.snapshotVersion),i=ui(t.lastLimboFreeSnapshotVersion);r=o_(t.target)?l6(e.yt,t.target):l3(e.yt,t.target).ft;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:ow(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function uu(e){let t=l4({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?oO(t,t.limit,"L"):t}function uc(e,t){return new lm(t.largestBatchId,l2(e.yt,t.overlayMutation))}function uh(e,t){let r=t.path.lastSegment();return[e,sp(t.path.popLast()),r]}function ud(e,t,r,n){return{indexId:e,uid:t,sequenceNumber:r,readTime:ui(n.readTime),documentKey:sp(n.documentKey.path),largestBatchId:n.largestBatchId}}class uf{getBundleMetadata(e,t){return ao(e,sK).get(t).next(e=>{if(e)return{id:e.bundleId,createTime:us(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return ao(e,sK).put({bundleId:t.id,createTime:ui(lz(t.createTime)),version:t.version})}getNamedQuery(e,t){return ao(e,sH).get(t).next(e=>{if(e)return{name:e.name,query:uu(e.bundledQuery),readTime:us(e.readTime)}})}saveNamedQuery(e,t){return ao(e,sH).put({name:t.name,readTime:ui(lz(t.readTime)),bundledQuery:t.bundledQuery})}}class up{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){return new up(e,t.uid||"")}getOverlay(e,t){return ao(e,s3).get(uh(this.userId,t)).next(e=>e?uc(this.serializer,e):null)}getOverlays(e,t){let r=oG();return i4.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){let n=[];return r.forEach((r,i)=>{let s=new lm(t,i);n.push(this.bt(e,s))}),i4.waitFor(n)}removeOverlaysForBatchId(e,t,r){let n=new Set;t.forEach(e=>n.add(sp(e.getCollectionPath())));let i=[];return n.forEach(t=>{let n=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);i.push(ao(e,s3).X(s5,n))}),i4.waitFor(i)}getOverlaysForCollection(e,t,r){let n=oG(),i=sp(t),s=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,1/0],!0);return ao(e,s3).H(s5,s).next(e=>{for(let t of e){let e=uc(this.serializer,t);n.set(e.getKey(),e)}return n})}getOverlaysForCollectionGroup(e,t,r,n){let i,s=oG(),a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,1/0],!0);return ao(e,s3).ee({index:s7,range:a},(e,t,r)=>{let a=uc(this.serializer,t);s.size()<n||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):r.done()}).next(()=>s)}bt(e,t){return ao(e,s3).put(function(e,t,r){let[n,i,s]=uh(t,r.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:l1(e.yt,r.mutation)}}(this.serializer,this.userId,t))}}class um{St(e){return ao(e,ae)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{let t=e?.value;return t?aw.fromUint8Array(t):aw.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ug{Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(+!!e.booleanValue);else if("integerValue"in e)this.Ft(t,15),t.Mt(aI(e.integerValue));else if("doubleValue"in e){let r=aI(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),sd(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=a_(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(aE(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?a1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):aZ(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):iu(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};for(let e of(this.Ft(t,55),Object.keys(r)))this.Ot(e,t),this.Ct(r[e],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let n=r[aV].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(aI(n)),this.Ot(aV,t),this.Ct(r[aV],t)}qt(e,t){let r=e.values||[];for(let e of(this.Ft(t,50),r))this.Ct(e,t)}Lt(e,t){this.Ft(t,37),iP.fromName(e).path.forEach(e=>{this.Ft(t,60),this.$t(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}function uy(e){return Math.ceil((64-function(e){let t=0;for(let r=0;r<8;++r){let n=function(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}(255&e[r]);if(t+=n,8!==n)break}return t}(e))/8)}ug.Wt=new ug;class uv{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{let e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Xt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Ht(e);else if(e<2048)this.Ht(960|e>>>6),this.Ht(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e);else{let e=t.codePointAt(0);this.Ht(240|e>>>18),this.Ht(128|63&e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e)}}this.Jt()}Yt(e){let t=this.en(e),r=uy(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=255&t[e]}nn(e){let t=this.en(e),r=uy(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}rn(){this.sn(255),this.sn(255)}_n(){this.an(255),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t,r=((t=new DataView(new ArrayBuffer(8))).setFloat64(0,e,!1),new Uint8Array(t.buffer)),n=!!(128&r[0]);r[0]^=n?255:128;for(let e=1;e<r.length;++e)r[e]^=255*!!n;return r}Gt(e){let t=255&e;0===t?(this.sn(0),this.sn(255)):255===t?(this.sn(255),this.sn(0)):this.sn(t)}Ht(e){let t=255&e;0===t?(this.an(0),this.an(255)):255===t?(this.an(255),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let n=new Uint8Array(r);n.set(this.buffer),this.buffer=n}}class uw{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class ub{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class u_{constructor(){this.cn=new uv,this.ascending=new uw(this.cn),this.descending=new ub(this.cn)}seed(e){this.cn.seed(e)}ln(e){return 0===e?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class uI{constructor(e,t,r,n){this.hn=e,this.Pn=t,this.Tn=r,this.In=n}En(){let e=this.In.length,t=0===e||255===this.In[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new uI(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:uS(this.Tn),directionalValue:uS(this.In),orderedDocumentKey:uS(t),documentKey:r.path.toArray()}}An(e,t,r){let n=this.Rn(e,t,r);return[n.indexId,n.uid,n.arrayValue,n.directionalValue,n.orderedDocumentKey,n.documentKey]}}function uE(e,t){let r=e.hn-t.hn;return 0!==r||0!==(r=uT(e.Tn,t.Tn))||0!==(r=uT(e.In,t.In))?r:iP.comparator(e.Pn,t.Pn)}function uT(e,t){for(let r=0;r<e.length&&r<t.length;++r){let n=e[r]-t[r];if(0!==n)return n}return e.length-t.length}function uS(e){return K()?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):e}function uC(e){return"string"!=typeof e?e:function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)}class uk{constructor(e){for(const t of(this.Vn=new ap((e,t)=>iO.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[],e.filters))t.isInequality()?this.Vn=this.Vn.add(t):this.mn.push(t)}get fn(){return this.Vn.size>1}gn(e){if(ih(e.collectionGroup===this.collectionId,49279),this.fn)return!1;let t=iH(e);if(void 0!==t&&!this.pn(t))return!1;let r=iW(e),n=new Set,i=0,s=0;for(;i<r.length&&this.pn(r[i]);++i)n=n.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){let e=this.Vn.getIterator().getNext();if(!n.has(e.field.canonicalString())){let t=r[i];if(!this.yn(e,t)||!this.wn(this.dn[s++],t))return!1}++i}for(;i<r.length;++i){let e=r[i];if(s>=this.dn.length||!this.wn(this.dn[s++],e))return!1}return!0}bn(){if(this.fn)return null;let e=new ap(iO.comparator),t=[];for(let r of this.mn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new iJ(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new iJ(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new iJ(r.field,+("asc"!==r.dir))));return new iK(iK.UNKNOWN_ID,this.collectionId,t,iY.empty())}pn(e){for(let t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function ux(e){return e instanceof or}function uA(e){return e instanceof on&&oa(e)}function uN(e){return ux(e)||uA(e)||function(e){if(e instanceof on&&os(e)){for(let t of e.getFilters())if(!ux(t)&&!uA(t))return!1;return!0}return!1}(e)}function uD(e,t){return ih(e instanceof or||e instanceof on,38388),ih(t instanceof or||t instanceof on,25473),uO(e instanceof or?t instanceof or?on.create([e,t],"and"):uR(e,t):t instanceof or?uR(t,e):function(e,t){if(ih(e.filters.length>0&&t.filters.length>0,48005),oi(e)&&oi(t))return ol(e,t.getFilters());let r=os(e)?e:t,n=os(e)?t:e,i=r.filters.map(e=>uD(e,n));return on.create(i,"or")}(e,t))}function uR(e,t){if(oi(t))return ol(t,e.getFilters());{let r=t.filters.map(t=>uD(e,t));return on.create(r,"or")}}function uO(e){if(ih(e instanceof or||e instanceof on,11850),e instanceof or)return e;let t=e.getFilters();if(1===t.length)return uO(t[0]);if(oo(e))return e;let r=t.map(e=>uO(e)),n=[];return r.forEach(t=>{t instanceof or?n.push(t):t instanceof on&&(t.op===e.op?n.push(...t.filters):n.push(t))}),1===n.length?n[0]:on.create(n,e.op)}class uP{constructor(){this.Sn=new uL}addToCollectionParentIndex(e,t){return this.Sn.add(t),i4.resolve()}getCollectionParents(e,t){return i4.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return i4.resolve()}deleteFieldIndex(e,t){return i4.resolve()}deleteAllFieldIndexes(e){return i4.resolve()}createTargetIndexes(e,t){return i4.resolve()}getDocumentsMatchingTarget(e,t){return i4.resolve(null)}getIndexType(e,t){return i4.resolve(0)}getFieldIndexes(e,t){return i4.resolve([])}getNextCollectionGroupToUpdate(e){return i4.resolve(null)}getMinOffset(e,t){return i4.resolve(i0.min())}getMinOffsetFromCollectionGroup(e,t){return i4.resolve(i0.min())}updateCollectionGroup(e,t,r){return i4.resolve()}updateIndexEntries(e,t){return i4.resolve()}}class uL{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new ap(iD.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new ap(iD.comparator)).toArray()}}let uM="IndexedDbIndexManager",uF=new Uint8Array(0);class uV{constructor(e,t){this.databaseId=t,this.Dn=new uL,this.Cn=new oB(e=>ow(e),(e,t)=>ob(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){let r=t.lastSegment(),n=t.popLast();e.addOnCommittedListener(()=>{this.Dn.add(t)});let i={collectionId:r,parent:sp(n)};return ao(e,sz).put(i)}return i4.resolve()}getCollectionParents(e,t){let r=[],n=IDBKeyRange.bound([t,""],[t+"\0",""],!1,!0);return ao(e,sz).H(n).next(e=>{for(let n of e){if(n.collectionId!==t)break;r.push(sm(n.parent))}return r})}addFieldIndex(e,t){let r=ao(e,sW),n={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete n.indexId;let i=r.add(n);if(t.indexState){let r=ao(e,sJ);return i.next(e=>{r.put(ud(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let r=ao(e,sW),n=ao(e,sJ),i=ao(e,s0);return r.delete(t.indexId).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=ao(e,sW),r=ao(e,s0),n=ao(e,sJ);return t.X().next(()=>r.X()).next(()=>n.X())}createTargetIndexes(e,t){return i4.forEach(this.vn(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){let r=new uk(t).bn();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){let r=ao(e,s0),n=!0,i=new Map;return i4.forEach(this.vn(t),t=>this.Fn(e,t).next(e=>{n&&(n=!!e),i.set(t,e)})).next(()=>{if(n){let e=oW(),n=[];return i4.forEach(i,(i,s)=>{is(uM,`Using index id=${i.indexId}|cg=${i.collectionGroup}|f=${i.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${ow(t)}`);let a=function(e,t){let r=iH(t);if(void 0===r)return null;for(let t of oI(e,r.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),o=function(e,t){let r=new Map;for(let n of iW(t))for(let t of oI(e,n.fieldPath))switch(t.op){case"==":case"in":r.set(n.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(n.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}(s,i),l=function(e,t){let r=[],n=!0;for(let i of iW(t)){let t=0===i.kind?oE(e,i.fieldPath,e.startAt):oT(e,i.fieldPath,e.startAt);r.push(t.value),n&&(n=t.inclusive)}return new a8(r,n)}(s,i),u=function(e,t){let r=[],n=!0;for(let i of iW(t)){let t=0===i.kind?oT(e,i.fieldPath,e.endAt):oE(e,i.fieldPath,e.endAt);r.push(t.value),n&&(n=t.inclusive)}return new a8(r,n)}(s,i),c=this.Mn(i,s,l),h=this.Mn(i,s,u),d=this.xn(i,s,o),f=this.On(i.indexId,a,c,l.inclusive,h,u.inclusive,d);return i4.forEach(f,i=>r.Z(i,t.limit).next(t=>{t.forEach(t=>{let r=iP.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),n.push(r))})}))}).next(()=>n)}return i4.resolve(null)})}vn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let t=function e(t){if(ih(t instanceof or||t instanceof on,34018),t instanceof or)return t;if(1===t.filters.length)return e(t.filters[0]);let r=t.filters.map(t=>e(t)),n=on.create(r,t.op);return uN(n=uO(n))?n:(ih(n instanceof on,64498),ih(oi(n),40251),ih(n.filters.length>1,57927),n.filters.reduce((e,t)=>uD(e,t)))}(function e(t){if(ih(t instanceof or||t instanceof on,20012),t instanceof or){if(t instanceof op){let e=t.value.arrayValue?.values?.map(e=>or.create(t.field,"==",e))||[];return on.create(e,"or")}return t}let r=t.filters.map(t=>e(t));return on.create(r,t.op)}(e));return ih(uN(t),7391),ux(t)||uA(t)?[t]:t.getFilters()})(on.create(e.filters,"and")).map(t=>ov(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t)),t}On(e,t,r,n,i,s,a){let o=(null!=t?t.length:1)*Math.max(r.length,i.length),l=o/(null!=t?t.length:1),u=[];for(let c=0;c<o;++c){let o=t?this.Nn(t[c/l]):uF,h=this.Bn(e,o,r[c%l],n),d=this.Ln(e,o,i[c%l],s),f=a.map(t=>this.Bn(e,o,t,!0));u.push(...this.createRange(h,d,f))}return u}Bn(e,t,r,n){let i=new uI(e,iP.empty(),t,r);return n?i:i.En()}Ln(e,t,r,n){let i=new uI(e,iP.empty(),t,r);return n?i.En():i}Fn(e,t){let r=new uk(t),n=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,n).next(e=>{let t=null;for(let n of e)r.gn(n)&&(!t||n.fields.length>t.fields.length)&&(t=n);return t})}getIndexType(e,t){let r=2,n=this.vn(t);return i4.forEach(n,t=>this.Fn(e,t).next(e=>{e?0!==r&&e.fields.length<function(e){let t=new ap(iO.comparator),r=!1;for(let n of e.filters)for(let e of n.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(let r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+ +!!r}(t)&&(r=1):r=0})).next(()=>null!==t.limit&&n.length>1&&2===r?1:r)}kn(e,t){let r=new u_;for(let n of iW(e)){let e=t.data.field(n.fieldPath);if(null==e)return null;let i=r.ln(n.kind);ug.Wt.Dt(e,i)}return r.un()}Nn(e){let t=new u_;return ug.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){let r,n=new u_;return ug.Wt.Dt(aH(this.databaseId,t),n.ln(0===(r=iW(e)).length?0:r[r.length-1].kind)),n.un()}xn(e,t,r){if(null===r)return[];let n=[];n.push(new u_);let i=0;for(let s of iW(e)){let e=r[i++];for(let r of n)if(this.qn(t,s.fieldPath)&&aQ(e))n=this.Un(n,s,e);else{let t=r.ln(s.kind);ug.Wt.Dt(e,t)}}return this.$n(n)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){let n=[...e],i=[];for(let e of r.arrayValue.values||[])for(let r of n){let n=new u_;n.seed(r.un()),ug.Wt.Dt(e,n.ln(t.kind)),i.push(n)}return i}qn(e,t){return!!e.filters.find(e=>e instanceof or&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let r=ao(e,sW),n=ao(e,sJ);return(t?r.H(sQ,IDBKeyRange.bound(t,t)):r.H()).next(e=>{let t=[];return i4.forEach(e,e=>n.get([e.indexId,this.uid]).next(r=>{let n,i;t.push((n=r?new iY(r.sequenceNumber,new i0(us(r.readTime),new iP(sm(r.documentKey)),r.largestBatchId)):iY.empty(),i=e.fields.map(([e,t])=>new iJ(iO.fromServerFormat(e),t)),new iK(e.indexId,e.collectionGroup,i,n)))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:iS(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){let n=ao(e,sW),i=ao(e,sJ);return this.Wn(e).next(e=>n.H(sQ,IDBKeyRange.bound(t,t)).next(t=>i4.forEach(t,t=>i.put(ud(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){let r=new Map;return i4.forEach(t,(t,n)=>{let i=r.get(t.collectionGroup);return(i?i4.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(r.set(t.collectionGroup,i),i4.forEach(i,r=>this.Qn(e,t,r).next(t=>{let i=this.Gn(n,r);return t.isEqual(i)?i4.resolve():this.zn(e,n,r,t,i)}))))})}jn(e,t,r,n){return ao(e,s0).put(n.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,n){return ao(e,s0).delete(n.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){let n=ao(e,s0),i=new ap(uE);return n.ee({index:s2,range:IDBKeyRange.only([r.indexId,this.uid,uS(this.Kn(r,t))])},(e,n)=>{i=i.add(new uI(r.indexId,t,uC(n.arrayValue),uC(n.directionalValue)))}).next(()=>i)}Gn(e,t){let r=new ap(uE),n=this.kn(t,e);if(null==n)return r;let i=iH(t);if(null!=i){let s=e.data.field(i.fieldPath);if(aQ(s))for(let i of s.arrayValue.values||[])r=r.add(new uI(t.indexId,e.key,this.Nn(i),n))}else r=r.add(new uI(t.indexId,e.key,uF,n));return r}zn(e,t,r,n,i){is(uM,"Updating index entries for document '%s'",t.key);let s=[];return function(e,t,r,n,i){let s=e.getIterator(),a=t.getIterator(),o=ag(s),l=ag(a);for(;o||l;){let e=!1,t=!1;if(o&&l){let n=r(o,l);n<0?t=!0:n>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(n(l),l=ag(a)):t?(i(o),o=ag(s)):(o=ag(s),l=ag(a))}}(n,i,uE,n=>{s.push(this.jn(e,t,r,n))},n=>{s.push(this.Hn(e,t,r,n))}),i4.waitFor(s)}Wn(e){let t=1;return ao(e,sJ).ee({index:sX,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,n)=>{n.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>uE(e,t)).filter((e,t,r)=>!t||0!==uE(e,r[t-1]));let n=[];for(let i of(n.push(e),r)){let r=uE(i,e),s=uE(i,t);if(0===r)n[0]=e.En();else if(r>0&&s<0)n.push(i),n.push(i.En());else if(s>0)break}n.push(t);let i=[];for(let e=0;e<n.length;e+=2){if(this.Jn(n[e],n[e+1]))return[];let t=n[e].An(this.uid,uF,iP.empty()),r=n[e+1].An(this.uid,uF,iP.empty());i.push(IDBKeyRange.bound(t,r))}return i}Jn(e,t){return uE(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(uU)}getMinOffset(e,t){return i4.mapArray(this.vn(t),t=>this.Fn(e,t).next(e=>e||iu(44426))).next(uU)}}function uU(e){ih(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let n=1;n<e.length;n++){let i=e[n].indexState.offset;0>i1(i,t)&&(t=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new i0(t.readTime,t.documentKey,r)}let uB={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class uj{static withCacheSize(e){return new uj(e,uj.DEFAULT_COLLECTION_PERCENTILE,uj.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function uq(e,t,r){let n=e.store(sb),i=e.store(sS),s=[],a=IDBKeyRange.only(r.batchId),o=0,l=n.ee({range:a},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{ih(1===o,47070,{batchId:r.batchId})}));let u=[];for(let e of r.mutations){var c,h;let n=(c=e.key.path,h=r.batchId,[t,sp(c),h]);s.push(i.delete(n)),u.push(e.key)}return i4.waitFor(s).next(()=>u)}function uz(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw iu(14731);t=e.noDocument}return JSON.stringify(t).length}uj.DEFAULT_COLLECTION_PERCENTILE=10,uj.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uj.DEFAULT=new uj(0x2800000,uj.DEFAULT_COLLECTION_PERCENTILE,uj.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uj.DISABLED=new uj(-1,0,0);class u${constructor(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.Zn={}}static wt(e,t,r,n){return ih(""!==e.uid,64387),new u$(e.isAuthenticated()?e.uid:"",t,r,n)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return uK(e).ee({index:sI,range:r},(e,r,n)=>{t=!1,n.done()}).next(()=>t)}addMutationBatch(e,t,r,n){let i=ao(e,sS),s=uK(e);return s.add({}).next(a=>{var o,l,u,c;let h,d;ih("number"==typeof a,49019);let f=new lf(a,t,r,n),p=(o=this.serializer,l=this.userId,h=f.baseMutations.map(e=>l1(o.yt,e)),d=f.mutations.map(e=>l1(o.yt,e)),{userId:l,batchId:f.batchId,localWriteTimeMs:f.localWriteTime.toMillis(),baseMutations:h,mutations:d}),m=[],g=new ap((e,t)=>iS(e.canonicalString(),t.canonicalString()));for(let e of n){let t=(u=this.userId,c=e.key.path,[u,sp(c),a]);g=g.add(e.key.path.popLast()),m.push(s.put(p)),m.push(i.put(t,sT))}return g.forEach(t=>{m.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[a]=f.keys()}),i4.waitFor(m).next(()=>f)})}lookupMutationBatch(e,t){return uK(e).get(t).next(e=>e?(ih(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),ua(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?i4.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){let r=e.keys();return this.Zn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,n=IDBKeyRange.lowerBound([this.userId,r]),i=null;return uK(e).ee({index:sI,range:n},(e,t,n)=>{t.userId===this.userId&&(ih(t.batchId>=r,47524,{Yn:r}),i=ua(this.serializer,t)),n.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,1/0]),r=-1;return uK(e).ee({index:sI,range:t,reverse:!0},(e,t,n)=>{r=t.batchId,n.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,1/0]);return uK(e).H(sI,t).next(e=>e.map(e=>ua(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=[this.userId,sp(t.path)],n=IDBKeyRange.lowerBound(r),i=[];return ao(e,sS).ee({range:n},(r,n,s)=>{let[a,o,l]=r,u=sm(o);if(a===this.userId&&t.path.isEqual(u))return uK(e).get(l).next(e=>{if(!e)throw iu(61480,{er:r,batchId:l});ih(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(ua(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ap(iS),n=[];return t.forEach(t=>{let i=[this.userId,sp(t.path)],s=IDBKeyRange.lowerBound(i),a=ao(e,sS).ee({range:s},(e,n,i)=>{let[s,a,o]=e,l=sm(a);s===this.userId&&t.path.isEqual(l)?r=r.add(o):i.done()});n.push(a)}),i4.waitFor(n).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=[this.userId,sp(r)],s=IDBKeyRange.lowerBound(i),a=new ap(iS);return ao(e,sS).ee({range:s},(e,t,i)=>{let[s,o,l]=e,u=sm(o);s===this.userId&&r.isPrefixOf(u)?u.length===n&&(a=a.add(l)):i.done()}).next(()=>this.tr(e,a))}tr(e,t){let r=[],n=[];return t.forEach(t=>{n.push(uK(e).get(t).next(e=>{if(null===e)throw iu(35274,{batchId:t});ih(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(ua(this.serializer,e))}))}),i4.waitFor(n).next(()=>r)}removeMutationBatch(e,t){return uq(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.nr(t.batchId)}),i4.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return i4.resolve();let r=IDBKeyRange.lowerBound([this.userId]),n=[];return ao(e,sS).ee({range:r},(e,t,r)=>{if(e[0]===this.userId){let t=sm(e[1]);n.push(t)}else r.done()}).next(()=>{ih(0===n.length,56720,{rr:n.map(e=>e.canonicalString())})})})}containsKey(e,t){return uG(e,this.userId,t)}ir(e){return ao(e,sw).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function uG(e,t,r){let n=[t,sp(r.path)],i=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return ao(e,sS).ee({range:s,Y:!0},(e,r,n)=>{let[s,o,l]=e;s===t&&o===i&&(a=!0),n.done()}).next(()=>a)}function uK(e){return ao(e,sb)}class uH{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new uH(0)}static ar(){return new uH(-1)}}class uW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next(t=>{let r=new uH(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(e=>iG.fromTimestamp(new i$(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.ur(e).next(n=>(n.highestListenSequenceNumber=t,r&&(n.lastRemoteSnapshotVersion=r.toTimestamp()),t>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t),this.cr(e,n)))}addTargetData(e,t){return this.lr(e,t).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ao(e,sP).delete(t.targetId)).next(()=>this.ur(e)).next(t=>(ih(t.targetCount>0,8065),t.targetCount-=1,this.cr(e,t)))}removeTargets(e,t,r){let n=0,i=[];return ao(e,sP).ee((s,a)=>{let o=uo(a);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(n++,i.push(this.removeTargetData(e,o)))}).next(()=>i4.waitFor(i)).next(()=>n)}forEachTarget(e,t){return ao(e,sP).ee((e,r)=>{t(uo(r))})}ur(e){return ao(e,sq).get(sj).next(e=>(ih(null!==e,2888),e))}cr(e,t){return ao(e,sq).put(sj,t)}lr(e,t){return ao(e,sP).put(ul(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(e=>e.targetCount)}getTargetData(e,t){let r=ow(t),n=IDBKeyRange.bound([r,-1/0],[r,1/0]),i=null;return ao(e,sP).ee({range:n,index:sL},(e,r,n)=>{let s=uo(r);ob(t,s.target)&&(i=s,n.done())}).next(()=>i)}addMatchingKeys(e,t,r){let n=[],i=uQ(e);return t.forEach(t=>{let s=sp(t.path);n.push(i.put({targetId:r,path:s})),n.push(this.referenceDelegate.addReference(e,r,t))}),i4.waitFor(n)}removeMatchingKeys(e,t,r){let n=uQ(e);return i4.forEach(t,t=>{let i=sp(t.path);return i4.waitFor([n.delete([r,i]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){let r=uQ(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),n=uQ(e),i=oW();return n.ee({range:r,Y:!0},(e,t,r)=>{let n=new iP(sm(e[1]));i=i.add(n)}).next(()=>i)}containsKey(e,t){let r=sp(t.path),n=IDBKeyRange.bound([r],[r+"\0"],!1,!0),i=0;return uQ(e).ee({index:sU,Y:!0,range:n},([e,t],r,n)=>{0!==e&&(i++,n.done())}).next(()=>i>0)}At(e,t){return ao(e,sP).get(t).next(e=>e?uo(e):null)}}function uQ(e){return ao(e,sF)}let uJ="LruGarbageCollector";function uY([e,t],[r,n]){let i=iS(e,r);return 0===i?iS(t,n):i}class uX{constructor(e){this.Pr=e,this.buffer=new ap(uY),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>uY(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class uZ{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Ar(e){is(uJ,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){sr(e)?is(uJ,"Ignoring IndexedDB error during garbage collection: ",e):await i3(e)}await this.Ar(3e5)})}}class u0{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return i4.resolve(sc.ce);let r=new uX(t);return this.Vr.forEachTarget(e,e=>r.Er(e.sequenceNumber)).next(()=>this.Vr.mr(e,e=>r.Er(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(is("LruGarbageCollector","Garbage collection skipped; disabled"),i4.resolve(uB)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(is("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uB):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,n,i,s,o,l,u,c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(is("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,s=Date.now(),this.nthSequenceNumber(e,n))).next(n=>(r=n,o=Date.now(),this.removeTargets(e,r,t))).next(t=>(i=t,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(u=Date.now(),ii()<=a.DEBUG&&is("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-c}ms
	Determined least recently used ${n} in `+(o-s)+"ms\n"+`	Removed ${i} targets in `+(l-o)+"ms\n"+`	Removed ${e} documents in `+(u-l)+"ms\n"+`Total Duration: ${u-c}ms`),i4.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})))}}class u1{constructor(e,t){this.db=e,this.garbageCollector=new u0(this,t)}dr(e){let t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,(e,r)=>t(r))}addReference(e,t,r){return u2(e,r)}removeReference(e,t,r){return u2(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return u2(e,t)}wr(e,t){let r;return r=!1,ao(e,sw).te(n=>uG(e,n,t).next(e=>(e&&(r=!0),i4.resolve(!e)))).next(()=>r)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),n=[],i=0;return this.yr(e,(s,a)=>{if(a<=t){let t=this.wr(e,s).next(t=>{if(!t)return i++,r.getEntry(e,s).next(()=>(r.removeEntry(s,iG.min()),uQ(e).delete([0,sp(s.path)])))});n.push(t)}}).next(()=>i4.waitFor(n)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return u2(e,t)}yr(e,t){let r=uQ(e),n,i=sc.ce;return r.ee({index:sU},([e,r],{path:s,sequenceNumber:a})=>{0===e?(i!==sc.ce&&t(new iP(sm(n)),i),i=a,n=s):i=sc.ce}).next(()=>{i!==sc.ce&&t(new iP(sm(n)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function u2(e,t){var r;return uQ(e).put((r=e.currentSequenceNumber,{targetId:0,path:sp(t.path),sequenceNumber:r}))}class u6{constructor(){this.changes=new oB(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,a5.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?i4.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class u3{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ao(e,sC).put(r)}removeEntry(e,t,r){let n;return ao(e,sC).delete([(n=t.path.toArray()).slice(0,n.length-2),n[n.length-2],un(r),n[n.length-1]])}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=a5.newInvalidDocument(t);return ao(e,sC).ee({index:sx,range:IDBKeyRange.only(u5(t))},(e,n)=>{r=this.Sr(t,n)}).next(()=>r)}Dr(e,t){let r={size:0,document:a5.newInvalidDocument(t)};return ao(e,sC).ee({index:sx,range:IDBKeyRange.only(u5(t))},(e,n)=>{r={document:this.Sr(t,n),size:uz(n)}}).next(()=>r)}getEntries(e,t){let r=oj;return this.Cr(e,t,(e,t)=>{let n=this.Sr(e,t);r=r.insert(e,n)}).next(()=>r)}vr(e,t){let r=oj,n=new ah(iP.comparator);return this.Cr(e,t,(e,t)=>{let i=this.Sr(e,t);r=r.insert(e,i),n=n.insert(e,uz(t))}).next(()=>({documents:r,Fr:n}))}Cr(e,t,r){if(t.isEmpty())return i4.resolve();let n=new ap(u7);t.forEach(e=>n=n.add(e));let i=IDBKeyRange.bound(u5(n.first()),u5(n.last())),s=n.getIterator(),a=s.getNext();return ao(e,sC).ee({index:sx,range:i},(e,t,n)=>{let i=iP.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>u7(a,i);)r(a,null),a=s.getNext();a&&a.isEqual(i)&&(r(a,t),a=s.hasNext()?s.getNext():null),a?n.j(u5(a)):n.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,n,i){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),un(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ao(e,sC).H(IDBKeyRange.bound(a,o,!0)).next(e=>{i?.incrementDocumentReadCount(e.length);let r=oj;for(let i of e){let e=this.Sr(iP.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(oF(t,e)||n.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,n){let i=oj,s=u8(t,r),a=u8(t,i0.max());return ao(e,sC).ee({index:sN,range:IDBKeyRange.bound(s,a,!0)},(e,t,r)=>{let s=this.Sr(iP.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===n&&r.done()}).next(()=>i)}newChangeBuffer(e){return new u4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return ao(e,sR).get(sO).next(e=>(ih(!!e,20021),e))}br(e,t){return ao(e,sR).put(sO,t)}Sr(e,t){if(t){let e=function(e,t){var r;let n,i;if(t.document)n=l0(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=iP.fromSegments(t.noDocument.path),r=us(t.noDocument.readTime);n=a5.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return iu(56709);{let e=iP.fromSegments(t.unknownDocument.path),r=us(t.unknownDocument.version);n=a5.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime((i=new i$((r=t.readTime)[0],r[1]),iG.fromTimestamp(i))),n}(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(iG.min())))return e}return a5.newInvalidDocument(e)}}class u4 extends u6{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new oB(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],r=0,n=new ap((e,t)=>iS(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.Or.get(i);if(t.push(this.Mr.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=ur(this.Mr.serializer,s);n=n.add(i.path.popLast());let l=uz(o);r+=l-a.size,t.push(this.Mr.addEntry(e,i,o))}else if(r-=a.size,this.trackRemovals){let r=ur(this.Mr.serializer,s.convertToNoDocument(iG.min()));t.push(this.Mr.addEntry(e,i,r))}}),n.forEach(r=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.Mr.updateMetadata(e,r)),i4.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next(e=>(this.Or.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Mr.vr(e,t).next(({documents:e,Fr:t})=>(t.forEach((t,r)=>{this.Or.set(t,{size:r,readTime:e.get(t).readTime})}),e))}}function u5(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function u8(e,t){let r=t.documentKey.path.toArray();return[e,un(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function u7(e,t){let r=e.path.toArray(),n=t.path.toArray(),i=0;for(let e=0;e<r.length-2&&e<n.length-2;++e)if(i=iS(r[e],n[e]))return i;return(i=iS(r.length,n.length))||(i=iS(r[r.length-2],n[n.length-2]))||iS(r[r.length-1],n[n.length-1])}class u9{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ce{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&li(r.mutation,e,ay.empty(),i$.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,oW()).next(()=>t))}getLocalViewOfDocuments(e,t,r=oW()){let n=oG();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=oz();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=oG();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,oW()))}populateOverlays(e,t,r){let n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let i=oj,s=oG(),a=oG();return t.forEach((e,t)=>{let a=r.get(t.key);n.has(t.key)&&(void 0===a||a.mutation instanceof lo)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),li(a.mutation,t,a.mutation.getFieldMask(),i$.now())):s.set(t.key,ay.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>a.set(e,new u9(t,s.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){let r=oG(),n=new ah((e,t)=>e-t),i=oW();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||ay.empty();a=i.applyToLocalView(s,a),r.set(e,a);let o=(n.get(i.batchId)||oW()).add(e);n=n.insert(i.batchId,o)})}).next(()=>{let s=[],a=n.getReverseIterator();for(;a.hasNext();){let n=a.getNext(),o=n.key,l=n.value,u=oG();l.forEach(e=>{if(!i.has(e)){let n=ln(t.get(e),r.get(e));null!==n&&u.set(e,n),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,u))}return i4.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return iP.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):ox(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(i=>{let s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):i4.resolve(oG()),a=-1,o=i;return s.next(t=>i4.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(t)?i4.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,oW())).next(e=>({batchId:a,changes:o$(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new iP(t)).next(e=>{let t=oz();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){let i=t.collectionGroup,s=oz();return this.indexManager.getCollectionParents(e,i).next(a=>i4.forEach(a,a=>{let o=new oS(a.child(i),null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n))).next(e=>{i.forEach((t,r)=>{let n=r.getKey();null===e.get(n)&&(e=e.insert(n,a5.newInvalidDocument(n)))});let r=oz();return e.forEach((e,n)=>{let s=i.get(e);void 0!==s&&li(s.mutation,n,ay.empty(),i$.now()),oF(t,n)&&(r=r.insert(e,n))}),r})}}class ct{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return i4.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,{id:t.id,version:t.version,createTime:lz(t.createTime)}),i4.resolve()}getNamedQuery(e,t){return i4.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,{name:t.name,query:uu(t.bundledQuery),readTime:lz(t.readTime)}),i4.resolve()}}class cr{constructor(){this.overlays=new ah(iP.comparator),this.Lr=new Map}getOverlay(e,t){return i4.resolve(this.overlays.get(t))}getOverlays(e,t){let r=oG();return i4.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.bt(e,t,n)}),i4.resolve()}removeOverlaysForBatchId(e,t,r){let n=this.Lr.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Lr.delete(r)),i4.resolve()}getOverlaysForCollection(e,t,r){let n=oG(),i=t.length+1,s=new iP(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return i4.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new ah((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=oG(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=oG(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=n)););return i4.resolve(a)}bt(e,t,r){let n=this.overlays.get(r.key);if(null!==n){let e=this.Lr.get(n.largestBatchId).delete(r.key);this.Lr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new lm(t,r));let i=this.Lr.get(t);void 0===i&&(i=oW(),this.Lr.set(t,i)),this.Lr.set(t,i.add(r.key))}}class cn{constructor(){this.sessionToken=aw.EMPTY_BYTE_STRING}getSessionToken(e){return i4.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,i4.resolve()}}class ci{constructor(){this.kr=new ap(cs.Kr),this.qr=new ap(cs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new cs(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new cs(e,t))}Qr(e,t){e.forEach(e=>this.removeReference(e,t))}Gr(e){let t=new iP(new iD([])),r=new cs(t,e),n=new cs(t,e+1),i=[];return this.qr.forEachInRange([r,n],e=>{this.Wr(e),i.push(e.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new iP(new iD([])),r=new cs(t,e),n=new cs(t,e+1),i=oW();return this.qr.forEachInRange([r,n],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new cs(e,0),r=this.kr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class cs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return iP.comparator(e.key,t.key)||iS(e.Hr,t.Hr)}static Ur(e,t){return iS(e.Hr,t.Hr)||iP.comparator(e.key,t.key)}}class ca{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new ap(cs.Kr)}checkEmpty(e){return i4.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){let i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new lf(i,t,r,n);for(let t of(this.mutationQueue.push(s),n))this.Jr=this.Jr.add(new cs(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return i4.resolve(s)}lookupMutationBatch(e,t){return i4.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=this.Xr(t+1),n=r<0?0:r;return i4.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return i4.resolve(0===this.mutationQueue.length?-1:this.Yn-1)}getAllMutationBatches(e){return i4.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new cs(t,0),n=new cs(t,1/0),i=[];return this.Jr.forEachInRange([r,n],e=>{let t=this.Zr(e.Hr);i.push(t)}),i4.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ap(iS);return t.forEach(e=>{let t=new cs(e,0),n=new cs(e,1/0);this.Jr.forEachInRange([t,n],e=>{r=r.add(e.Hr)})}),i4.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;iP.isDocumentKey(i)||(i=i.child(""));let s=new cs(new iP(i),0),a=new ap(iS);return this.Jr.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.Hr)),!0)},s),i4.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(e=>{let r=this.Zr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){ih(0===this.ei(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Jr;return i4.forEach(t.mutations,n=>{let i=new cs(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new cs(t,0),n=this.Jr.firstAfterOrEqual(r);return i4.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,i4.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class co{constructor(e){this.ti=e,this.docs=new ah(iP.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return i4.resolve(r?r.document.mutableCopy():a5.newInvalidDocument(t))}getEntries(e,t){let r=oj;return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():a5.newInvalidDocument(e))}),i4.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=oj,s=t.path,a=new iP(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=i1(iZ(a),r)||(n.has(a.key)||oF(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return i4.resolve(i)}getAllFromCollectionGroup(e,t,r,n){iu(9500)}ni(e,t){return i4.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new cl(this)}getSize(e){return i4.resolve(this.size)}}class cl extends u6{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.Mr.addEntry(e,n)):this.Mr.removeEntry(r)}),i4.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class cu{constructor(e){this.persistence=e,this.ri=new oB(e=>ow(e),ob),this.lastRemoteSnapshotVersion=iG.min(),this.highestTargetId=0,this.ii=0,this.si=new ci,this.targetCount=0,this.oi=uH._r()}forEachTarget(e,t){return this.ri.forEach((e,r)=>t(r)),i4.resolve()}getLastRemoteSnapshotVersion(e){return i4.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return i4.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),i4.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),i4.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new uH(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,i4.resolve()}updateTargetData(e,t){return this.lr(t),i4.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,i4.resolve()}removeTargets(e,t,r){let n=0,i=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.ri.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)}),i4.waitFor(i).next(()=>n)}getTargetCount(e){return i4.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return i4.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),i4.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(t=>{i.push(n.markPotentiallyOrphaned(e,t))}),i4.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),i4.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return i4.resolve(r)}containsKey(e,t){return i4.resolve(this.si.containsKey(t))}}class cc{constructor(e,t){this._i={},this.overlays={},this.ai=new sc(0),this.ui=!1,this.ui=!0,this.ci=new cn,this.referenceDelegate=e(this),this.li=new cu(this),this.indexManager=new uP,this.remoteDocumentCache=new co(e=>this.referenceDelegate.hi(e)),this.serializer=new ut(t),this.Pi=new ct(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new cr,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new ca(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){is("MemoryPersistence","Starting transaction:",e);let n=new ch(this.ai.next());return this.referenceDelegate.Ti(),r(n).next(e=>this.referenceDelegate.Ii(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Ei(e,t){return i4.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}}class ch extends i6{constructor(e){super(),this.currentSequenceNumber=e}}class cd{constructor(e){this.persistence=e,this.Ri=new ci,this.Ai=null}static Vi(e){return new cd(e)}get di(){if(this.Ai)return this.Ai;throw iu(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),i4.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),i4.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),i4.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(e=>this.di.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.di.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return i4.forEach(this.di,r=>{let n=iP.fromPath(r);return this.mi(e,n).next(e=>{e||t.removeEntry(n,iG.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(e=>{e?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return i4.or([()=>i4.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class cf{constructor(e,t){this.persistence=e,this.fi=new oB(e=>sp(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=new u0(this,t)}static Vi(e,t){return new cf(e,t)}Ti(){}Ii(e){return i4.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}mr(e,t){return i4.forEach(this.fi,(r,n)=>this.wr(e,r,n).next(e=>e?i4.resolve():t(n)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.ni(e,n=>this.wr(e,n,t).next(e=>{e||(r++,i.removeEntry(n,iG.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),i4.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),i4.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),i4.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),i4.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=function e(t){switch(aB(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=aA(t);return r?16+e(r):16;case 5:return 2*t.stringValue.length;case 6:return aE(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(t.arrayValue.values||[]).reduce((t,r)=>t+e(r),0);case 10:case 11:var n;let i;return n=t.mapValue,i=0,au(n.fields,(t,r)=>{i+=t.length+e(r)}),i;default:throw iu(13486,{value:t})}}(e.data.value)),t}wr(e,t,r){return i4.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.fi.get(t);return i4.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class cp{constructor(e){this.serializer=e}k(e,t,r,n){let i=new i8("createOrUpgrade",t);r<1&&n>=1&&(e.createObjectStore(sy),e.createObjectStore(sw,{keyPath:"userId"}),e.createObjectStore(sb,{keyPath:s_,autoIncrement:!0}).createIndex(sI,sE,{unique:!0}),e.createObjectStore(sS),cm(e),e.createObjectStore(sg));let s=i4.resolve();return r<3&&n>=3&&(0!==r&&(e.deleteObjectStore(sF),e.deleteObjectStore(sP),e.deleteObjectStore(sq),cm(e)),s=s.next(()=>{let e,t;return e=i.store(sq),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:iG.min().toTimestamp(),targetCount:0},e.put(sj,t)})),r<4&&n>=4&&(0!==r&&(s=s.next(()=>i.store(sb).H().next(t=>{e.deleteObjectStore(sb),e.createObjectStore(sb,{keyPath:s_,autoIncrement:!0}).createIndex(sI,sE,{unique:!0});let r=i.store(sb),n=t.map(e=>r.put(e));return i4.waitFor(n)}))),s=s.next(()=>{e.createObjectStore(sG,{keyPath:"clientId"})})),r<5&&n>=5&&(s=s.next(()=>this.gi(i))),r<6&&n>=6&&(s=s.next(()=>(e.createObjectStore(sR),this.pi(i)))),r<7&&n>=7&&(s=s.next(()=>this.yi(i))),r<8&&n>=8&&(s=s.next(()=>this.wi(e,i))),r<9&&n>=9&&(s=s.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),r<10&&n>=10&&(s=s.next(()=>this.bi(i))),r<11&&n>=11&&(s=s.next(()=>{e.createObjectStore(sK,{keyPath:"bundleId"}),e.createObjectStore(sH,{keyPath:"name"})})),r<12&&n>=12&&(s=s.next(()=>{let t;(t=e.createObjectStore(s3,{keyPath:s4})).createIndex(s5,s8,{unique:!1}),t.createIndex(s7,s9,{unique:!1})})),r<13&&n>=13&&(s=s.next(()=>{let t;(t=e.createObjectStore(sC,{keyPath:sk})).createIndex(sx,sA),t.createIndex(sN,sD)}).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(sg))),r<14&&n>=14&&(s=s.next(()=>this.Di(e,i))),r<15&&n>=15&&(s=s.next(()=>{e.createObjectStore(sW,{keyPath:"indexId",autoIncrement:!0}).createIndex(sQ,"collectionGroup",{unique:!1}),e.createObjectStore(sJ,{keyPath:sY}).createIndex(sX,sZ,{unique:!1}),e.createObjectStore(s0,{keyPath:s1}).createIndex(s2,s6,{unique:!1})})),r<16&&n>=16&&(s=s.next(()=>{t.objectStore(sJ).clear()}).next(()=>{t.objectStore(s0).clear()})),r<17&&n>=17&&(s=s.next(()=>{e.createObjectStore(ae,{keyPath:"name"})})),r<18&&n>=18&&K()&&(s=s.next(()=>{t.objectStore(sJ).clear()}).next(()=>{t.objectStore(s0).clear()})),s}pi(e){let t=0;return e.store(sg).ee((e,r)=>{t+=uz(r)}).next(()=>{let r={byteSize:t};return e.store(sR).put(sO,r)})}gi(e){let t=e.store(sw),r=e.store(sb);return t.H().next(t=>i4.forEach(t,t=>{let n=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return r.H(sI,n).next(r=>i4.forEach(r,r=>{ih(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});let n=ua(this.serializer,r);return uq(e,t.userId,n).next(()=>{})}))}))}yi(e){let t=e.store(sF),r=e.store(sg);return e.store(sq).get(sj).next(e=>{let n=[];return r.ee((r,i)=>{let s=new iD(r),a=[0,sp(s)];n.push(t.get(a).next(r=>r?i4.resolve():t.put({targetId:0,path:sp(s),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>i4.waitFor(n))})}wi(e,t){e.createObjectStore(sz,{keyPath:s$});let r=t.store(sz),n=new uL,i=e=>{if(n.add(e)){let t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:sp(n)})}};return t.store(sg).ee({Y:!0},(e,t)=>i(new iD(e).popLast())).next(()=>t.store(sS).ee({Y:!0},([e,t,r],n)=>i(sm(t).popLast())))}bi(e){let t=e.store(sP);return t.ee((e,r)=>{let n=uo(r),i=ul(this.serializer,n);return t.put(i)})}Si(e,t){let r=t.store(sg),n=[];return r.ee((e,r)=>{let i=t.store(sC),s=(r.document?new iP(iD.fromString(r.document.name).popFirst(5)):r.noDocument?iP.fromSegments(r.noDocument.path):r.unknownDocument?iP.fromSegments(r.unknownDocument.path):iu(36783)).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};n.push(i.put(a))}).next(()=>i4.waitFor(n))}Di(e,t){let r=t.store(sb),n=new u3(this.serializer),i=new cc(cd.Vi,this.serializer.yt);return r.H().next(e=>{let r=new Map;return e.forEach(e=>{let t=r.get(e.userId)??oW();ua(this.serializer,e).keys().forEach(e=>t=t.add(e)),r.set(e.userId,t)}),i4.forEach(r,(e,r)=>{let s=new ie(r),a=up.wt(this.serializer,s),o=i.getIndexManager(s);return new ce(n,u$.wt(s,this.serializer,o,i.referenceDelegate),a,o).recalculateAndSaveOverlaysForDocumentKeys(new aa(t,sc.ce),e).next()})})}}function cm(e){e.createObjectStore(sF,{keyPath:sV}).createIndex(sU,sB,{unique:!0}),e.createObjectStore(sP,{keyPath:"targetId"}).createIndex(sL,sM,{unique:!0}),e.createObjectStore(sq)}let cg="IndexedDbPersistence",cy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class cv{constructor(e,t,r,n,i,s,a,o,l,u,c=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=i,this.window=s,this.document=a,this.Fi=l,this.Mi=u,this.xi=c,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=-1/0,this.ki=e=>Promise.resolve(),!cv.v())throw new ip(id.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new u1(this,n),this.Ki=t+"main",this.serializer=new ut(o),this.qi=new i7(this.Ki,this.xi,new cp(this.serializer)),this.ci=new um,this.li=new uW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new u3(this.serializer),this.Pi=new uf,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===u&&ia(cg,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ip(id.FAILED_PRECONDITION,cy);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new sc(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ao(e,sG).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(e=>{e||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Ji(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(sr(e))return is(cg,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return is(cg,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return ao(e,sy).get(sv).next(e=>i4.resolve(this.Xi(e)))}Yi(e){return ao(e,sG).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,18e5)){this.Li=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=ao(e,sG);return t.H().next(e=>{let r=this.ns(e,18e5),n=e.filter(e=>-1===r.indexOf(e));return i4.forEach(n,e=>t.delete(e.clientId)).next(()=>n)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?i4.resolve(!0):ao(e,sy).get(sv).next(t=>{if(null!==t&&this.ts(t.leaseTimestampMs,5e3)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new ip(id.FAILED_PRECONDITION,cy);return!1}}return!(!this.networkEnabled||!this.inForeground)||ao(e,sG).H().next(e=>void 0===this.ns(e,5e3).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,n=this.networkEnabled===e.networkEnabled;if(t||r&&n)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&is(cg,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[sy,sG],e=>{let t=new aa(e,sc.ce);return this.Ji(t).next(()=>this.Yi(t))}),this.qi.close(),this.ls()}ns(e,t){return e.filter(e=>this.ts(e.updateTimeMs,t)&&!this.ss(e.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>ao(e,sG).H().next(e=>this.ns(e,18e5).map(e=>e.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return u$.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new uV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return up.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){var n;let i;is(cg,"Starting transaction:",e);let s=18===(n=this.xi)||17===n?as:16===n||15===n?ai:14===n||13===n?an:12===n?ar:11===n?at:void iu(60245);return this.qi.runTransaction(e,"readonly"===t?"readonly":"readwrite",s,n=>(i=new aa(n,this.ai?this.ai.next():sc.ce),"readwrite-primary"===t?this.ji(i).next(e=>!!e||this.Hi(i)).next(t=>{if(!t)throw ia(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new ip(id.FAILED_PRECONDITION,i2);return r(i)}).next(e=>this.Zi(i).next(()=>e)):this.Ps(i).next(()=>r(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}Ps(e){return ao(e,sy).get(sv).next(e=>{if(null!==e&&this.ts(e.leaseTimestampMs,5e3)&&!this.ss(e.ownerId)&&!this.Xi(e)&&!(this.Mi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new ip(id.FAILED_PRECONDITION,cy)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ao(e,sy).put(sv,t)}static v(){return i7.v()}Ji(e){let t=ao(e,sy);return t.get(sv).next(e=>this.Xi(e)?(is(cg,"Releasing primary lease."),t.delete(sv)):i4.resolve())}ts(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ia(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){"function"==typeof this.window?.addEventListener&&(this.Oi=()=>{this._s();let e=/(?:Version|Mobile)\/1[456]/;G()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{let t=null!==this.Ui?.getItem(this.rs(e));return is(cg,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(e){return ia(cg,"Failed to get zombied client id.",e),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){ia("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch(e){}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function cw(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class cb{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=n}static Es(e,t){let r=oW(),n=oW();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new cb(e,t.fromCache,r,n)}}class c_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class cI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=G()?8:i9(q())>0?6:4}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,n){let i={result:null};return this.gs(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ps(e,t,n,r).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let r=new c_;return this.ys(e,t,r).next(n=>{if(i.result=n,this.As)return this.ws(e,t,r,n.size)})}).next(()=>i.result)}ws(e,t,r,n){return r.documentReadCount<this.Vs?(ii()<=a.DEBUG&&is("QueryEngine","SDK will not create cache indexes for query:",oM(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),i4.resolve()):(ii()<=a.DEBUG&&is("QueryEngine","Query:",oM(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ds*n?(ii()<=a.DEBUG&&is("QueryEngine","The SDK decides to create cache indexes for query:",oM(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,oN(t))):i4.resolve())}gs(e,t){if(ok(t))return i4.resolve(null);let r=oN(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(r=oN(t=oO(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{let i=oW(...n);return this.fs.getDocuments(e,i).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.bs(t,n);return this.Ss(t,s,i,r.readTime)?this.gs(e,oO(t,null,"F")):this.Ds(e,s,t,r)}))})))}ps(e,t,r,n){return ok(t)||n.isEqual(iG.min())?i4.resolve(null):this.fs.getDocuments(e,r).next(i=>{let s=this.bs(t,i);return this.Ss(t,s,r,n)?i4.resolve(null):(ii()<=a.DEBUG&&is("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),oM(t)),this.Ds(e,s,t,iX(n,-1)).next(e=>e))})}bs(e,t){let r=new ap(oU(e));return t.forEach((t,n)=>{oF(e,n)&&(r=r.add(n))}),r}Ss(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}ys(e,t,r){return ii()<=a.DEBUG&&is("QueryEngine","Using full collection scan to execute query:",oM(t)),this.fs.getDocumentsMatchingQuery(e,t,i0.min(),r)}Ds(e,t,r,n){return this.fs.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let cE="LocalStore";class cT{constructor(e,t,r,n){this.persistence=e,this.Cs=t,this.serializer=n,this.vs=new ah(iS),this.Fs=new oB(e=>ow(e),ob),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ce(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}}async function cS(e,t){return await e.persistence.runTransaction("Handle user change","readonly",r=>{let n;return e.mutationQueue.getAllMutationBatches(r).next(i=>(n=i,e.Os(t),e.mutationQueue.getAllMutationBatches(r))).next(t=>{let i=[],s=[],a=oW();for(let e of n)for(let t of(i.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return e.localDocuments.getDocuments(r,a).next(e=>({Ns:e,removedBatchIds:i,addedBatchIds:s}))})})}function cC(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function ck(e,t,r){let n=oW(),i=oW();return r.forEach(e=>n=n.add(e)),t.getEntries(e,n).next(e=>{let n=oj;return r.forEach((r,s)=>{let a=e.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(iG.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):is(cE,"Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)}),{Bs:n,Ls:i}})}function cx(e,t){return e.persistence.runTransaction("Allocate target","readwrite",r=>{let n;return e.li.getTargetData(r,t).next(i=>i?(n=i,i4.resolve(n)):e.li.allocateTargetId(r).next(i=>(n=new ue(t,i,"TargetPurposeListen",r.currentSequenceNumber),e.li.addTargetData(r,n).next(()=>n))))}).then(r=>{let n=e.vs.get(r.targetId);return(null===n||r.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(e.vs=e.vs.insert(r.targetId,r),e.Fs.set(t,r.targetId)),r})}async function cA(e,t,r){let n=e.vs.get(t);try{r||await e.persistence.runTransaction("Release target",r?"readwrite":"readwrite-primary",t=>e.persistence.referenceDelegate.removeTarget(t,n))}catch(e){if(!sr(e))throw e;is(cE,`Failed to update sequence numbers for target ${t}: ${e}`)}e.vs=e.vs.remove(t),e.Fs.delete(n.target)}function cN(e,t,r){let n=iG.min(),i=oW();return e.persistence.runTransaction("Execute query","readwrite",s=>{var a;let o;return(a=oN(t),void 0!==(o=e.Fs.get(a))?i4.resolve(e.vs.get(o)):e.li.getTargetData(s,a)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,e.li.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Cs.getDocumentsMatchingQuery(s,t,r?n:iG.min(),r?i:oW())).next(r=>(cO(e,oV(t),r),{documents:r,ks:i}))})}function cD(e,t){let r=e.li,n=e.vs.get(t);return n?Promise.resolve(n.target):e.persistence.runTransaction("Get target data","readonly",e=>r.At(e,t).next(e=>e?e.target:null))}function cR(e,t){let r=e.Ms.get(t)||iG.min();return e.persistence.runTransaction("Get new document changes","readonly",n=>e.xs.getAllFromCollectionGroup(n,t,iX(r,-1),Number.MAX_SAFE_INTEGER)).then(r=>(cO(e,t,r),r))}function cO(e,t,r){let n=e.Ms.get(t)||iG.min();r.forEach((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)}),e.Ms.set(t,n)}async function cP(e,t,r,n){let i=oW(),s=oj;for(let e of r){let r=t.Ks(e.metadata.name);e.document&&(i=i.add(r));let n=t.qs(e);n.setReadTime(t.Us(e.metadata.readTime)),s=s.insert(r,n)}let a=e.xs.newChangeBuffer({trackRemovals:!0}),o=await cx(e,oN(oC(iD.fromString(`__bundle__/docs/${n}`))));return e.persistence.runTransaction("Apply bundle documents","readwrite",t=>ck(t,a,s).next(e=>(a.apply(t),e)).next(r=>e.li.removeMatchingKeysForTargetId(t,o.targetId).next(()=>e.li.addMatchingKeys(t,i,o.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(t,r.Bs,r.Ls)).next(()=>r.Bs)))}async function cL(e,t,r=oW()){let n=await cx(e,oN(uu(t.bundledQuery)));return e.persistence.runTransaction("Save named query","readwrite",i=>{let s=lz(t.readTime);if(n.snapshotVersion.compareTo(s)>=0)return e.Pi.saveNamedQuery(i,t);let a=n.withResumeToken(aw.EMPTY_BYTE_STRING,s);return e.vs=e.vs.insert(a.targetId,a),e.li.updateTargetData(i,a).next(()=>e.li.removeMatchingKeysForTargetId(i,n.targetId)).next(()=>e.li.addMatchingKeys(i,r,n.targetId)).next(()=>e.Pi.saveNamedQuery(i,t))})}let cM="firestore_clients";function cF(e,t){return`${cM}_${e}_${t}`}let cV="firestore_mutations";function cU(e,t,r){let n=`${cV}_${e}_${r}`;return t.isAuthenticated()&&(n+=`_${t.uid}`),n}let cB="firestore_targets";function cj(e,t){return`${cB}_${e}_${t}`}let cq="SharedClientState";class cz{constructor(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n}static $s(e,t,r){let n=JSON.parse(r),i,s="object"==typeof n&&-1!==["pending","acknowledged","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new ip(n.error.code,n.error.message)),s?new cz(e,t,n.state,i):(ia(cq,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class c${constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){let r=JSON.parse(t),n,i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new ip(r.error.code,r.error.message)),i?new c$(e,r.state,n):(ia(cq,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class cG{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){let r=JSON.parse(t),n="object"==typeof r&&r.activeTargetIds instanceof Array,i=oQ;for(let e=0;n&&e<r.activeTargetIds.length;++e)n=sf(r.activeTargetIds[e]),i=i.add(r.activeTargetIds[e]);return n?new cG(e,i):(ia(cq,`Failed to parse client data for instance '${e}': ${t}`),null)}}class cK{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new cK(t.clientId,t.onlineState):(ia(cq,`Failed to parse online state: ${e}`),null)}}class cH{constructor(){this.activeTargetIds=oQ}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class cW{constructor(e,t,r,n,i){var s,a,o;this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new ah(iS),this.started=!1,this.Zs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=cF(this.persistenceKey,this.zs),this.Ys=(s=this.persistenceKey,`firestore_sequence_number_${s}`),this.Js=this.Js.insert(this.zs,new cH),this.eo=RegExp(`^${cM}_${l}_([^_]*)$`),this.no=RegExp(`^${cV}_${l}_(\\d+)(?:_(.*))?$`),this.ro=RegExp(`^${cB}_${l}_(\\d+)$`),this.io=(a=this.persistenceKey,`firestore_online_state_${a}`),this.so=(o=this.persistenceKey,`firestore_bundle_loaded_v2_${o}`),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){for(let e of(await this.syncEngine.hs())){if(e===this.zs)continue;let t=this.getItem(cF(this.persistenceKey,e));if(t){let r=cG.$s(e,t);r&&(this.Js=this.Js.insert(r.clientId,r))}}this.oo();let e=this.storage.getItem(this.io);if(e){let t=this._o(e);t&&this.ao(t)}for(let e of this.Zs)this.Hs(e);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach((r,n)=>{n.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let t=this.storage.getItem(cj(this.persistenceKey,e));if(t){let n=c$.$s(e,t);n&&(r=n.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cj(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.lo(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return is(cq,"READ",e,t),t}setItem(e,t){is(cq,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){is(cq,"REMOVE",e),this.storage.removeItem(e)}Hs(e){if(e.storageArea===this.storage){if(is(cq,"EVENT",e.key,e.newValue),e.key===this.Xs)return void ia("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(null!==e.key){if(this.eo.test(e.key)){if(null==e.newValue){let t=this.Eo(e.key);return this.Ro(t,null)}{let t=this.Ao(e.key,e.newValue);if(t)return this.Ro(t.clientId,t)}}else if(this.no.test(e.key)){if(null!==e.newValue){let t=this.Vo(e.key,e.newValue);if(t)return this.mo(t)}}else if(this.ro.test(e.key)){if(null!==e.newValue){let t=this.fo(e.key,e.newValue);if(t)return this.po(t)}}else if(e.key===this.io){if(null!==e.newValue){let t=this._o(e.newValue);if(t)return this.ao(t)}}else if(e.key===this.Ys){let t=function(e){let t=sc.ce;if(null!=e)try{let r=JSON.parse(e);ih("number"==typeof r,30636,{yo:e}),t=r}catch(e){ia(cq,"Failed to read sequence number from WebStorage",e)}return t}(e.newValue);t!==sc.ce&&this.sequenceNumberHandler(t)}else if(e.key===this.so){let t=this.wo(e.newValue);await Promise.all(t.map(e=>this.syncEngine.bo(e)))}}}else this.Zs.push(e)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){let n=new cz(this.currentUser,e,t,r),i=cU(this.persistenceKey,this.currentUser,e);this.setItem(i,n.Ws())}lo(e){let t=cU(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){let t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){let n=cj(this.persistenceKey,e),i=new c$(e,t,r);this.setItem(n,i.Ws())}Io(e){let t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){let t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){let r=this.Eo(e);return cG.$s(r,t)}Vo(e,t){let r=this.no.exec(e),n=Number(r[1]),i=void 0!==r[2]?r[2]:null;return cz.$s(new ie(i),n,t)}fo(e,t){let r=Number(this.ro.exec(e)[1]);return c$.$s(r,t)}_o(e){return cK.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);is(cq,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Js.insert(e,t):this.Js.remove(e),n=this.uo(this.Js),i=this.uo(r),s=[],a=[];return i.forEach(e=>{n.has(e)||s.push(e)}),n.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.Co(s,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=oQ;return e.forEach((e,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class cQ{constructor(){this.vo=new cH,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new cH,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class cJ{Mo(e){}shutdown(){}}let cY="ConnectivityMonitor";class cX{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){for(let e of(is(cY,"Network connectivity changed: AVAILABLE"),this.Lo))e(0)}Bo(){for(let e of(is(cY,"Network connectivity changed: UNAVAILABLE"),this.Lo))e(1)}static v(){return"u">typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let cZ=null;function c0(){return null===cZ?cZ=0x10000000+Math.round(0x80000000*Math.random()):cZ++,"0x"+cZ.toString(16)}let c1="RestConnection",c2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class c6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${n}`,this.$o=this.databaseId.database===aR?`project_id=${r}`:`project_id=${r}&database_id=${n}`}Wo(e,t,r,n,i){let s=c0(),a=this.Qo(e,t.toUriEncodedString());is(c1,`Sending RPC '${e}' ${s}:`,a,r);let o={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(o,n,i);let{host:l}=new URL(a),u=F(l);return this.zo(e,a,o,r,u).then(t=>(is(c1,`Received RPC '${e}' ${s}: `,t),t),t=>{throw io(c1,`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",r),t})}jo(e,t,r,n,i,s){return this.Wo(e,t,r,n,i)}Go(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+it,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}Qo(e,t){let r=c2[e],n=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(n=`${n}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),n}terminate(){}}class c3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}let c4="WebChannelConnection",c5=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};class c8 extends c6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){c8.c_||(c5(m(),p.STAT_EVENT,e=>{e.stat===f.PROXY?is(c4,"STAT_EVENT: detected buffering proxy"):e.stat===f.NOPROXY&&is(c4,"STAT_EVENT: detected no buffering proxy")}),c8.c_=!0)}zo(e,t,r,n,i){let s=c0();return new Promise((i,a)=>{let o=new u;o.setWithCredentials(!0),o.listenOnce(h.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case d.NO_ERROR:let t=o.getResponseJson();is(c4,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case d.TIMEOUT:is(c4,`RPC '${e}' ${s} timed out`),a(new ip(id.DEADLINE_EXCEEDED,"Request time out"));break;case d.HTTP_ERROR:let r=o.getStatus();if(is(c4,`RPC '${e}' ${s} failed with status:`,r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;if(t&&t.status&&t.message){let e,r=(e=t.status.toLowerCase().replace(/_/g,"-"),Object.values(id).indexOf(e)>=0?e:id.UNKNOWN);a(new ip(r,t.message))}else a(new ip(id.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new ip(id.UNAVAILABLE,"Connection failed."));break;default:iu(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{is(c4,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(n);is(c4,`RPC '${e}' ${s} sending request:`,n),o.send(t,"POST",l,r,15)})}T_(e,t,r){let n=c0(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},o=this.longPollingOptions.timeoutSeconds;void 0!==o&&(a.longPollingTimeout=Math.round(1e3*o)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;let l=i.join("");is(c4,`Creating RPC '${e}' stream ${n}: ${l}`,a);let u=s.createWebChannel(l,a);this.I_(u);let h=!1,d=!1,f=new c3({Ho:t=>{d?is(c4,`Not sending because RPC '${e}' stream ${n} is closed:`,t):(h||(is(c4,`Opening RPC '${e}' stream ${n} transport.`),u.open(),h=!0),is(c4,`RPC '${e}' stream ${n} sending:`,t),u.send(t))},Jo:()=>u.close()});return c5(u,c.EventType.OPEN,()=>{d||(is(c4,`RPC '${e}' stream ${n} transport opened.`),f.i_())}),c5(u,c.EventType.CLOSE,()=>{d||(d=!0,is(c4,`RPC '${e}' stream ${n} transport closed`),f.o_(),this.E_(u))}),c5(u,c.EventType.ERROR,t=>{d||(d=!0,io(c4,`RPC '${e}' stream ${n} transport errored. Name:`,t.name,"Message:",t.message),f.o_(new ip(id.UNAVAILABLE,"The operation could not be completed")))}),c5(u,c.EventType.MESSAGE,t=>{if(!d){let r=t.data[0];ih(!!r,16349);let i=r?.error||r[0]?.error;if(i){is(c4,`RPC '${e}' stream ${n} received error:`,i);let t=i.status,r=function(e){let t=y[e];if(void 0!==t)return lw(t)}(t),s=i.message;"NOT_FOUND"===t&&s.includes("database")&&s.includes("does not exist")&&s.includes(this.databaseId.database)&&io(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),void 0===r&&(r=id.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),d=!0,f.o_(new ip(r,s)),u.close()}else is(c4,`RPC '${e}' stream ${n} received:`,r),f.__(r)}}),c8.u_(),setTimeout(()=>{f.s_()},0),f}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return g()}}function c7(){return"u">typeof window?window:null}function c9(){return"u">typeof document?document:null}function he(e){return new lU(e,!0)}c8.c_=!1;class ht{constructor(e,t,r=1e3,n=1.5,i=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=n,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),n=Math.max(0,t-r);n>0&&is("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,n,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}let hr="PersistentStream";class hn{constructor(e,t,r,n,i,s,a,o){this.Ci=e,this.b_=r,this.S_=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ht(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===id.RESOURCE_EXHAUSTED?(ia(t.toString()),ia("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===id.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.D_===t&&this.G_(e,r)},t=>{e(()=>{let e=new ip(id.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(e=>{r(()=>this.z_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.F_?this.H_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return is(hr,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(is(hr,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hi extends hn{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=function(e,t){let r;if("targetChange"in t){var n,i;t.targetChange;let s="NO_CHANGE"===(n=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===n?1:"REMOVE"===n?2:"CURRENT"===n?3:"RESET"===n?4:iu(39313,{state:n}),a=t.targetChange.targetIds||[],o=(i=t.targetChange.resumeToken,e.useProto3Json?(ih(void 0===i||"string"==typeof i,58123),aw.fromBase64String(i||"")):(ih(void 0===i||i instanceof n4.Buffer||i instanceof Uint8Array,16193),aw.fromUint8Array(i||new Uint8Array))),l=t.targetChange.cause;r=new lD(s,a,o,l&&new ip(void 0===l.code?id.UNKNOWN:lw(l.code),l.message||"")||null)}else if("documentChange"in t){t.documentChange;let n=t.documentChange;n.document,n.document.name,n.document.updateTime;let i=lW(e,n.document.name),s=lz(n.document.updateTime),a=n.document.createTime?lz(n.document.createTime):iG.min(),o=new a4({mapValue:{fields:n.document.fields}}),l=a5.newFoundDocument(i,s,a,o);r=new lA(n.targetIds||[],n.removedTargetIds||[],l.key,l)}else if("documentDelete"in t){t.documentDelete;let n=t.documentDelete;n.document;let i=lW(e,n.document),s=n.readTime?lz(n.readTime):iG.min(),a=a5.newNoDocument(i,s);r=new lA([],n.removedTargetIds||[],a.key,a)}else if("documentRemove"in t){t.documentRemove;let n=t.documentRemove;n.document;let i=lW(e,n.document);r=new lA([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return iu(11601,{Vt:t});{t.filter;let e=t.filter;e.targetId;let{count:n=0,unchangedNames:i}=e,s=new ly(n,i);r=new lN(e.targetId,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return iG.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?iG.min():t.readTime?lz(t.readTime):iG.min()}(e);return this.listener.J_(t,r)}Z_(e){let t,r={};r.database=lY(this.serializer),r.addTarget=function(e,t){let r,n=t.target;if((r=o_(n)?{documents:l6(e,n)}:{query:l3(e,n).ft}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=lq(e,t.resumeToken);let n=lB(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(iG.min())>0){r.readTime=lj(e,t.snapshotVersion.toTimestamp());let n=lB(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);let n=(this.serializer,null==(t=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return iu(28987,{purpose:e})}}(e.purpose))?null:{"goog-listen-tags":t});n&&(r.labels=n),this.K_(r)}X_(e){let t={};t.database=lY(this.serializer),t.removeTarget=e,this.K_(t)}}class hs extends hn{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return ih(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ih(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){var t,r;ih(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let n=(t=e.writeResults,r=e.commitTime,t&&t.length>0?(ih(void 0!==r,14353),t.map(e=>{let t;return(t=e.updateTime?lz(e.updateTime):lz(r)).isEqual(iG.min())&&(t=lz(r)),new o9(t,e.transformResults||[])})):[]),i=lz(e.commitTime);return this.listener.na(i,n)}ra(){let e={};e.database=lY(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>l1(this.serializer,e))};this.K_(t)}}class ha{}class ho extends ha{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.ia=!1}sa(){if(this.ia)throw new ip(id.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Wo(e,lG(t,r),n,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===id.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ip(id.UNKNOWN,e.toString())})}jo(e,t,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,lG(t,r),n,s,a,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===id.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ip(id.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class hl{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ia(t),this.aa=!1):is("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}let hu="RemoteStore";class hc{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(e=>{r.enqueueAndForget(async()=>{hw(this)&&(is(hu,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await hd(e),e.Va.set("Unknown"),e.Ea.delete(4),await hh(e)}(this))})}),this.Va=new hl(r,n)}}async function hh(e){if(hw(e))for(let t of e.Ra)await t(!0)}async function hd(e){for(let t of e.Ra)await t(!1)}function hf(e,t){e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),hv(e)?hy(e):hL(e).O_()&&hm(e,t))}function hp(e,t){let r=hL(e);e.Ia.delete(t),r.O_()&&hg(e,t),0===e.Ia.size&&(r.O_()?r.L_():hw(e)&&e.Va.set("Unknown"))}function hm(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(iG.min())>0){let r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}hL(e).Z_(t)}function hg(e,t){e.da.$e(t),hL(e).X_(t)}function hy(e){e.da=new lO({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),hL(e).start(),e.Va.ua()}function hv(e){return hw(e)&&!hL(e).x_()&&e.Ia.size>0}function hw(e){return 0===e.Ea.size}async function hb(e){e.Va.set("Online")}async function h_(e){e.Ia.forEach((t,r)=>{hm(e,t)})}async function hI(e,t){e.da=void 0,hv(e)?(e.Va.ha(t),hy(e)):e.Va.set("Unknown")}async function hE(e,t,r){if(e.Va.set("Online"),t instanceof lD&&2===t.state&&t.cause)try{await async function(e,t){let r=t.cause;for(let n of t.targetIds)e.Ia.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.Ia.delete(n),e.da.removeTarget(n))}(e,t)}catch(r){is(hu,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await hT(e,r)}else if(t instanceof lA?e.da.Xe(t):t instanceof lN?e.da.st(t):e.da.tt(t),!r.isEqual(iG.min()))try{let t,n=await cC(e.localStore);r.compareTo(n)>=0&&await ((t=e.da.Tt(r)).targetChanges.forEach((t,n)=>{if(t.resumeToken.approximateByteSize()>0){let i=e.Ia.get(n);i&&e.Ia.set(n,i.withResumeToken(t.resumeToken,r))}}),t.targetMismatches.forEach((t,r)=>{let n=e.Ia.get(t);if(!n)return;e.Ia.set(t,n.withResumeToken(aw.EMPTY_BYTE_STRING,n.snapshotVersion)),hg(e,t);let i=new ue(n.target,t,r,n.sequenceNumber);hm(e,i)}),e.remoteSyncer.applyRemoteEvent(t))}catch(t){is(hu,"Failed to raise snapshot:",t),await hT(e,t)}}async function hT(e,t,r){if(!sr(t))throw t;e.Ea.add(1),await hd(e),e.Va.set("Offline"),r||(r=()=>cC(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{is(hu,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await hh(e)})}function hS(e,t){return t().catch(r=>hT(e,r,t))}async function hC(e){var t;let r=hM(e),n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;hw(t=e)&&t.Ta.length<10;)try{let t=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}(e.localStore,n);if(null===t){0===e.Ta.length&&r.L_();break}n=t.batchId,function(e,t){e.Ta.push(t);let r=hM(e);r.O_()&&r.Y_&&r.ea(t.mutations)}(e,t)}catch(t){await hT(e,t)}hk(e)&&hx(e)}function hk(e){return hw(e)&&!hM(e).x_()&&e.Ta.length>0}function hx(e){hM(e).start()}async function hA(e){hM(e).ra()}async function hN(e){let t=hM(e);for(let r of e.Ta)t.ea(r.mutations)}async function hD(e,t,r){let n=e.Ta.shift(),i=lp.from(n,t,r);await hS(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await hC(e)}async function hR(e,t){t&&hM(e).Y_&&await async function(e,t){var r;if(lv(r=t.code)&&r!==id.ABORTED){let r=e.Ta.shift();hM(e).B_(),await hS(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await hC(e)}}(e,t),hk(e)&&hx(e)}async function hO(e,t){e.asyncQueue.verifyOperationInProgress(),is(hu,"RemoteStore received new credentials");let r=hw(e);e.Ea.add(3),await hd(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await hh(e)}async function hP(e,t){t?(e.Ea.delete(2),await hh(e)):t||(e.Ea.add(2),await hd(e),e.Va.set("Unknown"))}function hL(e){var t,r,n;return e.ma||(t=e.datastore,r=e.asyncQueue,n={Zo:hb.bind(null,e),Yo:h_.bind(null,e),t_:hI.bind(null,e),J_:hE.bind(null,e)},t.sa(),e.ma=new hi(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.ma.B_(),hv(e)?hy(e):e.Va.set("Unknown")):(await e.ma.stop(),e.da=void 0)})),e.ma}function hM(e){var t,r,n;return e.fa||(t=e.datastore,r=e.asyncQueue,n={Zo:()=>Promise.resolve(),Yo:hA.bind(null,e),t_:hR.bind(null,e),ta:hN.bind(null,e),na:hD.bind(null,e)},t.sa(),e.fa=new hs(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.fa.B_(),await hC(e)):(await e.fa.stop(),e.Ta.length>0&&(is(hu,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class hF{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new im,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){let s=new hF(e,t,Date.now()+r,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ip(id.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hV(e,t){if(ia("AsyncQueue",`${t}: ${e}`),sr(e))return new ip(id.UNAVAILABLE,`${t}: ${e}`);throw e}class hU{static emptySet(e){return new hU(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||iP.comparator(t.key,r.key):(e,t)=>iP.comparator(e.key,t.key),this.keyedMap=oz(),this.sortedSet=new ah(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hU)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let r=new hU;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class hB{constructor(){this.ga=new ah(iP.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?0!==e.type&&3===r.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==r.type?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.ga=this.ga.remove(t):1===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):iu(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class hj{constructor(e,t,r,n,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new hj(e,t,hU.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oP(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class hq{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class hz{constructor(){this.queries=h$(),this.onlineState="Unknown",this.Ca=new Set}terminate(){var e;let t;e=new ip(id.ABORTED,"Firestore shutting down"),t=this.queries,this.queries=h$(),t.forEach((t,r)=>{for(let t of r.ba)t.onError(e)})}}function h$(){return new oB(e=>oL(e),oP)}async function hG(e,t){let r=3,n=t.query,i=e.queries.get(n);i?!i.Sa()&&t.Da()&&(r=2):(i=new hq,r=+!t.Da());try{switch(r){case 0:i.wa=await e.onListen(n,!0);break;case 1:i.wa=await e.onListen(n,!1);break;case 2:await e.onFirstRemoteStoreListen(n)}}catch(r){let e=hV(r,`Initialization of query '${oM(t.query)}' failed`);return void t.onError(e)}e.queries.set(n,i),i.ba.push(t),t.va(e.onlineState),i.wa&&t.Fa(i.wa)&&hQ(e)}async function hK(e,t){let r=t.query,n=3,i=e.queries.get(r);if(i){let e=i.ba.indexOf(t);e>=0&&(i.ba.splice(e,1),0===i.ba.length?n=+!t.Da():!i.Sa()&&t.Da()&&(n=2))}switch(n){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function hH(e,t){let r=!1;for(let n of t){let t=n.query,i=e.queries.get(t);if(i){for(let e of i.ba)e.Fa(n)&&(r=!0);i.wa=n}}r&&hQ(e)}function hW(e,t,r){let n=e.queries.get(t);if(n)for(let e of n.ba)e.onError(r);e.queries.delete(t)}function hQ(e){e.Ca.forEach(e=>{e.next()})}(b=w||(w={})).Ma="default",b.Cache="cache";class hJ{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let r of e.docChanges)3!==r.type&&t.push(r);e=new hj(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){return!(e.fromCache&&this.Da())||(!this.options.Ka||"Offline"===t)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=hj.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==w.Cache}}class hY{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class hX{constructor(e){this.serializer=e}Ks(e){return lW(this.serializer,e)}qs(e){return e.metadata.exists?l0(this.serializer,e.document,!1):a5.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return lz(e)}}class hZ{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=h0(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=iD.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){let t=new Map,r=new hX(this.serializer);for(let n of e)if(n.metadata.queries){let e=r.Ks(n.metadata.name);for(let r of n.metadata.queries){let n=(t.get(r)||oW()).add(e);t.set(r,n)}}return t}async ja(e){let t=await cP(e,new hX(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(let t of this.Wa)await cL(e,t,r.get(t.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function h0(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class h1{constructor(e){this.key=e}}class h2{constructor(e){this.key=e}}class h6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=oW(),this.mutatedKeys=oW(),this.eu=oU(e),this.tu=new hU(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new hB,n=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,s=n,a=!1,o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{let u=n.get(e),c=oF(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(r.track({type:3,doc:c}),f=!0):this.su(u,c)||(r.track({type:2,doc:c}),f=!0,(o&&this.eu(c,o)>0||l&&0>this.eu(c,l))&&(a=!0)):!u&&c?(r.track({type:0,doc:c}),f=!0):u&&!c&&(r.track({type:1,doc:u}),f=!0,(o||l)&&(a=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{tu:s,iu:r,Ss:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((e,t)=>{var r,n;let i;return r=e.type,n=t.type,(i=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return iu(20277,{Vt:e})}})(r)-i(n)||this.eu(e.doc,t.doc)}),this.ou(r),n=n??!1;let a=t&&!n?this._u():[],o=0===this.Ya.size&&this.current&&!n?1:0,l=o!==this.Xa;return(this.Xa=o,0!==s.length||l)?{snapshot:new hj(this.query,e.tu,i,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new hB,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Za=this.Za.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Za=this.Za.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=oW(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Ya=this.Ya.add(e.key))});let t=[];return e.forEach(e=>{this.Ya.has(e)||t.push(new h2(e))}),this.Ya.forEach(r=>{e.has(r)||t.push(new h1(r))}),t}cu(e){this.Za=e.ks,this.Ya=oW();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return hj.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Xa,this.hasCachedResults)}}let h3="SyncEngine";class h4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class h5{constructor(e){this.key=e,this.hu=!1}}class h8{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new oB(e=>oL(e),oP),this.Iu=new Map,this.Eu=new Set,this.Ru=new ah(iP.comparator),this.Au=new Map,this.Vu=new ci,this.du={},this.mu=new Map,this.fu=uH.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function h7(e,t,r=!0){let n,i=dA(e),s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.lu()):n=await de(i,t,r,!0),n}async function h9(e,t){let r=dA(e);await de(r,t,!0,!1)}async function de(e,t,r,n){let i,s=await cx(e.localStore,oN(t)),a=s.targetId,o=e.sharedClientState.addLocalQueryTarget(a,r);return n&&(i=await dt(e,t,a,"current"===o,s.resumeToken)),e.isPrimaryClient&&r&&hf(e.remoteStore,s),i}async function dt(e,t,r,n,i){e.pu=(t,r,n)=>(async function(e,t,r,n){let i=t.view.ru(r);i.Ss&&(i=await cN(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,i)));let s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return dm(e,t.targetId,o.au),o.snapshot})(e,t,r,n);let s=await cN(e.localStore,t,!0),a=new h6(t,s.ks),o=a.ru(s.documents),l=lx.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),u=a.applyChanges(o,e.isPrimaryClient,l);dm(e,r,u.au);let c=new h4(t,r,a);return e.Tu.set(t,c),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),u.snapshot}async function dr(e,t,r){let n=e.Tu.get(t),i=e.Iu.get(n.targetId);i.length>1?(e.Iu.set(n.targetId,i.filter(e=>!oP(e,t))),e.Tu.delete(t)):e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await cA(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),r&&hp(e.remoteStore,n.targetId),df(e,n.targetId)}).catch(i3)):(df(e,n.targetId),await cA(e.localStore,n.targetId,!0))}async function dn(e,t){let r=e.Tu.get(t),n=e.Iu.get(r.targetId);e.isPrimaryClient&&1===n.length&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),hp(e.remoteStore,r.targetId))}async function di(e,t,r){let n=dN(e);try{var i,s;let e,a,o,l,u,c=await (i=n.localStore,o=i$.now(),l=t.reduce((e,t)=>e.add(t.key),oW()),i.persistence.runTransaction("Locally write mutations","readwrite",r=>{let n=oj,s=oW();return i.xs.getEntries(r,l).next(e=>{(n=e).forEach((e,t)=>{t.isValidDocument()||(s=s.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(r,n)).next(n=>{e=n;let s=[];for(let r of t){let t=function(e,t){let r=null;for(let n of e.fieldTransforms){let e=t.data.field(n.field),i=oZ(n.transform,e||null);null!=i&&(null===r&&(r=a4.empty()),r.set(n.field,i))}return r||null}(r,e.get(r.key).overlayedDocument);null!=t&&s.push(new lo(r.key,t,function e(t){let r=[];return au(t.fields,(t,n)=>{let i=new iO([t]);if(aX(n)){let t=e(n.mapValue).fields;if(0===t.length)r.push(i);else for(let e of t)r.push(i.child(e))}else r.push(i)}),new ay(r)}(t.value.mapValue),le.exists(!0)))}return i.mutationQueue.addMutationBatch(r,o,s,t)}).next(t=>{a=t;let n=t.applyToLocalDocumentSet(e,s);return i.documentOverlayCache.saveOverlays(r,t.batchId,n)})}).then(()=>({batchId:a.batchId,changes:o$(e)})));n.sharedClientState.addPendingMutation(c.batchId),s=c.batchId,(u=n.du[n.currentUser.toKey()])||(u=new ah(iS)),u=u.insert(s,r),n.du[n.currentUser.toKey()]=u,await dy(n,c.changes),await hC(n.remoteStore)}catch(t){let e=hV(t,"Failed to persist write");r.reject(e)}}async function ds(e,t){var r;try{let n,i,s=await (r=e.localStore,n=t.snapshotVersion,i=r.vs,r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=r.xs.newChangeBuffer({trackRemovals:!0});i=r.vs;let a=[];t.targetChanges.forEach((s,o)=>{var l;let u=i.get(o);if(!u)return;a.push(r.li.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.li.addMatchingKeys(e,s.addedDocuments,o)));let c=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(aw.EMPTY_BYTE_STRING,iG.min()).withLastLimboFreeSnapshotVersion(iG.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,n)),i=i.insert(o,c),l=c,(0===u.resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&a.push(r.li.updateTargetData(e,c))});let o=oj,l=oW();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),a.push(ck(e,s,t.documentUpdates).next(e=>{o=e.Bs,l=e.Ls})),!n.isEqual(iG.min())){let t=r.li.getLastRemoteSnapshotVersion(e).next(t=>r.li.setTargetsMetadata(e,e.currentSequenceNumber,n));a.push(t)}return i4.waitFor(a).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.vs=i,e)));t.targetChanges.forEach((t,r)=>{let n=e.Au.get(r);n&&(ih(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?n.hu=!0:t.modifiedDocuments.size>0?ih(n.hu,14607):t.removedDocuments.size>0&&(ih(n.hu,42227),n.hu=!1))}),await dy(e,s,t)}catch(e){await i3(e)}}function da(e,t,r){var n;if(e.isPrimaryClient&&0===r||!e.isPrimaryClient&&1===r){let r,i=[];e.Tu.forEach((e,r)=>{let n=r.view.va(t);n.snapshot&&i.push(n.snapshot)}),(n=e.eventManager).onlineState=t,r=!1,n.queries.forEach((e,n)=>{for(let e of n.ba)e.va(t)&&(r=!0)}),r&&hQ(n),i.length&&e.Pu.J_(i),e.onlineState=t,e.isPrimaryClient&&e.sharedClientState.setOnlineState(t)}}async function dl(e,t,r){e.sharedClientState.updateQueryState(t,"rejected",r);let n=e.Au.get(t),i=n&&n.key;if(i){let r=new ah(iP.comparator);r=r.insert(i,a5.newNoDocument(i,iG.min()));let n=oW().add(i),s=new lk(iG.min(),new Map,new ah(iS),r,n);await ds(e,s),e.Ru=e.Ru.remove(i),e.Au.delete(t),dg(e)}else await cA(e.localStore,t,!1).then(()=>df(e,t,r)).catch(i3)}async function du(e,t){var r;let n=t.batch.batchId;try{let i=await (r=e.localStore,r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let n,i,s,a=t.batch.keys(),o=r.xs.newChangeBuffer({trackRemovals:!0});return(i=(n=t.batch).keys(),s=i4.resolve(),i.forEach(r=>{s=s.next(()=>o.getEntry(e,r)).next(e=>{let i=t.docVersions.get(r);ih(null!==i,48541),0>e.version.compareTo(i)&&(n.applyToRemoteDocument(e,t),e.isValidDocument()&&(e.setReadTime(t.commitVersion),o.addEntry(e)))})}),s.next(()=>r.mutationQueue.removeMutationBatch(e,n))).next(()=>o.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=oW();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,a))}));dd(e,n,null),dh(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await dy(e,i)}catch(e){await i3(e)}}async function dc(e,t,r){var n;try{let i=await (n=e.localStore,n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(ih(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))}));dd(e,t,r),dh(e,t),e.sharedClientState.updateMutationState(t,"rejected",r),await dy(e,i)}catch(e){await i3(e)}}function dh(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function dd(e,t,r){let n=e.du[e.currentUser.toKey()];if(n){let i=n.get(t);i&&(r?i.reject(r):i.resolve(),n=n.remove(t)),e.du[e.currentUser.toKey()]=n}}function df(e,t,r=null){for(let n of(e.sharedClientState.removeLocalQueryTarget(t),e.Iu.get(t)))e.Tu.delete(n),r&&e.Pu.yu(n,r);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach(t=>{e.Vu.containsKey(t)||dp(e,t)})}function dp(e,t){e.Eu.delete(t.path.canonicalString());let r=e.Ru.get(t);null!==r&&(hp(e.remoteStore,r),e.Ru=e.Ru.remove(t),e.Au.delete(r),dg(e))}function dm(e,t,r){for(let n of r)n instanceof h1?(e.Vu.addReference(n.key,t),function(e,t){let r=t.key,n=r.path.canonicalString();e.Ru.get(r)||e.Eu.has(n)||(is(h3,"New document in limbo: "+r),e.Eu.add(n),dg(e))}(e,n)):n instanceof h2?(is(h3,"Document no longer in limbo: "+n.key),e.Vu.removeReference(n.key,t),e.Vu.containsKey(n.key)||dp(e,n.key)):iu(19791,{wu:n})}function dg(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let r=new iP(iD.fromString(t)),n=e.fu.next();e.Au.set(n,new h5(r)),e.Ru=e.Ru.insert(r,n),hf(e.remoteStore,new ue(oN(oC(r.path)),n,"TargetPurposeLimboResolution",sc.ce))}}async function dy(e,t,r){let n=[],i=[],s=[];e.Tu.isEmpty()||(e.Tu.forEach((a,o)=>{s.push(e.pu(o,t,r).then(t=>{if((t||r)&&e.isPrimaryClient){let n=t?!t.fromCache:r?.targetChanges.get(o.targetId)?.current;e.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(t){n.push(t);let e=cb.Es(o.targetId,t);i.push(e)}}))}),await Promise.all(s),e.Pu.J_(n),await async function(e,t){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>i4.forEach(t,t=>i4.forEach(t.Ts,n=>e.persistence.referenceDelegate.addReference(r,t.targetId,n)).next(()=>i4.forEach(t.Is,n=>e.persistence.referenceDelegate.removeReference(r,t.targetId,n)))))}catch(e){if(!sr(e))throw e;is(cE,"Failed to update sequence numbers: "+e)}for(let r of t){let t=r.targetId;if(!r.fromCache){let r=e.vs.get(t),n=r.snapshotVersion,i=r.withLastLimboFreeSnapshotVersion(n);e.vs=e.vs.insert(t,i)}}}(e.localStore,i))}async function dv(e,t){if(!e.currentUser.isEqual(t)){is(h3,"User change. New user:",t.toKey());let r=await cS(e.localStore,t);e.currentUser=t,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new ip(id.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await dy(e,r.Ns)}}function dw(e,t){let r=e.Au.get(t);if(r&&r.hu)return oW().add(r.key);{let r=oW(),n=e.Iu.get(t);if(!n)return r;for(let t of n){let n=e.Tu.get(t);r=r.unionWith(n.view.nu)}return r}}async function db(e,t){let r=await cN(e.localStore,t.query,!0),n=t.view.cu(r);return e.isPrimaryClient&&dm(e,t.targetId,n.au),n}async function d_(e,t){return cR(e.localStore,t).then(t=>dy(e,t))}async function dI(e,t,r,n){var i,s;let a,o=await (i=e.localStore,a=i.mutationQueue,i.persistence.runTransaction("Lookup mutation documents","readonly",e=>a.Xn(e,t).next(t=>t?i.localDocuments.getDocuments(e,t):i4.resolve(null))));null!==o?("pending"===r?await hC(e.remoteStore):"acknowledged"===r||"rejected"===r?(dd(e,t,n||null),dh(e,t),s=e.localStore,s.mutationQueue.nr(t)):iu(6720,"Unknown batchState",{bu:r}),await dy(e,o)):is(h3,"Cannot apply mutation batch with id: "+t)}async function dE(e,t){if(dA(e),dN(e),!0===t&&!0!==e.gu){let t=e.sharedClientState.getAllActiveQueryTargets(),r=await dT(e,t.toArray());for(let t of(e.gu=!0,await hP(e.remoteStore,!0),r))hf(e.remoteStore,t)}else if(!1===t&&!1!==e.gu){let t=[],r=Promise.resolve();e.Iu.forEach((n,i)=>{e.sharedClientState.isLocalQueryTarget(i)?t.push(i):r=r.then(()=>(df(e,i),cA(e.localStore,i,!0))),hp(e.remoteStore,i)}),await r,await dT(e,t),e.Au.forEach((t,r)=>{hp(e.remoteStore,r)}),e.Vu.zr(),e.Au=new Map,e.Ru=new ah(iP.comparator),e.gu=!1,await hP(e.remoteStore,!1)}}async function dT(e,t,r){let n=[],i=[];for(let r of t){let t,s=e.Iu.get(r);if(s&&0!==s.length)for(let r of(t=await cx(e.localStore,oN(s[0])),s)){let t=e.Tu.get(r),n=await db(e,t);n.snapshot&&i.push(n.snapshot)}else{let n=await cD(e.localStore,r);t=await cx(e.localStore,n),await dt(e,dS(n),r,!1,t.resumeToken)}n.push(t)}return e.Pu.J_(i),n}function dS(e){var t,r,n,i,s;return t=e.path,r=e.collectionGroup,n=e.orderBy,i=e.filters,s=e.limit,new oS(t,r,n,i,s,"F",e.startAt,e.endAt)}function dC(e){return e.localStore.persistence.hs()}async function dk(e,t,r,n){if(e.gu)return void is(h3,"Ignoring unexpected query state notification.");let i=e.Iu.get(t);if(i&&i.length>0)switch(r){case"current":case"not-current":{let n=await cR(e.localStore,oV(i[0])),s=lk.createSynthesizedRemoteEventForCurrentChange(t,"current"===r,aw.EMPTY_BYTE_STRING);await dy(e,n,s);break}case"rejected":await cA(e.localStore,t,!0),df(e,t,n);break;default:iu(64155,r)}}async function dx(e,t,r){let n=dA(e);if(n.gu){for(let e of t){if(n.Iu.has(e)&&n.sharedClientState.isActiveQueryTarget(e)){is(h3,"Adding an already active target "+e);continue}let t=await cD(n.localStore,e),r=await cx(n.localStore,t);await dt(n,dS(t),r.targetId,!1,r.resumeToken),hf(n.remoteStore,r)}for(let e of r)n.Iu.has(e)&&await cA(n.localStore,e,!1).then(()=>{hp(n.remoteStore,e),df(n,e)}).catch(i3)}}function dA(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=ds.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dw.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dl.bind(null,e),e.Pu.J_=hH.bind(null,e.eventManager),e.Pu.yu=hW.bind(null,e.eventManager),e}function dN(e){return e.remoteStore.remoteSyncer.applySuccessfulWrite=du.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dc.bind(null,e),e}class dD{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=he(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){var t,r;return t=this.persistence,r=new cI,new cT(t,r,e.initialUser,this.serializer)}Cu(e){return new cc(cd.Vi,this.serializer)}Du(e){return new cQ}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}dD.provider={build:()=>new dD};class dR extends dD{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){return ih(this.persistence.referenceDelegate instanceof cf,46915),new uZ(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Cu(e){let t=void 0!==this.cacheSizeBytes?uj.withCacheSize(this.cacheSizeBytes):uj.DEFAULT;return new cc(e=>cf.Vi(e,t),this.serializer)}}class dO extends dD{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await dN(this.xu.syncEngine),await hC(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){var t,r;return t=this.persistence,r=new cI,new cT(t,r,e.initialUser,this.serializer)}Fu(e,t){return new uZ(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Mu(e,t){let r=new su(t,this.persistence);return new sl(e.asyncQueue,r)}Cu(e){let t=cw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?uj.withCacheSize(this.cacheSizeBytes):uj.DEFAULT;return new cv(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,c7(),c9(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new cQ}}class dP extends dO{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.xu.syncEngine;this.sharedClientState instanceof cW&&(this.sharedClientState.syncEngine={So:dI.bind(null,t),Do:dk.bind(null,t),Co:dx.bind(null,t),hs:dC.bind(null,t),bo:d_.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi(async e=>{await dE(this.xu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Du(e){let t=c7();if(!cW.v(t))throw new ip(id.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=cw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cW(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class dL{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>da(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=dv.bind(null,this.syncEngine),await hP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new hz}createDatastore(e){var t;let r=he(e.databaseInfo.databaseId),n=new c8(e.databaseInfo);return t=e.authCredentials,new ho(t,e.appCheckCredentials,n,r)}createRemoteStore(e){var t,r;return t=this.localStore,r=this.datastore,new hc(t,r,e.asyncQueue,e=>da(this.syncEngine,e,0),cX.v()?new cX:new cJ)}createSyncEngine(e,t){var r,n,i,s,a,o;let l;return r=this.localStore,n=this.remoteStore,i=this.eventManager,s=this.sharedClientState,a=e.initialUser,o=e.maxConcurrentLimboResolutions,l=new h8(r,n,i,s,a,o),t&&(l.gu=!0),l}async terminate(){await async function(e){is(hu,"RemoteStore shutting down."),e.Ea.add(5),await hd(e),e.Aa.shutdown(),e.Va.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}function dM(e,t=10240){let r=0;return{async read(){if(r<e.byteLength){let n={value:e.slice(r,r+t),done:!1};return r+=t,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}dL.provider={build:()=>new dL};class dF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ia("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class dV{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new im,this.buffer=new Uint8Array,this.Lu=new TextDecoder("utf-8"),this.ku().then(e=>{e&&e.Ua()?this.metadata.resolve(e.qa.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(e?.qa)}`))},e=>this.metadata.reject(e))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){let e=await this.Ku();if(null===e)return null;let t=this.Lu.decode(e),r=Number(t);return isNaN(r)&&this.qu(`length string (${t}) is not valid number`),new hY(JSON.parse(await this.Uu(r)),e.length+r)}$u(){return this.buffer.findIndex(e=>123===e)}async Ku(){for(;0>this.$u()&&!await this.Wu(););if(0===this.buffer.length)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");let t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),Error(`Invalid bundle format: ${e}`)}async Wu(){let e=await this.Bu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class dU{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Ua())throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do null!==(r=this.Su())&&this.elements.push(r);while(null!==r)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.Ku();return new hY(JSON.parse(this.Uu(e)),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new ip(id.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw Error("Reached the end of bundle when more is expected.")}}class dB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ip(id.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await async function(e,t){let r={documents:t.map(t=>lH(e.serializer,t))},n=await e.jo("BatchGetDocuments",e.serializer.databaseId,iD.emptyPath(),r,t.length),i=new Map;n.forEach(t=>{var r;let n,s,a,o,l,u,c=(r=e.serializer,"found"in t?(ih(!!t.found,43571),t.found.name,t.found.updateTime,n=lW(r,t.found.name),s=lz(t.found.updateTime),a=t.found.createTime?lz(t.found.createTime):iG.min(),o=new a4({mapValue:{fields:t.found.fields}}),a5.newFoundDocument(n,s,a,o)):"missing"in t?(ih(!!t.missing,3894),ih(!!t.readTime,22933),l=lW(r,t.missing),u=lz(t.readTime),a5.newNoDocument(l,u)):iu(7234,{result:t}));i.set(c.key.toString(),c)});let s=[];return t.forEach(e=>{let t=i.get(e.toString());ih(!!t,55234,{key:e}),s.push(t)}),s}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new lh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let r=iP.fromPath(t);this.mutations.push(new ld(r,this.precondition(r)))}),await async function(e,t){let r={writes:t.map(t=>l1(e.serializer,t))};await e.Wo("Commit",e.serializer.databaseId,iD.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw iu(50498,{Gu:e.constructor.name});t=iG.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ip(id.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(iG.min())?le.exists(!1):le.updateTime(t):le.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(iG.min()))throw new ip(id.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return le.updateTime(t)}return le.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class dj{constructor(e,t,r,n,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=n,this.deferred=i,this.zu=r.maxAttempts,this.M_=new ht(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_(async()=>{let e=new dB(this.datastore),t=this.Ju(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Zu(e)}))}).catch(e=>{this.Zu(e)})})}Ju(e){try{let t=this.updateFunction(e);return!sh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Hu(),Promise.resolve()))):this.deferred.reject(e)}Xu(e){if("FirebaseError"===e?.name){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!lv(t)}return!1}}let dq="FirestoreClient";class dz{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=n,this.user=ie.UNAUTHENTICATED,this.clientId=iT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{is(dq,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(is(dq,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new im;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=hV(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function d$(e,t){e.asyncQueue.verifyOperationInProgress(),is(dq,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await cS(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function dG(e,t){e.asyncQueue.verifyOperationInProgress();let r=await dK(e);is(dq,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>hO(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>hO(t.remoteStore,r)),e._onlineComponents=t}async function dK(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){is(dq,"Using user provided OfflineComponentProvider");try{await d$(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!("FirebaseError"===t.name?t.code===id.FAILED_PRECONDITION||t.code===id.UNIMPLEMENTED:!("u">typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw t;io("Error using user provided cache. Falling back to memory cache: "+t),await d$(e,new dD)}}else is(dq,"Using default OfflineComponentProvider"),await d$(e,new dR(void 0));return e._offlineComponents}async function dH(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(is(dq,"Using user provided OnlineComponentProvider"),await dG(e,e._uninitializedComponentsProvider._online)):(is(dq,"Using default OnlineComponentProvider"),await dG(e,new dL))),e._onlineComponents}function dW(e){return dK(e).then(e=>e.localStore)}function dQ(e){return dH(e).then(e=>e.syncEngine)}function dJ(e){return dH(e).then(e=>e.datastore)}async function dY(e){let t=await dH(e),r=t.eventManager;return r.onListen=h7.bind(null,t.syncEngine),r.onUnlisten=dr.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=h9.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=dn.bind(null,t.syncEngine),r}function dX(e,t,r={}){let n=new im;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await dY(e),s=e.asyncQueue,a=new dF({next:e=>{a.Nu(),s.enqueueAndForget(()=>hK(i,o));let l=e.docs.has(t);!l&&e.fromCache?n.reject(new ip(id.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&e.fromCache&&r&&"server"===r.source?n.reject(new ip(id.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(e)},error:e=>n.reject(e)}),hG(i,o=new hJ(oC(t.path),a,{includeMetadataChanges:!0,Ka:!0}))}),n.promise}function dZ(e,t,r={}){let n=new im;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await dY(e),s=e.asyncQueue,o=new hJ(t,a=new dF({next:e=>{a.Nu(),s.enqueueAndForget(()=>hK(i,o)),e.fromCache&&"server"===r.source?n.reject(new ip(id.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(e)},error:e=>n.reject(e)}),{includeMetadataChanges:!0,Ka:!0}),hG(i,o)}),n.promise}function d0(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let d1=new Map,d2="firestore.googleapis.com";class d6{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new ip(id.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=d2,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ip(id.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new ip(id.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=d0(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ip(id.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new ip(id.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new ip(id.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class d3{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new d6({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ip(id.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ip(id.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new d6(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new iy;switch(e.type){case"firstParty":return new i_(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ip(id.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=d1.get(this))&&(is("ComponentProvider","Removing Datastore"),d1.delete(this),e.terminate()),Promise.resolve()}}class d4{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new d4(this.firestore,e,this._query)}}class d5{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new d8(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new d5(this.firestore,e,this._key)}toJSON(){return{type:d5._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(iz(t,d5._jsonSchema))return new d5(e,r||null,new iP(iD.fromString(t.referencePath)))}}d5._jsonSchemaVersion="firestore/documentReference/1.0",d5._jsonSchema={type:iq("string",d5._jsonSchemaVersion),referencePath:iq("string")};class d8 extends d4{constructor(e,t,r){super(e,t,oC(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new d5(this.firestore,null,new iP(e))}withConverter(e){return new d8(this.firestore,e,this._path)}}function d7(e,t,...r){if(e=ei(e),iL("collection","path",t),e instanceof d3){let n=iD.fromString(t,...r);return iF(n),new d8(e,null,n)}{if(!(e instanceof d5||e instanceof d8))throw new ip(id.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(iD.fromString(t,...r));return iF(n),new d8(e.firestore,null,n)}}function d9(e,t,...r){if(e=ei(e),1==arguments.length&&(t=iT.newId()),iL("doc","path",t),e instanceof d3){let n=iD.fromString(t,...r);return iM(n),new d5(e,null,new iP(n))}{if(!(e instanceof d5||e instanceof d8))throw new ip(id.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(iD.fromString(t,...r));return iM(n),new d5(e.firestore,e instanceof d8?e.converter:null,new iP(n))}}function fe(e,t){return e=ei(e),t=ei(t),e instanceof d4&&t instanceof d4&&e.firestore===t.firestore&&oP(e._query,t._query)&&e.converter===t.converter}let ft="AsyncQueue";class fr{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ht(this,"async_queue_retry"),this._c=()=>{let e=c9();e&&is(ft,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=c9();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=c9();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new im;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(0!==this.Yu.length){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!sr(e))throw e;is(ft,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,ia("INTERNAL UNHANDLED ERROR: ",fn(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let n=hF.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(n),n}uc(){this.nc&&iu(47125,{Pc:fn(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let t of(this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.tc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}}function fn(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class fi{constructor(){this._progressObserver={},this._taskCompletionResolver=new im,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class fs extends d3{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new fr,this._persistenceKey=n?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new fr(e),this._firestoreClient=void 0,await e}}}function fa(e,t){let r=eU("object"==typeof e?e:eX(),"firestore").getImmediate({identifier:"string"==typeof e?e:t||aR});if(!r._initialized){let e=(e=>{let t=O(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]})("firestore");e&&function(e,t,r,n={}){e=iB(e,d3);let i=F(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;i&&(V(`https://${o}`),j("Firestore",!0)),s.host!==d2&&s.host!==o&&io("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:i,emulatorOptions:n};if(!Y(l,a)&&(e._setSettings(l),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=ie.MOCK_USER;else{t=function(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[A(JSON.stringify({alg:"none",type:"JWT"})),A(JSON.stringify(s)),""].join(".")}(n.mockUserToken,e._app?.options.projectId);let i=n.mockUserToken.sub||n.mockUserToken.user_id;if(!i)throw new ip(id.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new ie(i)}e._authCredentials=new iv(new ig(t,r))}}(r,...e)}return r}function fo(e){if(e._terminated)throw new ip(id.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||fl(e),e._firestoreClient}function fl(e){var t,r,n,i,s;let a,o=e._freezeSettings(),l=(t=e._databaseId,r=e._app?.options.appId||"",n=e._persistenceKey,i=e._app?.options.apiKey,new aD(t,r,n,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,d0(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i));e._componentsProvider||o.localCache?._offlineComponentProvider&&o.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),e._firestoreClient=new dz(e._authCredentials,e._appCheckCredentials,e._queue,l,e._componentsProvider&&(s=e._componentsProvider,a=s?._online.build(),{_offline:s?._offline.build(a),_online:a}))}function fu(e,t){io("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=e._freezeSettings();return function(e,t,r){if((e=iB(e,fs))._firestoreClient||e._terminated)throw new ip(id.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new ip(id.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:r},fl(e)}(e,dL.provider,{build:e=>new dO(e,r.cacheSizeBytes,t?.forceOwnership)}),Promise.resolve()}function fc(e,t){let r=fo(e=iB(e,fs)),n=new fi;return function(e,t,r,n){var i;let s=(i=he(t),new dV(function(e,t){if(e instanceof Uint8Array)return dM(e,void 0);if(e instanceof ArrayBuffer)return dM(new Uint8Array(e),void 0);if(e instanceof ReadableStream)return e.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof r?l_().encode(r):r),i));e.asyncQueue.enqueueAndForget(async()=>{var t;(async function(e,t,r){try{var n,i;let s,a=await t.getMetadata();if(await (n=e.localStore,s=lz(a.createTime),n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Pi.getBundleMetadata(e,a.id)).then(e=>!!e&&e.createTime.compareTo(s)>=0)))return await t.close(),r._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}),Promise.resolve(new Set);r._updateProgress(h0(a));let o=new hZ(a,t.serializer),l=await t.Su();for(;l;){let e=await o.Ga(l);e&&r._updateProgress(e),l=await t.Su()}let u=await o.ja(e.localStore);return await dy(e,u.Ja,void 0),await (i=e.localStore,i.persistence.runTransaction("Save bundle","readwrite",e=>i.Pi.saveBundleMetadata(e,a))),r._completeWith(u.progress),Promise.resolve(u.Ha)}catch(e){return io(h3,`Loading bundle failed with ${e}`),r._failWith(e),Promise.resolve(new Set)}})(t=await dQ(e),s,n).then(e=>{t.sharedClientState.notifyBundleLoaded(e)})})}(r,e._databaseId,t,n),n}class fh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fh(aw.fromBase64String(e))}catch(e){throw new ip(id.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new fh(aw.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:fh._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(iz(e,fh._jsonSchema))return fh.fromBase64String(e.bytes)}}fh._jsonSchemaVersion="firestore/bytes/1.0",fh._jsonSchema={type:iq("string",fh._jsonSchemaVersion),bytes:iq("string")};class fd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new ip(id.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new iO(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ff{constructor(e){this._methodName=e}}class fp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ip(id.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ip(id.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return iS(this._lat,e._lat)||iS(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:fp._jsonSchemaVersion}}static fromJSON(e){if(iz(e,fp._jsonSchema))return new fp(e.latitude,e.longitude)}}fp._jsonSchemaVersion="firestore/geoPoint/1.0",fp._jsonSchema={type:iq("string",fp._jsonSchemaVersion),latitude:iq("number"),longitude:iq("number")};class fm{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:fm._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(iz(e,fm._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new fm(e.vectorValues);throw new ip(id.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fm._jsonSchemaVersion="firestore/vectorValue/1.0",fm._jsonSchema={type:iq("string",fm._jsonSchemaVersion),vectorValues:iq("object")};let fg=/^__.*__$/;class fy{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new lo(e,this.data,this.fieldMask,t,this.fieldTransforms):new la(e,this.data,t,this.fieldTransforms)}}class fv{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new lo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fw(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw iu(40011,{dataSource:e})}}class fb{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new fb({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return fM(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(fw(this.dataSource)&&fg.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class f_{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||he(e)}createContext(e,t,r,n=!1){return new fb({dataSource:e,methodName:t,targetDoc:r,path:iO.emptyPath(),arrayElement:!1,hasConverter:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fI(e){let t=e._freezeSettings(),r=he(e._databaseId);return new f_(e._databaseId,!!t.ignoreUndefinedProperties,r)}function fE(e,t,r,n,i,s={}){let a,o,l=e.createContext(s.merge||s.mergeFields?2:0,t,r,i);fR("Data must be an object, but it was:",l,n);let u=fN(n,l);if(s.merge)a=new ay(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let n of s.mergeFields){let i=fO(t,n,r);if(!l.contains(i))throw new ip(id.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);fF(e,i)||e.push(i)}a=new ay(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new fy(new a4(u),a,o)}class fT extends ff{_toFieldTransform(e){if(2!==e.dataSource)throw 1===e.dataSource?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fT}}class fS extends ff{_toFieldTransform(e){return new o7(e.path,new o0)}isEqual(e){return e instanceof fS}}function fC(e,t,r,n){let i=e.createContext(1,t,r);fR("Data must be an object, but it was:",i,n);let s=[],a=a4.empty();return au(n,(e,n)=>{let o=fL(t,e,r);n=ei(n);let l=i.childContextForFieldPath(o);if(n instanceof fT)s.push(o);else{let e=fA(n,l);null!=e&&(s.push(o),a.set(o,e))}}),new fv(a,new ay(s),i.fieldTransforms)}function fk(e,t,r,n,i,s){let a=e.createContext(1,t,r),o=[fO(t,n,r)],l=[i];if(s.length%2!=0)throw new ip(id.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(fO(t,s[e])),l.push(s[e+1]);let u=[],c=a4.empty();for(let e=o.length-1;e>=0;--e)if(!fF(u,o[e])){let t=o[e],r=l[e];r=ei(r);let n=a.childContextForFieldPath(t);if(r instanceof fT)u.push(t);else{let e=fA(r,n);null!=e&&(u.push(t),c.set(t,e))}}return new fv(c,new ay(u),a.fieldTransforms)}function fx(e,t,r,n=!1){return fA(r,e.createContext(n?4:3,t))}function fA(e,t){if(fD(e=ei(e)))return fR("Unsupported field value:",t,e),fN(e,t);if(e instanceof ff)return function(e,t){if(!fw(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");let r=[],n=0;for(let i of e){let e=fA(i,t.childContextForArray(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}return function(e,t){var r,n,i;if(null===(e=ei(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return r=t.serializer,sf(n=e)?oY(n):oJ(r,n);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=i$.fromDate(e);return{timestampValue:lj(t.serializer,r)}}if(e instanceof i$){let r=new i$(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:lj(t.serializer,r)}}if(e instanceof fp)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof fh)return{bytesValue:lq(t.serializer,e._byteString)};if(e instanceof d5){let r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:l$(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof fm)return{mapValue:{fields:{[aP]:{stringValue:aF},[aV]:{arrayValue:{values:((i=e)instanceof fm?i.toArray():i).map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return oJ(t.serializer,e)})}}}}};if(l9(e))return e._toProto(t.serializer);throw t.createError(`Unsupported field value: ${iU(e)}`)}(e,t)}function fN(e,t){let r={};return ac(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):au(e,(e,n)=>{let i=fA(n,t.childContextForField(e));null!=i&&(r[e]=i)}),{mapValue:{fields:r}}}function fD(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof i$||e instanceof fp||e instanceof fh||e instanceof d5||e instanceof ff||e instanceof fm||l9(e))}function fR(e,t,r){if(!fD(r)||!iV(r)){let n=iU(r);throw"an object"===n?t.createError(e+" a custom object"):t.createError(e+" "+n)}}function fO(e,t,r){if((t=ei(t))instanceof fd)return t._internalPath;if("string"==typeof t)return fL(e,t);throw fM("Field path arguments must be of type string or ",e,!1,void 0,r)}let fP=RegExp("[~\\*/\\[\\]]");function fL(e,t,r){if(t.search(fP)>=0)throw fM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new fd(...t.split("."))._internalPath}catch(n){throw fM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function fM(e,t,r,n,i){let s=n&&!n.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new ip(id.INVALID_ARGUMENT,o+e+l)}function fF(e,t){return e.some(e=>e.isEqual(t))}class fV{convertValue(e,t="none"){switch(aB(e)){case 0:return null;case 1:return e.booleanValue;case 2:return aI(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(aE(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw iu(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return au(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){return new fm(e.fields?.[aV].arrayValue?.values?.map(e=>aI(e.doubleValue)))}convertGeoPoint(e){return new fp(aI(e.latitude),aI(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=aA(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(aN(e));default:return null}}convertTimestamp(e){let t=a_(e);return new i$(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=iD.fromString(e);ih(l7(r),9688,{name:e});let n=new aO(r.get(1),r.get(3)),i=new iP(r.popFirst(5));return n.isEqual(t)||ia(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class fU extends fV{constructor(e){super(),this.firestore=e}convertBytes(e){return new fh(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new d5(this.firestore,null,t)}}function fB(){return new fS("serverTimestamp")}let fj="@firebase/firestore",fq="4.11.0";function fz(e){if("object"!=typeof e||null===e)return!1;for(let t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}class f${constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class fG{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new a4({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class fK{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new d5(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new fH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(fO("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class fH extends fK{data(){return super.data()}}function fW(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ip(id.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fQ{}class fJ extends fQ{}function fY(e,t,...r){let n=[];for(let i of(t instanceof fQ&&n.push(t),function(e){let t=e.filter(e=>e instanceof f0).length,r=e.filter(e=>e instanceof fX).length;if(t>1||t>0&&r>0)throw new ip(id.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(r)),n))e=i._apply(e);return e}class fX extends fJ{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new fX(e,t,r)}_apply(e){let t=this._parse(e);return po(e._query,t),new d4(e.firestore,e.converter,oR(e._query,t))}_parse(e){let t=fI(e.firestore);return function(e,t,r,n,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new ip(id.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){pa(a,s);let t=[];for(let r of a)t.push(ps(n,e,r));o={arrayValue:{values:t}}}else o=ps(n,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||pa(a,s),o=fx(r,t,a,"in"===s||"not-in"===s);return or.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fZ(e,t,r){let n=fO("where",e);return fX._create(n,t,r)}class f0 extends fQ{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new f0(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:on.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;for(let e of t.getFlattenedFilters())po(r,e),r=oR(r,e)}(e._query,t),new d4(e.firestore,e.converter,oR(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function f1(...e){return e.forEach(e=>pl("or",e)),f0._create("or",e)}function f2(...e){return e.forEach(e=>pl("and",e)),f0._create("and",e)}class f6 extends fJ{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new f6(e,t)}_apply(e){var t;let r,n=function(e,t,r){if(null!==e.startAt)throw new ip(id.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ip(id.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new oe(t,r)}(e._query,this._field,this._direction);return new d4(e.firestore,e.converter,(t=e._query,r=t.explicitOrderBy.concat([n]),new oS(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}function f3(e,t="asc"){let r=fO("orderBy",e);return f6._create(r,t)}class f4 extends fJ{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new f4(e,t,r)}_apply(e){return new d4(e.firestore,e.converter,oO(e._query,this._limit,this._limitType))}}function f5(e){return ij("limit",e),f4._create("limit",e,"F")}function f8(e){return ij("limitToLast",e),f4._create("limitToLast",e,"L")}class f7 extends fJ{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new f7(e,t,r)}_apply(e){var t;let r=pi(e,this.type,this._docOrFields,this._inclusive);return new d4(e.firestore,e.converter,(t=e._query,new oS(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,r,t.endAt)))}}function f9(...e){return f7._create("startAt",e,!0)}function pe(...e){return f7._create("startAfter",e,!1)}class pt extends fJ{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new pt(e,t,r)}_apply(e){var t;let r=pi(e,this.type,this._docOrFields,this._inclusive);return new d4(e.firestore,e.converter,(t=e._query,new oS(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,r)))}}function pr(...e){return pt._create("endBefore",e,!1)}function pn(...e){return pt._create("endAt",e,!0)}function pi(e,t,r,n){if(r[0]=ei(r[0]),r[0]instanceof fK)return function(e,t,r,n,i){if(!n)throw new ip(id.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${r}().`);let s=[];for(let r of oA(e))if(r.field.isKeyField())s.push(aH(t,n.key));else{let e=n.data.field(r.field);if(ax(e))throw new ip(id.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+r.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=r.field.canonicalString();throw new ip(id.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new a8(s,i)}(e._query,e.firestore._databaseId,t,r[0]._document,n);{let i=fI(e.firestore);return function(e,t,r,n,i,s){let a=e.explicitOrderBy;if(i.length>a.length)throw new ip(id.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let s=0;s<i.length;s++){let l=i[s];if(a[s].field.isKeyField()){if("string"!=typeof l)throw new ip(id.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof l}`);if(!ox(e)&&-1!==l.indexOf("/"))throw new ip(id.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${l}' contains a slash.`);let r=e.path.child(iD.fromString(l));if(!iP.isDocumentKey(r))throw new ip(id.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${r}' is not because it contains an odd number of segments.`);let i=new iP(r);o.push(aH(t,i))}else{let e=fx(r,n,l);o.push(e)}}return new a8(o,s)}(e._query,e.firestore._databaseId,i,t,r,n)}}function ps(e,t,r){if("string"==typeof(r=ei(r))){if(""===r)throw new ip(id.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ox(t)&&-1!==r.indexOf("/"))throw new ip(id.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let n=t.path.child(iD.fromString(r));if(!iP.isDocumentKey(n))throw new ip(id.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return aH(e,new iP(n))}if(r instanceof d5)return aH(e,r._key);throw new ip(id.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${iU(r)}.`)}function pa(e,t){if(!Array.isArray(e)||0===e.length)throw new ip(id.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function po(e,t){let r=function(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new ip(id.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ip(id.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}function pl(e,t){if(!(t instanceof fX||t instanceof f0))throw new ip(id.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function pu(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class pc extends fV{constructor(e){super(),this.firestore=e}convertBytes(e){return new fh(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new d5(this.firestore,null,t)}}function ph(e){return new f$("sum",fO("sum",e))}function pd(e){return new f$("avg",fO("average",e))}function pf(){return new f$("count")}function pp(e,t){return e instanceof f$&&t instanceof f$&&e.aggregateType===t.aggregateType&&e._internalFieldPath?.canonicalString()===t._internalFieldPath?.canonicalString()}function pm(e,t){return fe(e.query,t.query)&&Y(e.data(),t.data())}function pg(e){return py(e,{count:pf()})}function py(e,t){var r;let n,i=iB(e.firestore,fs),s=fo(i),a=function(e,t){let r=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.push(t(e[n],n,e));return r}(t,(e,t)=>new lg(t,e.aggregateType,e._internalFieldPath));return(r=e._query,n=new im,s.asyncQueue.enqueueAndForget(async()=>{try{let e=await dJ(s);n.resolve(async function(e,t,r){let{request:n,gt:i,parent:s}=function(e,t,r,n){let{ft:i,parent:s}=l3(e,t),a={},o=[],l=0;return r.forEach(e=>{let t="aggregate_"+l++;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:l5(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:l5(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},gt:a,parent:s}}(e.serializer,(t.Re||(t.Re=oD(t,t.explicitOrderBy)),t.Re),r);e.connection.Ko||delete n.parent;let a=(await e.jo("RunAggregationQuery",e.serializer.databaseId,s,n,1)).filter(e=>!!e.result);ih(1===a.length,64727);let o=a[0].result?.aggregateFields;return Object.keys(o).reduce((e,t)=>(e[i[t]]=o[t],e),{})}(e,r,a))}catch(e){n.reject(e)}}),n.promise).then(t=>new fG(e,new fU(i),t))}class pv{constructor(e){this.kind="memory",this._onlineComponentProvider=dL.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new dR(void 0)}}toJSON(){return{kind:this.kind}}}class pw{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=px(void 0))._initialize(e),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class pb{constructor(){this.kind="memoryEager",this._offlineComponentProvider=dD.provider}toJSON(){return{kind:this.kind}}}class p_{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new dR(e)}}toJSON(){return{kind:this.kind}}}function pI(){return new pb}function pE(e){return new p_(e?.cacheSizeBytes)}function pT(e){return new pv(e)}function pS(e){return new pw(e)}class pC{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=dL.provider,this._offlineComponentProvider={build:t=>new dO(t,e?.cacheSizeBytes,this.forceOwnership)}}}class pk{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=dL.provider,this._offlineComponentProvider={build:t=>new dP(t,e?.cacheSizeBytes)}}}function px(e){return new pC(e?.forceOwnership)}function pA(){return new pk}let pN="NOT SUPPORTED";class pD{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pR extends fK{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new pP(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(fO("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ip(id.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=pR._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),this._firestore,this.ref.path,t.bundle="NOT SUPPORTED"),t}}function pO(e,t,r){if(iz(t,pR._jsonSchema)){var n;if(t.bundle===pN)throw new ip(id.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let i=he(e._databaseId),s=(n=t.bundle,new dU(n,i)),a=s.t(),o=new hZ(s.getMetadata(),i);for(let e of a)o.o(e);let l=o.documents;if(1!==l.length)throw new ip(id.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${l.length} documents.`);let u=l0(i,l[0].document),c=new iP(iD.fromString(t.bundleName));return new pR(e,new pc(e),c,u,new pD(!1,!1),r||null)}}pR._jsonSchemaVersion="firestore/documentSnapshot/1.0",pR._jsonSchema={type:iq("string",pR._jsonSchemaVersion),bundleSource:iq("string","DocumentSnapshot"),bundleName:iq("string"),bundle:iq("string")};class pP extends pR{data(e={}){return super.data(e)}}class pL{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new pD(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new pP(this._firestore,this._userDataWriter,r.key,r,new pD(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ip(id.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let n=new pP(e._firestore,e._userDataWriter,r.doc.key,r.doc,new pD(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new pP(e._firestore,e._userDataWriter,t.doc.key,t.doc,new pD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return iu(61501,{type:e})}}(t.type),doc:n,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ip(id.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=pL._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iT.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],n=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),n.push(e.ref.path))}),this._firestore,this.query._query,e.bundleName,e.bundle="NOT SUPPORTED",e}}function pM(e,t,r){if(iz(t,pL._jsonSchema)){var n;if(t.bundle===pN)throw new ip(id.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let i=he(e._databaseId),s=(n=t.bundle,new dU(n,i)),a=s.t(),o=new hZ(s.getMetadata(),i);for(let e of a)o.o(e);if(1!==o.queries.length)throw new ip(id.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);let l=uu(o.queries[0].bundledQuery),u=o.documents,c=new hU;u.map(e=>{let t=l0(i,e.document);c=c.add(t)});let h=hj.fromInitialDocuments(l,c,oW(),!1,!1),d=new d4(e,r||null,l);return new pL(e,new pc(e),d,h)}}function pF(e,t){return e instanceof pR&&t instanceof pR?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof pL&&t instanceof pL&&e._firestore===t._firestore&&fe(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}pL._jsonSchemaVersion="firestore/querySnapshot/1.0",pL._jsonSchema={type:iq("string",pL._jsonSchemaVersion),bundleSource:iq("string","QuerySnapshot"),bundleName:iq("string"),bundle:iq("string")};let pV={maxAttempts:5};class pU{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=fI(e)}set(e,t,r){this._verifyNotCommitted();let n=pB(e,this._firestore),i=pu(n.converter,t,r),s=fE(this._dataReader,"WriteBatch.set",n._key,i,null!==n.converter,r);return this._mutations.push(s.toMutation(n._key,le.none())),this}update(e,t,r,...n){let i;this._verifyNotCommitted();let s=pB(e,this._firestore);return i="string"==typeof(t=ei(t))||t instanceof fd?fk(this._dataReader,"WriteBatch.update",s._key,t,r,n):fC(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(i.toMutation(s._key,le.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=pB(e,this._firestore);return this._mutations=this._mutations.concat(new lh(t._key,le.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ip(id.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function pB(e,t){if((e=ei(e)).firestore!==t)throw new ip(id.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class pj{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=fI(e)}get(e){let t=pB(e,this._firestore),r=new pc(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return iu(24041);let n=e[0];if(n.isFoundDocument())return new fK(this._firestore,r,n.key,n,t.converter);if(n.isNoDocument())return new fK(this._firestore,r,t._key,null,t.converter);throw iu(18433,{doc:n})})}set(e,t,r){let n=pB(e,this._firestore),i=pu(n.converter,t,r),s=fE(this._dataReader,"Transaction.set",n._key,i,null!==n.converter,r);return this._transaction.set(n._key,s),this}update(e,t,r,...n){let i,s=pB(e,this._firestore);return i="string"==typeof(t=ei(t))||t instanceof fd?fk(this._dataReader,"Transaction.update",s._key,t,r,n):fC(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,i),this}delete(e){let t=pB(e,this._firestore);return this._transaction.delete(t._key),this}}class pq extends pj{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=pB(e,this._firestore),r=new fU(this._firestore);return super.get(e).then(e=>new pR(this._firestore,r,t._key,e._document,new pD(!1,!1),t.converter))}}function pz(e,t,r){var n,i;let s;e=iB(e,fs);let a={...pV,...r};if(a.maxAttempts<1)throw new ip(id.INVALID_ARGUMENT,"Max attempts must be at least 1");return n=fo(e),i=r=>t(new pq(e,r)),s=new im,n.asyncQueue.enqueueAndForget(async()=>{let e=await dJ(n);new dj(n.asyncQueue,e,a,i,s).ju()}),s.promise}function p$(e){e=iB(e,d5);let t=iB(e.firestore,fs);return dX(fo(t),e._key).then(r=>p3(t,e,r))}function pG(e){var t;let r;e=iB(e,d5);let n=iB(e.firestore,fs),i=fo(n),s=new fU(n);return(t=e._key,r=new im,i.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await e.persistence.runTransaction("read document","readonly",r=>e.localDocuments.getDocument(r,t));n.isFoundDocument()?r.resolve(n):n.isNoDocument()?r.resolve(null):r.reject(new ip(id.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let e=hV(n,`Failed to get document '${t} from cache`);r.reject(e)}})(await dW(i),t,r)),r.promise).then(t=>new pR(n,s,e._key,t,new pD(null!==t&&t.hasLocalMutations,!0),e.converter))}function pK(e){e=iB(e,d5);let t=iB(e.firestore,fs);return dX(fo(t),e._key,{source:"server"}).then(r=>p3(t,e,r))}function pH(e){e=iB(e,d4);let t=iB(e.firestore,fs),r=fo(t),n=new fU(t);return fW(e._query),dZ(r,e._query).then(r=>new pL(t,n,e,r))}function pW(e){var t;let r;e=iB(e,d4);let n=iB(e.firestore,fs),i=fo(n),s=new fU(n);return(t=e._query,r=new im,i.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await cN(e,t,!0),i=new h6(t,n.ks),s=i.ru(n.documents),a=i.applyChanges(s,!1);r.resolve(a.snapshot)}catch(n){let e=hV(n,`Failed to execute query '${t} against cache`);r.reject(e)}})(await dW(i),t,r)),r.promise).then(t=>new pL(n,s,e,t))}function pQ(e){e=iB(e,d4);let t=iB(e.firestore,fs),r=fo(t),n=new fU(t);return dZ(r,e._query,{source:"server"}).then(r=>new pL(t,n,e,r))}function pJ(e,t,r){e=iB(e,d5);let n=iB(e.firestore,fs),i=pu(e.converter,t,r),s=fI(n);return p6(n,[fE(s,"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,le.none())])}function pY(e,t,r,...n){e=iB(e,d5);let i=iB(e.firestore,fs),s=fI(i);return p6(i,[("string"==typeof(t=ei(t))||t instanceof fd?fk(s,"updateDoc",e._key,t,r,n):fC(s,"updateDoc",e._key,t)).toMutation(e._key,le.exists(!0))])}function pX(e){return p6(iB(e.firestore,fs),[new lh(e._key,le.none())])}function pZ(e,t){let r=iB(e.firestore,fs),n=d9(e),i=pu(e.converter,t);return p6(r,[fE(fI(e.firestore),"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,le.exists(!1))]).then(()=>n)}function p0(e,...t){var r;let n,i,s,a,o;e=ei(e);let l={includeMetadataChanges:!1,source:"default"},u=0;"object"!=typeof t[0]||fz(t[u])||(l=t[u++]);let c={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(fz(t[u])){let e=t[u];t[u]=e.next?.bind(e),t[u+1]=e.error?.bind(e),t[u+2]=e.complete?.bind(e)}if(e instanceof d5)i=iB(e.firestore,fs),s=oC(e._key.path),n={next:r=>{t[u]&&t[u](p3(i,e,r))},error:t[u+1],complete:t[u+2]};else{let r=iB(e,d4);i=iB(r.firestore,fs),s=r._query;let a=new fU(i);n={next:e=>{t[u]&&t[u](new pL(i,a,r,e))},error:t[u+1],complete:t[u+2]},fW(e._query)}return r=fo(i),o=new hJ(s,a=new dF(n),c),r.asyncQueue.enqueueAndForget(async()=>hG(await dY(r),o)),()=>{a.Nu(),r.asyncQueue.enqueueAndForget(async()=>hK(await dY(r),o))}}function p1(e,t,...r){var n,i,s,a,o,l;let u=ei(e),c=function(e){let t={bundle:"",bundleName:"",bundleSource:""};for(let r of["bundle","bundleName","bundleSource"]){if(!(r in e)){t.error=`snapshotJson missing required field: ${r}`;break}let n=e[r];if("string"!=typeof n){t.error=`snapshotJson field '${r}' must be a string.`;break}if(0===n.length){t.error=`snapshotJson field '${r}' cannot be an empty string.`;break}"bundle"===r?t.bundle=n:"bundleName"===r?t.bundleName=n:"bundleSource"===r&&(t.bundleSource=n)}return t}(t);if(c.error)throw new ip(id.INVALID_ARGUMENT,c.error);let h,d=0;if("object"!=typeof r[0]||fz(r[d])||(h=r[d++]),"QuerySnapshot"===c.bundleSource){let e,t,a=null;if("object"==typeof r[d]&&fz(r[d])){let e=r[d++];a={next:e.next,error:e.error,complete:e.complete}}else a={next:r[d++],error:r[d++],complete:r[d++]};return n=h,i=a,s=r[d],t=!1,fc(u,c.bundle).then(()=>{var e,t,r;return e=u,t=c.bundleName,(r=fo(e=iB(e,fs)),r.asyncQueue.enqueue(async()=>{var e;return e=await dW(r),e.persistence.runTransaction("Get named query","readonly",r=>e.Pi.getNamedQuery(r,t))})).then(t=>t?new d4(e,null,t.query):null)}).then(r=>{r&&!t&&(s&&r.withConverter(s),e=p0(r,n||{},i))}).catch(e=>(i.error&&i.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}if("DocumentSnapshot"===c.bundleSource){let e,t,n=null;if("object"==typeof r[d]&&fz(r[d])){let e=r[d++];n={next:e.next,error:e.error,complete:e.complete}}else n={next:r[d++],error:r[d++],complete:r[d++]};return a=h,o=n,l=r[d],t=!1,fc(u,c.bundle).then(()=>{t||(e=p0(new d5(u,l||null,iP.fromPath(c.bundleName)),a||{},o))}).catch(e=>(o.error&&o.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}throw new ip(id.INVALID_ARGUMENT,`unsupported bundle source: ${c.bundleSource}`)}function p2(e,t){let r,n=fo(e=iB(e,fs));return r=new dF(fz(t)?t:{next:t}),n.asyncQueue.enqueueAndForget(async()=>{var e;return e=await dY(n),void(e.Ca.add(r),r.next())}),()=>{r.Nu(),n.asyncQueue.enqueueAndForget(async()=>{var e;return e=await dY(n),void e.Ca.delete(r)})}}function p6(e,t){var r;let n;return r=fo(e),n=new im,r.asyncQueue.enqueueAndForget(async()=>di(await dQ(r),t,n)),n.promise}function p3(e,t,r){let n=r.docs.get(t._key),i=new fU(e);return new pR(e,i,t._key,n,new pD(r.hasPendingWrites,r.fromCache),t.converter)}function p4(e){return fo(e=iB(e,fs)),new pU(e,t=>p6(e,t))}function p5(e,t){let r=fo(e=iB(e,fs));if(!r._uninitializedComponentsProvider||"memory"===r._uninitializedComponentsProvider._offline.kind)return io("Cannot enable indexes when persistence is disabled"),Promise.resolve();let n=function(e){let t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new ip(id.INVALID_ARGUMENT,"Failed to parse JSON: "+e?.message)}}(e):e,r=[];if(Array.isArray(t.indexes))for(let e of t.indexes){let t=p8(e,"collectionGroup"),n=[];if(Array.isArray(e.fields))for(let t of e.fields){let e=fL("setIndexConfiguration",p8(t,"fieldPath"));"CONTAINS"===t.arrayConfig?n.push(new iJ(e,2)):"ASCENDING"===t.order?n.push(new iJ(e,0)):"DESCENDING"===t.order&&n.push(new iJ(e,1))}r.push(new iK(iK.UNKNOWN_ID,t,n,iY.empty()))}return r}(t);return r.asyncQueue.enqueue(async()=>(async function(e,t){let r=e.indexManager,n=[];return e.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(i=>(function(e,t,r,n,i){t=[...t],(e=[...e]).sort(r),t.sort(r);let s=e.length,a=t.length,o=0,l=0;for(;o<a&&l<s;){let s=r(e[l],t[o]);s<0?i(e[l++]):s>0?n(t[o++]):(o++,l++)}for(;o<a;)n(t[o++]);for(;l<s;)i(e[l++])})(i,t,iQ,t=>{n.push(r.addFieldIndex(e,t))},t=>{n.push(r.deleteFieldIndex(e,t))})).next(()=>i4.waitFor(n)))})(await dW(r),n))}function p8(e,t){if("string"!=typeof e[t])throw new ip(id.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class p7{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function p9(e){e=iB(e,fs);let t=mi.get(e);if(t)return t;let r=fo(e);if("persistent"!==r._uninitializedComponentsProvider?._offline.kind)return null;let n=new p7(e);return mi.set(e,n),n}function me(e){mn(e,!0)}function mt(e){mn(e,!1)}function mr(e){var t;(t=fo(e._firestore)).asyncQueue.enqueue(async()=>{var e;let r;return r=(e=await dW(t)).indexManager,e.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))}).then(e=>is("deleting all persistent cache indexes succeeded")).catch(e=>io("deleting all persistent cache indexes failed",e))}function mn(e,t){var r;(r=fo(e._firestore),r.asyncQueue.enqueue(async()=>{var e;return e=await dW(r),void(e.Cs.As=t)})).then(e=>is(`setting persistent cache index auto creation isEnabled=${t} succeeded`)).catch(e=>io(`setting persistent cache index auto creation isEnabled=${t} failed`,e))}let mi=new WeakMap;class ms{constructor(){throw Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return ma.instance.onExistenceFilterMismatch(e)}}class ma{constructor(){this.i=new Map}static get instance(){return mo||function(e){if(lb)throw Error("a TestingHooksSpi instance is already set");lb=e}(mo=new ma),mo}u(e){this.i.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.i;return r.set(t,e),()=>r.delete(t)}}let mo=null;!function(e=!0){it=eQ,eV(new es("firestore",(t,{instanceIdentifier:r,options:n})=>{let i=t.getProvider("app").getImmediate(),s=new fs(new iw(t.getProvider("auth-internal")),new iE(i,t.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ip(id.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new aO(e.options.projectId,t)}(i,r),i);return n={useFetchStreams:e,...n},s._setSettings(n),s},"PUBLIC").setMultipleInstances(!0)),e1(fj,fq,void 0),e1(fj,fq,"esm2020")}(),e.s(["AggregateField",()=>f$,"AggregateQuerySnapshot",()=>fG,"DocumentSnapshot",()=>pR,"PersistentCacheIndexManager",()=>p7,"QueryCompositeFilterConstraint",()=>f0,"QueryConstraint",()=>fJ,"QueryDocumentSnapshot",()=>pP,"QueryEndAtConstraint",()=>pt,"QueryFieldFilterConstraint",()=>fX,"QueryLimitConstraint",()=>f4,"QueryOrderByConstraint",()=>f6,"QuerySnapshot",()=>pL,"QueryStartAtConstraint",()=>f7,"SnapshotMetadata",()=>pD,"Transaction",()=>pq,"WriteBatch",()=>pU,"_TestingHooks",()=>ms,"addDoc",()=>pZ,"aggregateFieldEqual",()=>pp,"aggregateQuerySnapshotEqual",()=>pm,"and",()=>f2,"average",()=>pd,"count",()=>pf,"deleteAllPersistentCacheIndexes",()=>mr,"deleteDoc",()=>pX,"disablePersistentCacheIndexAutoCreation",()=>mt,"documentSnapshotFromJSON",()=>pO,"enablePersistentCacheIndexAutoCreation",()=>me,"endAt",()=>pn,"endBefore",()=>pr,"executeWrite",()=>p6,"getAggregateFromServer",()=>py,"getCountFromServer",()=>pg,"getDoc",()=>p$,"getDocFromCache",()=>pG,"getDocFromServer",()=>pK,"getDocs",()=>pH,"getDocsFromCache",()=>pW,"getDocsFromServer",()=>pQ,"getPersistentCacheIndexManager",()=>p9,"limit",()=>f5,"limitToLast",()=>f8,"memoryEagerGarbageCollector",()=>pI,"memoryLocalCache",()=>pT,"memoryLruGarbageCollector",()=>pE,"onSnapshot",()=>p0,"onSnapshotResume",()=>p1,"onSnapshotsInSync",()=>p2,"or",()=>f1,"orderBy",()=>f3,"persistentLocalCache",()=>pS,"persistentMultipleTabManager",()=>pA,"persistentSingleTabManager",()=>px,"query",()=>fY,"querySnapshotFromJSON",()=>pM,"runTransaction",()=>pz,"setDoc",()=>pJ,"setIndexConfiguration",()=>p5,"snapshotEqual",()=>pF,"startAfter",()=>pe,"startAt",()=>f9,"sum",()=>ph,"updateDoc",()=>pY,"where",()=>fZ,"writeBatch",()=>p4],63802),e.s([],36180),e.i(63802),e.s(["Timestamp",()=>i$,"addDoc",()=>pZ,"collection",()=>d7,"deleteDoc",()=>pX,"doc",()=>d9,"enableIndexedDbPersistence",()=>fu,"getDoc",()=>p$,"getDocs",()=>pH,"getFirestore",()=>fa,"orderBy",()=>f3,"query",()=>fY,"serverTimestamp",()=>fB,"setDoc",()=>pJ,"updateDoc",()=>pY,"where",()=>fZ,"writeBatch",()=>p4],98925),e1("firebase","12.9.0","app"),e.i(92953);let ml=eJ({apiKey:"AIzaSyB4_LoZyuWsmgXI9zwOwzShjgQdOtNHoHY",authDomain:"pos-appsheet.firebaseapp.com",projectId:"pos-appsheet",storageBucket:"pos-appsheet.firebasestorage.app",messagingSenderId:"658514081162",appId:"1:658514081162:web:a474dbfbdd92f2db59c473"}),mu=fa(ml),mc=function(e=eX()){let t=eU(e,"auth");if(t.isInitialized())return t.getImmediate();let r=function(e,t){let r=eU(e,"auth");if(r.isInitialized()){let e=r.getImmediate();if(Y(r.getOptions(),t??{}))return e;tl(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:nZ,persistence:[ng,r9,ne]}),n=L("authTokenSyncURL");if(n&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(n,location.origin);if(location.origin===e.origin){let t,n=(t=e.toString(),async e=>{let r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>n6)return;let i=r?.token;n3!==i&&(n3=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});ei(r).beforeAuthStateChanged(n,()=>n(r.currentUser)),ei(r).onIdTokenChanged(e=>n(e),void 0,void 0)}}let i=O("auth");return i&&function(e,t,r){let n=ei(e);tf(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");let i=ry(t),{host:s,port:a}=function(e){let t=ry(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};let n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){let e=i[1];return{host:e,port:rv(n.substr(e.length+1))}}{let[e,t]=n.split(":");return{host:e,port:rv(t)}}}(t),o=null===a?"":`:${a}`,l={url:`${i}//${s}${o}/`},u=Object.freeze({host:s,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!n._canInitEmulator){tf(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tf(Y(l,n.config.emulator)&&Y(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,F(s)?(V(`${i}//${s}${o}`),j("Auth",!0)):function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"u">typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"u">typeof window&&"u">typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(r,`http://${i}`),r}(ml),mh={PELANGGAN:"pelanggan",SUPPLIER:"supplier",PRODUK:"produk",TRANSAKSI:"transaksi",DETAIL_TRANSAKSI:"detailTransaksi",PEMBELIAN:"pembelian",DETAIL_PEMBELIAN:"detailPembelian",KARTU_STOK:"kartuStok",HUTANG:"hutang",PEMBAYARAN_HUTANG:"pembayaranHutang",CASH_FLOW:"cashFlow",USERS:"users"};e.s(["COLLECTIONS",0,mh,"auth",0,mc,"db",0,mu],59141);let md=(0,I.createContext)(void 0);function mf({children:e}){let[t,r]=(0,I.useState)(null),[n,i]=(0,I.useState)(null),[s,a]=(0,I.useState)(!0);(0,I.useEffect)(()=>{var e;let t=(e=async e=>{if(r(e),e)try{let t=await p$(d9(mu,mh.USERS,e.uid));if(t.exists()){let r=t.data();i({uid:e.uid,email:e.email,displayName:e.displayName||r.displayName,role:r.role||"kasir",createdAt:r.createdAt?.toDate()||new Date})}else i({uid:e.uid,email:e.email,displayName:e.displayName,role:"kasir",createdAt:new Date})}catch(e){console.error("Error fetching user profile:",e)}else i(null);a(!1)},ei(mc).onAuthStateChanged(e,void 0,void 0));return()=>t()},[]);let o=async(e,t)=>{await (ez(mc.app)?Promise.reject(th(mc)):rY(ei(mc),rM.credential(e,t)).catch(async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&r1(mc),e}))},l=async(e,t,r,n="kasir")=>{let{user:i}=await r6(mc,e,t);await r4(i,{displayName:r}),await pJ(d9(mu,mh.USERS,i.uid),{uid:i.uid,email:e,displayName:r,role:n,createdAt:new Date})},u=async()=>{await ei(mc).signOut()},c=async e=>{await r2(mc,e)};return(0,_.jsx)(md.Provider,{value:{user:t,userProfile:n,loading:s,login:o,register:l,logout:u,resetPassword:c},children:e})}function mp(){let e=(0,I.useContext)(md);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>mf,"useAuth",()=>mp],94690)}]);